const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["../chunks/DaNq8MIJ.js","../chunks/CkPp-hAN.js","../chunks/nKfqrTNe.js","../assets/editor.D75HT4sR.css"])))=>i.map(i=>d[i]);
import"../chunks/Bzak7iHL.js";import{E as Xt,F as cn,al as Yr,D as dn,aN as _r,I as un,J as vn,K as pn,L as wr,U as xr,au as qa,av as yr,Z as Ie,W as fn,S as gn,aO as kr,aP as Ir,aQ as Cr,c as mn,Q as hn,N as bn,R as Ha,ag as _n,$ as Kr,ax as wn,aR as xn,aS as yn,aT as nr,T as Ur,aU as kn,aV as In,aW as Cn,aX as Tn,aY as Sn,aZ as An,O as ba,b as c,V as Jr,a_ as Bn,a1 as Mn,w as kt,q as Xe,v as Ia,p as Ct,ai as ga,i as f,m as s,k as u,l as Tt,n as i,s as v,t as E,o as Ae,g as e,aL as Ft,a$ as wt,x as g,e as m,b0 as ea,aM as B,B as $e,j as be,b1 as Qa,a4 as yt,A as or,b2 as Zn,b3 as Dt,b4 as qt,b5 as Pt,b6 as ir,aj as Ln,C as $n,b7 as Nn,ak as Jt,b8 as Wn,y as Tr}from"../chunks/nKfqrTNe.js";import{a as Kt,s as ut,p as He,i as $,b as Gt,_ as Sr,c as qn,d as Hn}from"../chunks/CkPp-hAN.js";import{u as Ke,v as tt,H as sa,z as ca,r as rt,I as da,s as La,J as Zt,c as Xr,a as Ut,q as Nt,t as mt,w as ht,x as lr,K as Yt,L as Pn,M as xa,N as En,h as er,p as aa,O as ua,P as va,Q as pa,R as tr,S as ar,T as Vn,V as Rn,W as Ar,X as Dn,Y as Br,Z as zn,_ as Fn,$ as Gn,a0 as jn,a1 as On,a2 as Qr,a3 as Yn,a4 as $a,d as Na,j as Kn,a5 as Un,a6 as Pa,a7 as Ea,U as Jn,a8 as Mr,a9 as Zr,aa as Xn,ab as Qn}from"../chunks/CED-4UMh.js";import{i as Bt}from"../chunks/CLEP_dGz.js";const Va=0,Aa=1,Ra=2;function eo(r,t,a,n,l){Xt&&cn();var d=r,o=Yr(),M=mn,T=xr,S,_,q,k=o?yr(void 0):Ie(void 0,!1,!1),V=o?yr(void 0):Ie(void 0,!1,!1),G=!1;function C(de,L){G=!0,L&&(kr(R),Ir(R),Cr(M));try{de===Aa&&n&&(_?hn(_):_=bn(()=>n(d,k))),de!==Va&&S&&Ha(S,()=>S=null),de!==Aa&&_&&Ha(_,()=>_=null),de!==Ra&&q&&Ha(q,()=>q=null)}finally{L&&(Cr(null),Ir(null),kr(null),_n())}}var R=dn(()=>{if(T===(T=t()))return;let de=Xt&&_r(T)===(d.data===un);if(de&&(d=vn(),pn(d),wr(!1),de=!0),_r(T)){var L=T;G=!1,L.then(j=>{L===T&&(qa(k,j),C(Aa,!0))},j=>{if(L===T)throw qa(V,j),C(Ra,!0),V.v}),Xt||fn(()=>{G||C(Va,!0)})}else qa(k,T),C(Aa,!1);return de&&wr(!0),()=>T=xr});Xt&&(d=gn)}function sr(r,t,a=!1){if(r.multiple){if(t==null)return;if(!wn(t))return xn();for(var n of r.options)n.selected=t.includes(ya(n));return}for(n of r.options){var l=ya(n);if(yn(l,t)){n.selected=!0;return}}(!a||t!==void 0)&&(r.selectedIndex=-1)}function en(r){var t=new MutationObserver(()=>{sr(r,r.__value)});t.observe(r,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),Kr(()=>{t.disconnect()})}function Lr(r,t,a=t){var n=!0;nr(r,"change",l=>{var d=l?"[selected]":":checked",o;if(r.multiple)o=[].map.call(r.querySelectorAll(d),ya);else{var M=r.querySelector(d)??r.querySelector("option:not([disabled])");o=M&&ya(M)}a(o)}),Ur(()=>{var l=t();if(sr(r,l,n),n&&l===void 0){var d=r.querySelector(":checked");d!==null&&(l=ya(d),a(l))}r.__value=l,n=!1}),en(r)}function ya(r){return"__value"in r?r.__value:r.value}const to=Symbol("is custom element"),ao=Symbol("is html");function pt(r){if(Xt){var t=!1,a=()=>{if(!t){if(t=!0,r.hasAttribute("value")){var n=r.value;ye(r,"value",null),r.value=n}if(r.hasAttribute("checked")){var l=r.checked;ye(r,"checked",null),r.checked=l}}};r.__on_r=a,Tn(a),Sn()}}function jt(r,t){var a=cr(r);a.value===(a.value=t??void 0)||r.value===t&&(t!==0||r.nodeName!=="PROGRESS")||(r.value=t??"")}function ro(r,t){var a=cr(r);a.checked!==(a.checked=t??void 0)&&(r.checked=t)}function It(r,t){t?r.hasAttribute("selected")||r.setAttribute("selected",""):r.removeAttribute("selected")}function ye(r,t,a,n){var l=cr(r);Xt&&(l[t]=r.getAttribute(t),t==="src"||t==="srcset"||t==="href"&&r.nodeName==="LINK")||l[t]!==(l[t]=a)&&(t==="loading"&&(r[An]=a),a==null?r.removeAttribute(t):typeof a!="string"&&no(r).includes(t)?r[t]=a:r.setAttribute(t,a))}function cr(r){return r.__attributes??(r.__attributes={[to]:r.nodeName.includes("-"),[ao]:r.namespaceURI===kn})}var $r=new Map;function no(r){var t=$r.get(r.nodeName);if(t)return t;$r.set(r.nodeName,t=[]);for(var a,n=r,l=Element.prototype;l!==n;){a=Cn(n);for(var d in a)a[d].set&&t.push(d);n=In(n)}return t}function At(r,t,a=t){var n=Yr(),l=new WeakSet;nr(r,"input",d=>{var o=d?r.defaultValue:r.value;if(o=Da(r)?za(o):o,a(o),ba!==null&&l.add(ba),n&&o!==(o=t())){var M=r.selectionStart,T=r.selectionEnd;r.value=o??"",T!==null&&(r.selectionStart=M,r.selectionEnd=Math.min(T,r.value.length))}}),(Xt&&r.defaultValue!==r.value||c(t)==null&&r.value)&&(a(Da(r)?za(r.value):r.value),ba!==null&&l.add(ba)),Jr(()=>{var d=t();if(r===document.activeElement){var o=Bn??ba;if(l.has(o))return}Da(r)&&d===za(r.value)||r.type==="date"&&!d&&!r.value||d!==r.value&&(r.value=d??"")})}function oo(r,t,a=t){nr(r,"change",n=>{var l=n?r.defaultChecked:r.checked;a(l)}),(Xt&&r.defaultChecked!==r.checked||c(t)==null)&&a(r.checked),Jr(()=>{var n=t();r.checked=!!n})}function Da(r){var t=r.type;return t==="number"||t==="range"}function za(r){return r===""?null:+r}function io(r,t,a){var n=Mn(r,t);n&&n.set&&(r[t]=a,Kr(()=>{r[t]=null}))}function rr(r){return function(...t){var a=t[0];return a.preventDefault(),r==null?void 0:r.apply(this,t)}}const lo=!1,nu=Object.freeze(Object.defineProperty({__proto__:null,ssr:lo},Symbol.toStringTag,{value:"Module"})),Qt=typeof window<"u";function Fa(r,t){if(!Qt)return t;const a=localStorage.getItem(r),n=a!=null?Number(a):NaN;return Number.isFinite(n)?n:t}function Nr(r,t){return Qt?localStorage.getItem(r)??t:t}function Wr(r){if(!Qt)return null;const t=localStorage.getItem(r);return t==null||t===""?null:t}function ta(r,t){Qt&&localStorage.setItem(r,String(t))}function Ba(r,t,a){return Math.max(t,Math.min(a,r))}function so(){const r=Ba(Fa("asideWidth",250),150,400),t=Ba(Fa("terminalHeight",3),3,Number.MAX_SAFE_INTEGER),a=Nr("terminalState","closed"),n=Ba(Fa("terminalPrevHeight",t),3,Number.MAX_SAFE_INTEGER),l=Nr("terminalTab","scripts"),d=Wr("activeSideNav"),o=Wr("activeRightUtil"),M=kt(r),T=kt(t),S=kt(a),_=kt(n),q=kt(l),k=kt(d),V=kt(o);M.subscribe(p=>ta("asideWidth",p)),T.subscribe(p=>ta("terminalHeight",p)),S.subscribe(p=>ta("terminalState",p)),_.subscribe(p=>ta("terminalPrevHeight",p)),q.subscribe(p=>ta("terminalTab",p)),k.subscribe(p=>{Qt&&(p==null?localStorage.removeItem("activeSideNav"):ta("activeSideNav",p))}),V.subscribe(p=>{Qt&&(p==null?localStorage.removeItem("activeRightUtil"):ta("activeRightUtil",p))}),Qt&&window.addEventListener("storage",p=>{p.key&&(p.key==="asideWidth"&&p.newValue!=null&&M.set(Number(p.newValue)),p.key==="terminalHeight"&&p.newValue!=null&&T.set(Number(p.newValue)),p.key==="terminalState"&&p.newValue!=null&&S.set(p.newValue),p.key==="terminalPrevHeight"&&p.newValue!=null&&_.set(Number(p.newValue)),p.key==="terminalTab"&&p.newValue!=null&&q.set(p.newValue),p.key==="activeSideNav"&&k.set(p.newValue??null),p.key==="activeRightUtil"&&V.set(p.newValue??null))});function G(p){M.set(Ba(p,150,400))}function C(p){const A=Math.max(3,Math.floor(p));T.set(A),Xe(S)!=="normal"&&S.set("normal")}function R(p){const A=Xe(S);if(p===A)return;if(p==="full"){const le=Xe(T);if(_.set(le),Qt){const N=window.innerHeight;T.set(Math.max(3,Math.floor(N)))}S.set("full");return}if(p==="normal"){if(A==="full"){const le=Xe(_);T.set(Math.max(3,Math.floor(le)))}S.set("normal");return}const D=Xe(T);_.set(D),S.set("closed")}function de(){const p=Xe(S);R(p==="full"?"normal":"full")}function L(){const p=Xe(S);let A=Xe(_)||Xe(T);p==="closed"?(A<=20&&(A=250),T.set(Math.max(3,Math.floor(A))),S.set("normal")):p==="normal"&&A<=3&&T.set(Math.max(3,250))}function j(){R("closed")}function _e(p){q.set(p)}function Fe(p){_e(p),L()}function Be(p){k.set(p)}function re(p){V.set(p)}function W(){G(250),C(3),R("closed")}return{asideWidth:M,terminalHeight:T,terminalState:S,terminalPrevHeight:_,terminalTab:q,activeSideNav:k,activeRightUtil:V,setAsideWidth:G,setTerminalHeight:C,setTerminalState:R,toggleFull:de,openTerminal:L,closeTerminal:j,setTerminalTab:_e,openTerminalWithTab:Fe,setActiveSideNav:Be,setActiveRightUtil:re,resetLayout:W}}const ma=so(),co="create",dr=kt(co);function uo(r){dr.set(r)}var vo=f('<li class="cursor-pointer"><div class="flex items-center flex-col space-y-1"><svg class="w-6 h-6 text-gray-800 dark:text-white" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 24 24"><!></svg> <span class="text-xs text-gray-500 dark:text-gray-400"> </span></div></li>'),po=(r,t,a)=>e(t).name==="Scripts"?a("scripts"):a("timeline"),fo=f('<li><button type="button" class="flex items-center flex-col space-y-1 cursor-pointer"><svg class="w-6 h-6 text-gray-800 dark:text-white" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 24 24"><!></svg> <span class="text-xs text-gray-500 dark:text-gray-400"> </span></button></li>'),go=(r,t,a)=>t(e(a).name),mo=f('<li><button type="button" class="flex items-center flex-col space-y-1 cursor-pointer"><svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 24 24"><!></svg> <span> </span></button></li>'),ho=(r,t)=>t("create"),bo=(r,t)=>t("template"),_o=(r,t)=>t("animate"),wo=f('<div class="bg-gray-100 dark:bg-slate-900 h-full flex items-center"><section class="flex justify-between flex-1 items-center"><nav class="shadow-md h-full flex justify-between"><ul class="flex space-x-4 p-4"></ul></nav> <div class="text-sm text-gray-500 dark:text-gray-400">Project name</div> <nav class="flex items-center space-x-4"><ul class="flex space-x-4 pr-4"></ul> <ul class="flex justify-around p-4 w-64"><!> <li class="cursor-pointer relative"><div class="flex items-center flex-col space-y-1" id="context-button" data-dropdown-toggle="dropdown-context"><svg class="w-6 h-6 text-gray-800 dark:text-white" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 24 24"><path d="M20 14h-2.722L11 20.278a5.511 5.511 0 0 1-.9.722H20a1 1 0 0 0 1-1v-5a1 1 0 0 0-1-1ZM9 3H4a1 1 0 0 0-1 1v13.5a3.5 3.5 0 1 0 7 0V4a1 1 0 0 0-1-1ZM6.5 18.5a1 1 0 1 1 0-2 1 1 0 0 1 0 2ZM19.132 7.9 15.6 4.368a1 1 0 0 0-1.414 0L12 6.55v9.9l7.132-7.132a1 1 0 0 0 0-1.418Z"></path></svg> <span class="text-xs text-gray-500 dark:text-gray-400">Context</span></div> <div id="dropdown-context" class="z-10 hidden absolute top-8 right-0 bg-white divide-y divide-gray-100 rounded-lg shadow-sm w-44 dark:bg-gray-700"><ul class="py-2 text-sm text-gray-700 dark:text-gray-200" aria-labelledby="context-button"><li><button type="button" class="items-center inline-flex w-full px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 dark:text-gray-400 dark:hover:bg-gray-600 dark:hover:text-white">Create</button></li> <li><button type="button" class="items-center inline-flex w-full px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 dark:text-gray-400 dark:hover:bg-gray-600 dark:hover:text-white">Template</button></li> <li><button type="button" class="items-center inline-flex w-full px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 dark:text-gray-400 dark:hover:bg-gray-600 dark:hover:text-white">Animate</button></li></ul></div></li></ul></nav></section></div>');function xo(r,t){Ct(t,!1);const[a,n]=Kt(),l=()=>ut(o,"$activeRightUtil",a),{openTerminalWithTab:d,activeRightUtil:o,setActiveRightUtil:M}=ma;let T=[{name:"Project",icon:'<svg class="w-6 h-6 text-gray-800 dark:text-white" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 24 24"><path fill-rule="evenodd" d="M4 4a2 2 0 0 0-2 2v12a2 2 0 0 0 .087.586l2.977-7.937A1 1 0 0 1 6 10h12V9a2 2 0 0 0-2-2h-4.532l-1.9-2.28A2 2 0 0 0 8.032 4H4Zm2.693 8H6.5l-3 8H18l3-8H6.693Z" clip-rule="evenodd"/></svg>'},{name:"Preview",icon:'<svg class="w-6 h-6 text-gray-800 dark:text-white" xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="currentColor"><path d="m380-300 280-180-280-180v360ZM480-80q-83 0-156-31.5T197-197q-54-54-85.5-127T80-480q0-83 31.5-156T197-763q54-54 127-85.5T480-880q83 0 156 31.5T763-763q54 54 85.5 127T880-480q0 83-31.5 156T763-197q-54 54-127 85.5T480-80Zm0-80q134 0 227-93t93-227q0-134-93-227t-227-93q-134 0-227 93t-93 227q0 134 93 227t227 93Zm0-320Z"/></svg>'},{name:"Publish",icon:'<svg class="w-6 h-6 text-gray-800 dark:text-white" xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="currentColor"><path d="m226-559 78 33q14-28 29-54t33-52l-56-11-84 84Zm142 83 114 113q42-16 90-49t90-75q70-70 109.5-155.5T806-800q-72-5-158 34.5T492-656q-42 42-75 90t-49 90Zm178-65q-23-23-23-56.5t23-56.5q23-23 57-23t57 23q23 23 23 56.5T660-541q-23 23-57 23t-57-23Zm19 321 84-84-11-56q-26 18-52 32.5T532-299l33 79Zm313-653q19 121-23.5 235.5T708-419l20 99q4 20-2 39t-20 33L538-80l-84-197-171-171-197-84 167-168q14-14 33.5-20t39.5-2l99 20q104-104 218-147t235-24ZM157-321q35-35 85.5-35.5T328-322q35 35 34.5 85.5T327-151q-25 25-83.5 43T82-76q14-103 32-161.5t43-83.5Zm57 56q-10 10-20 36.5T180-175q27-4 53.5-13.5T270-208q12-12 13-29t-11-29q-12-12-29-11.5T214-265Z"/></svg>'}],S=[[{name:"Scripts",icon:'<svg class="w-6 h-6 text-gray-800 dark:text-white" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m8 8-4 4 4 4m8 0 4-4-4-4m-2-3-4 14"/></svg>'},{name:"Timeline",icon:'<svg class="w-6 h-6 text-gray-800 dark:text-white" xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="currentColor"><path d="M610-760q-21 0-35.5-14.5T560-810q0-21 14.5-35.5T610-860q21 0 35.5 14.5T660-810q0 21-14.5 35.5T610-760Zm0 660q-21 0-35.5-14.5T560-150q0-21 14.5-35.5T610-200q21 0 35.5 14.5T660-150q0 21-14.5 35.5T610-100Zm160-520q-21 0-35.5-14.5T720-670q0-21 14.5-35.5T770-720q21 0 35.5 14.5T820-670q0 21-14.5 35.5T770-620Zm0 380q-21 0-35.5-14.5T720-290q0-21 14.5-35.5T770-340q21 0 35.5 14.5T820-290q0 21-14.5 35.5T770-240Zm60-190q-21 0-35.5-14.5T780-480q0-21 14.5-35.5T830-530q21 0 35.5 14.5T880-480q0 21-14.5 35.5T830-430ZM480-80q-83 0-156-31.5T197-197q-54-54-85.5-127T80-480q0-83 31.5-156T197-763q54-54 127-85.5T480-880v80q-134 0-227 93t-93 227q0 134 93 227t227 93v80Zm132-212L440-464v-216h80v184l148 148-56 56Z"/></svg>'}],[{name:"Styles",icon:'<svg class="w-6 h-6 " aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 7h.01m3.486 1.513h.01m-6.978 0h.01M6.99 12H7m9 4h2.706a1.957 1.957 0 0 0 1.883-1.325A9 9 0 1 0 3.043 12.89 9.1 9.1 0 0 0 8.2 20.1a8.62 8.62 0 0 0 3.769.9 2.013 2.013 0 0 0 2.03-2v-.857A2.036 2.036 0 0 1 16 16Z"/></svg>'},{name:"Actions",icon:'<svg class="w-6 h-6" xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="currentColor"><g><rect fill="none" height="24" width="24"/></g><g><path d="M11,21h-1l1-7H7.5c-0.88,0-0.33-0.75-0.31-0.78C8.48,10.94,10.42,7.54,13.01,3h1l-1,7h3.51c0.4,0,0.62,0.19,0.4,0.66 C12.97,17.55,11,21,11,21z"/></g></svg>'}]];const _=fe=>{const ie=fe.target,I=document.getElementById("dropdown-context"),h=ie.id==="context-button"||ie.closest("#context-button")!==null;!ie.contains(I)&&I&&!h&&I&&(I.classList.add("hidden"),document.removeEventListener("click",_))};function q(fe){const ie=fe.toLowerCase();l()===ie?M(null):M(ie)}function k(fe){uo(fe);const ie=document.getElementById("dropdown-context");ie==null||ie.classList.add("hidden"),document.removeEventListener("click",_)}ga(()=>{const fe=document.getElementById("context-button");fe==null||fe.addEventListener("click",()=>{const ie=document.getElementById("dropdown-context");ie&&(ie.classList.toggle("hidden"),document.addEventListener("click",_))})}),Bt();var V=wo(),G=s(V),C=s(G),R=s(C);Ke(R,5,()=>T,tt,(fe,ie)=>{var I=vo(),h=s(I),H=s(h),se=s(H);sa(se,()=>e(ie).icon,!0),i(H);var me=v(H,2),ce=s(me,!0);i(me),i(h),ca(h,(ne,ue)=>{var oe;return(oe=da)==null?void 0:oe(ne,ue)},()=>({content:e(ie).name,placement:"auto"})),i(I),E(()=>Ae(ce,e(ie).name)),u(fe,I)}),i(R),i(C);var de=v(C,4),L=s(de);Ke(L,5,()=>S[0],tt,(fe,ie)=>{var I=fo(),h=s(I);h.__click=[po,ie,d];var H=s(h),se=s(H);sa(se,()=>e(ie).icon,!0),i(H);var me=v(H,2),ce=s(me,!0);i(me),i(h),ca(h,(ne,ue)=>{var oe;return(oe=da)==null?void 0:oe(ne,ue)},()=>({content:e(ie).name,placement:"bottom"})),i(I),E(()=>Ae(ce,e(ie).name)),u(fe,I)}),i(L);var j=v(L,2),_e=s(j);Ke(_e,1,()=>S[1],tt,(fe,ie)=>{var I=mo(),h=s(I);h.__click=[go,q,ie];var H=s(h),se=s(H);sa(se,()=>e(ie).icon,!0),i(H);var me=v(H,2),ce=s(me,!0);i(me),i(h),ca(h,(ne,ue)=>{var oe;return(oe=da)==null?void 0:oe(ne,ue)},()=>({content:e(ie).name,placement:"bottom"})),i(I),E((ne,ue)=>{rt(H,0,`w-6 h-6 ${ne??""}`),rt(me,1,`text-xs ${ue??""}`),Ae(ce,e(ie).name)},[()=>l()==e(ie).name.toLowerCase()?"text-gray-900 dark:text-white":"text-gray-500",()=>l()==e(ie).name.toLowerCase()?"text-gray-900 dark:text-white":"text-gray-500"]),u(fe,I)});var Fe=v(_e,2),Be=v(s(Fe),2),re=s(Be),W=s(re),p=s(W);p.__click=[ho,k],i(W);var A=v(W,2),D=s(A);D.__click=[bo,k],i(A);var le=v(A,2),N=s(le);N.__click=[_o,k],i(le),i(re),i(Be),i(Fe),i(j),i(de),i(G),i(V),u(r,V),Tt(),n()}Ia(["click"]);function yo(r){return new Worker(""+new URL("../workers/editor.worker-BqkDworx.js",import.meta.url).href,{name:r==null?void 0:r.name})}function ko(r){return new Worker(""+new URL("../workers/ts.worker-DRZ1I4hw.js",import.meta.url).href,{name:r==null?void 0:r.name})}self.MonacoEnvironment={getWorker(r,t){return t==="typescript"||t==="javascript"?new ko:new yo}};function Io(){return Math.random().toString(36).slice(2)}const Ga=kt([]),Lt={subscribe:Ga.subscribe,append(r,t,a){Ga.update(n=>[...n,{id:Io(),time:Date.now(),level:r,message:t,meta:a}])},clear(){Ga.set([])}};typeof window<"u"&&(window.addEventListener("error",r=>{var t;Lt.append("error",r.message||"Uncaught error",{source:"window.error",error:((t=r.error)==null?void 0:t.stack)||String(r.error)})}),window.addEventListener("unhandledrejection",r=>{Lt.append("error",r.reason&&(r.reason.message||String(r.reason))||"Unhandled rejection",{source:"unhandledrejection",reason:r.reason})}));const tn="animationData";function Co(){if(typeof localStorage>"u")return{};try{const r=localStorage.getItem(tn);return r?JSON.parse(r):{}}catch{return{}}}function To(r){typeof localStorage>"u"||localStorage.setItem(tn,JSON.stringify(r))}const oa=kt(Co());oa.subscribe(To);const ka={subscribe:oa.subscribe,getForTimeline(r){return(Xe(oa)[r]??[]).slice().sort((t,a)=>t.time-a.time)},addKeyframe(r,t){oa.update(a=>((a[r]??(a[r]=[])).push(t),a))},updateKeyframe(r,t){oa.update(a=>{const n=a[r]??(a[r]=[]),l=n.findIndex(d=>d.id===t.id);return l>=0&&(n[l]=t),a})},removeKeyframe(r,t){oa.update(a=>{const n=a[r]??(a[r]=[]),l=n.findIndex(d=>d.id===t);return l>=0&&n.splice(l,1),a})}};function So(){return"kf-"+Math.random().toString(36).slice(2)}const Ao={pixelsPerSecond:200,fps:60,showFrames:!1,selectedElementId:null,selectedKeyframeId:null},Bo=kt(Ao),an="triggers";function Mo(){if(typeof localStorage>"u")return[];try{const r=localStorage.getItem(an);return r?JSON.parse(r):[]}catch{return[]}}function Zo(r){typeof localStorage>"u"||localStorage.setItem(an,JSON.stringify(r))}const ia=kt(Mo());ia.subscribe(Zo);const Et={subscribe:ia.subscribe,add(r){ia.update(t=>[...t,r])},remove(r){ia.update(t=>t.filter(a=>a.id!==r))},all(){return Xe(ia)},getForTimeline(r){return Xe(ia).filter(t=>{var a;return((a=t.source)==null?void 0:a.kind)==="timeline"&&t.source.timelineId===r})}};function Lo(){var o;const r=Xe(La),t=Xe(Zt),a=r?t.find(M=>M.id===r)??null:t[0]??null,n=Xe(Xr),l=n!=null&&n.elements?n.elements.map(M=>({id:M.id,name:M.name??M.id,type:M.type,locked:!!M.locked})):[];let d=[];if(a){const M=Ut.getForTimeline(a.id),T=l.map(k=>Ut.ensureClip(a.id,k.id,a.duration)),S=[...M,...T].reduce((k,V)=>(k.set(V.id,V),k),new Map),_=ka.getForTimeline(a.id),q=((o=Et.getForTimeline)==null?void 0:o.call(Et,a.id))??[];d=Array.from(S.values()).map(k=>{const V=l.find(R=>R.id===k.elementId),G=_.filter(R=>R.elementId===k.elementId&&R.time>=k.start&&R.time<=k.end).map(R=>({id:R.id,time:R.time})),C=q.filter(R=>{var de;return((de=R.source)==null?void 0:de.kind)==="timeline.event"&&R.source.event==="cue"}).map(R=>{var de;return{id:R.id,time:((de=R.source)==null?void 0:de.cueTime)??k.start}}).filter(R=>R.time>=k.start&&R.time<=k.end);return{id:k.id,layerId:k.elementId,start:k.start,end:k.end,label:(V==null?void 0:V.name)??k.elementId,keyframes:G,triggers:C,locked:!!(V!=null&&V.locked)}})}return{timeline:a,layers:l,clips:d}}const $o=Ft([La,Zt,Xr,Ut,ka,Et],()=>Lo()),qr="studioVariables.v1";function No(){return Math.random().toString(36).slice(2)}const Wt=kt([]),Ot=kt({});if(typeof window<"u"){try{const t=localStorage.getItem(qr);if(t){const a=JSON.parse(t);Array.isArray(a.defs)&&Wt.set(a.defs),a.values&&typeof a.values=="object"&&Ot.set(a.values)}}catch{}const r=()=>{try{const t=JSON.stringify({defs:Xe(Wt),values:Xe(Ot)});localStorage.setItem(qr,t)}catch{}};Wt.subscribe(r),Ot.subscribe(r)}const la=Ft(Wt,r=>r),Ma=Ft(Ot,r=>r),rn=Ft([Wt,Nt],([r,t])=>r.filter(a=>a.scope==="global"||a.scope==="page"&&a.pageId===t));function Wo(){return Xe(Wt)}function qo(r){return Xe(Wt).filter(t=>t.scope==="global"||t.scope==="page"&&t.pageId===r)}function Ho(r){const t=No(),a=r.scope==="page"?r.pageId||Xe(Nt):void 0,n=String(r.name||"").trim();if(!n)throw new Error("Variable name is required");if(Xe(Wt).some(o=>o.name.toLowerCase()===n.toLowerCase()&&o.scope===r.scope&&(o.scope==="global"||o.pageId===a)))throw new Error(`Variable "${n}" already exists in this scope`);const d={id:t,name:n,scope:r.scope,pageId:a,type:r.type,readOnly:!!r.readOnly};return Wt.update(o=>[...o,d]),r.initial!==void 0&&Ca(t,nn(r.type,r.initial)),d}function Po(r,t){const a=String(t||"").trim();if(!a)return;const n=Xe(Wt).find(o=>o.id===r);if(!n)return;const l=n.scope==="page"?n.pageId:void 0;if(Xe(Wt).some(o=>o.id!==r&&o.name.toLowerCase()===a.toLowerCase()&&o.scope===n.scope&&(o.scope==="global"||o.pageId===l)))throw new Error(`Variable "${a}" already exists in this scope`);Wt.update(o=>o.map(M=>M.id===r?{...M,name:a}:M))}function Eo(r){Wt.update(t=>t.filter(a=>a.id!==r)),Ot.update(t=>{const a={...t};return delete a[r],a})}function Ca(r,t){Ot.update(a=>({...a,[r]:t}))}function Vo(r,t,a){const n=ur(r,a);n&&(n.readOnly||Ca(n.id,nn(n.type,t)))}function Za(r,t){const a=ur(r,t);if(a)return Xe(Ot)[a.id]}function ur(r,t){const a=t??Xe(Nt),n=Xe(Wt),l=n.find(o=>o.name===r&&o.scope==="page"&&o.pageId===a);return l||n.find(o=>o.name===r&&o.scope==="global")||null}function Ro(r,t,a){let n=Symbol("init");const l=Wt.subscribe(()=>{const o=Za(r,t);o!==n&&(n=o,a(o))}),d=Ot.subscribe(()=>{const o=Za(r,t);o!==n&&(n=o,a(o))});return queueMicrotask(()=>{const o=Za(r,t);n=o,a(o)}),()=>{l(),d()}}function nn(r,t){try{switch(r){case"number":return typeof t=="number"?t:Number(t);case"boolean":return typeof t=="boolean"?t:String(t).toLowerCase()==="true";case"json":return typeof t=="string"?JSON.parse(t):t;case"object":{if(t!=null&&typeof t=="object"&&!Array.isArray(t))return t;if(typeof t=="string"){const a=JSON.parse(t);return a&&typeof a=="object"&&!Array.isArray(a)?a:{}}return{}}case"array":{if(Array.isArray(t))return t;if(typeof t=="string"){const a=JSON.parse(t);return Array.isArray(a)?a:[]}return[]}default:return t!=null?String(t):""}}catch{return t}}const ja={createVariable:Ho,renameVariable:Po,deleteVariable:Eo,setValueById:Ca,setValueByName:Vo,getValueByName:Za,resolveByName:ur,subscribeValueByName:Ro,listAll:Wo,listForPage:qo,variableDefs:la,variableValues:Ma,variablesByPage:rn},on=Ft(Ot,r=>r);function Do(r,t){Ca(r,t)}function zo(r,t){const a=Xe(Ot)[r],n=(Number(a)||0)+(Number(t)||0);Ca(r,n)}const Oa=new Map;function vr(r){const t=Oa.get(r.id);if(t){try{t.dispose()}catch{}Oa.delete(r.id)}const a=[];switch(r.source.kind){case"variable.change":{const l=on.subscribe(d=>{_a(r)});a.push(l);break}case"timer.timeout":{const l=setTimeout(()=>_a(r),r.source.delay);a.push(()=>clearTimeout(l));break}case"timer.interval":{const l=setInterval(()=>_a(r),r.source.interval);a.push(()=>clearInterval(l));break}case"timeline.event":{const l=r.source,d=mt.get(l.timelineId);if(d){const o=M=>{if(l.event==="cue"&&M.type==="cue"){const T=M.cue;if(l.cueId&&T.id!==l.cueId||l.cueName&&T.name!==l.cueName||typeof l.cueTime=="number"&&T.time!==l.cueTime)return;_a(r)}else M.type===l.event&&_a(r)};d.on(o),a.push(()=>d.off(o))}break}}const n={def:r,dispose:()=>a.forEach(l=>l())};return Oa.set(r.id,n),n}function _a(r){r.enabled!==!1&&(r.conditions&&r.conditions.length>0&&!r.conditions.every(Fo)||Go(r.actions))}function Fo(r){const t=Hr(r.lhs),a=Hr(r.rhs);switch(r.op){case"==":return t==a;case"!=":return t!=a;case">":return t>a;case"<":return t<a;case">=":return t>=a;case"<=":return t<=a;case"includes":return Array.isArray(t)?t.includes(a):typeof t=="string"?t.includes(String(a)):!1;default:return!1}}function Hr(r){return r.type==="const"?r.value:Xe(on)[r.id]}function Go(r){for(const t of r)switch(t.type){case"log":console.log("[Trigger log]",t.message),Lt.append("info",t.message,{source:"trigger"});break;case"setVariable":Do(t.id,t.value);break;case"adjustVariable":zo(t.id,t.by);break;case"playTimeline":{const a=mt.get(t.timelineId);a==null||a.play();break}case"pauseTimeline":{const a=mt.get(t.timelineId);a==null||a.pause();break}case"stopTimeline":{const a=mt.get(t.timelineId);a==null||a.stop();break}case"seekTimeline":{const a=mt.get(t.timelineId);a==null||a.seek(t.time);break}case"setTimelineLoop":{const a=mt.get(t.timelineId);a==null||a.setLoop(t.loop);break}default:console.warn("Unknown action",t);break}}var jo=f('<div class="absolute top-0"><div class="h-6 border-l border-slate-300 dark:border-slate-600"></div></div>'),Oo=f('<div class="absolute top-0"><div class="text-[11px] mt-0.5 -translate-x-1/2 text-slate-700 dark:text-slate-300" style="transform: translateX(-50%); white-space: nowrap;"> </div></div>'),Yo=f('<div class="absolute top-0"><div class="h-4 border-l border-slate-200 dark:border-slate-700 opacity-50"></div></div>'),Ko=f('<div class="absolute top-0"><div class="h-3 border-l border-slate-200 dark:border-slate-700 opacity-40"></div></div> <div class="absolute top-0"><div class="h-3 border-l border-slate-200 dark:border-slate-700 opacity-40"></div></div>',1),Uo=f('<div class="absolute top-0"><div class="h-2 border-l border-slate-200 dark:border-slate-800 opacity-30"></div></div>'),Jo=f('<div class="absolute top-0 group"><div class="w-0 h-0 border-l-6 border-l-transparent border-r-6 border-r-transparent border-b-8 border-b-rose-500 -translate-y-1" role="button" tabindex="0"></div> <button class="absolute -top-3 left-2 opacity-0 group-hover:opacity-100 transition text-[10px] px-1 py-0.5 bg-rose-600 text-white rounded" title="Delete cue">×</button></div>'),Xo=f('<div class="absolute top-0"><div class="w-2 h-2 bg-rose-600 rounded-full translate-x-[-50%] translate-y-[2px]"></div></div>'),Qo=f('<div class="h-10 bg-slate-100 dark:bg-slate-800 border-b border-slate-200 dark:border-slate-700 relative select-none" role="application" aria-label="Timeline ruler"><div class="absolute left-0 top-0 bottom-0"><!> <!> <!> <!> <!> <!> <!> <div class="absolute top-0 bottom-0 w-1 bg-slate-500 cursor-ew-resize z-20" title="Drag to adjust timeline length"></div> <div class="absolute -top-2 -translate-x-1/2 z-20"><div class="w-0 h-0 border-l-5 border-l-transparent border-r-5 border-r-transparent border-b-6 border-b-slate-500"></div></div></div> <div class="absolute top-0 bottom-0 w-0 pointer-events-none"><div class="absolute top-0 bottom-0 -ml-[1px] w-[2px] bg-red-500 border-dashed border-red-300"></div> <div class="absolute -top-3 -translate-x-1/2"><div class="w-0 h-0 border-l-6 border-l-transparent border-r-6 border-r-transparent border-b-8 border-b-red-500"></div></div></div></div>');function ei(r,t){Ct(t,!1);const a=Ie();let n=He(t,"duration",8),l=He(t,"playheadMs",8),d=He(t,"zoom",8),o=He(t,"basePps",8),M=He(t,"hScroll",8),T=He(t,"viewportPx",8),S=He(t,"cues",8),_=He(t,"timelineId",8),q=He(t,"onSeek",8),k=He(t,"onContextMenuAt",8),V=He(t,"onDurationLive",8),G=He(t,"onDurationCommit",8),C=He(t,"onCueRename",8),R=He(t,"onCueDelete",8);const de=60;function L(){return o()*d()}function j(te){return te/1e3*L()}function _e(te){return Math.round(te/L()*1e3)}function Fe(){const te=L(),J=Math.max(0,Math.floor(M()/te)),O=Math.max(Math.ceil((M()+T())/te),Math.ceil((n()??0)/1e3));return{startSec:J,endSec:O}}function Be(){const{startSec:te,endSec:J}=Fe(),O=[];for(let y=te;y<=J;y++)O.push(y);return O}function re(){const{startSec:te,endSec:J}=Fe(),O=[];let y=-1/0;for(let Z=te;Z<=J;Z++){const P=j(Z*1e3);P-y>=de&&(O.push(Z),y=P)}return O}function W(){return L()>=150}function p(){return L()>=400}function A(){return L()>=800}let D=Ie(null);function le(te){var J,O;e(D)&&((O=(J=te.target).setPointerCapture)==null||O.call(J,te.pointerId),N(te),window.addEventListener("pointermove",N),window.addEventListener("pointerup",fe,{once:!0}))}function N(te){var Z;if(!e(D))return;const J=e(D).getBoundingClientRect(),O=Math.max(0,Math.min(J.width,te.clientX-J.left))+M(),y=_e(O);(Z=q())==null||Z(y)}function fe(){window.removeEventListener("pointermove",N)}function ie(te){var Z;if(te.preventDefault(),!e(D))return;const J=e(D).getBoundingClientRect(),O=Math.max(0,Math.min(J.width,te.clientX-J.left))+M(),y=_e(O);(Z=k())==null||Z(y,te.clientX,te.clientY)}function I(te){if(!e(D))return;te.stopPropagation();const J=te.clientX,O=n();function y(P){var ae;const ke=P.clientX-J,pe=_e(ke),X=O+pe;(ae=V())==null||ae(X)}function Z(){var P;window.removeEventListener("pointermove",y),window.removeEventListener("pointerup",Z),(P=G())==null||P()}window.addEventListener("pointermove",y),window.addEventListener("pointerup",Z,{once:!0})}function h(te){return`${te}s`}wt(()=>(m(o()),m(d())),()=>{g(a,o()*d())}),ea(),Bt();var H=Qo(),se=s(H),me=s(se);Ke(me,1,()=>c(Be),tt,(te,J)=>{var O=jo();E(()=>{ht(O,`left:${e(J)*e(a)}px;`),ye(O,"title",`${e(J)}s`)}),u(te,O)});var ce=v(me,2);Ke(ce,1,()=>c(re),tt,(te,J)=>{var O=Oo(),y=s(O),Z=s(y,!0);i(y),i(O),E(P=>{ht(O,`left:${e(J)*e(a)}px;`),Ae(Z,P)},[()=>(e(J),c(()=>h(e(J))))]),u(te,O)});var ne=v(ce,2);{var ue=te=>{var J=$e(),O=be(J);Ke(O,1,()=>c(Be),tt,(y,Z)=>{var P=Yo();E(()=>{ht(P,`left:${(e(Z)+.5)*e(a)}px;`),ye(P,"title",`${e(Z)}.5s`)}),u(y,P)}),u(te,J)};$(ne,te=>{c(W)&&te(ue)})}var oe=v(ne,2);{var Ge=te=>{var J=$e(),O=be(J);Ke(O,1,()=>c(Be),tt,(y,Z)=>{var P=Ko(),ke=be(P),pe=v(ke,2);E(()=>{ht(ke,`left:${(e(Z)+.25)*e(a)}px;`),ye(ke,"title",`${e(Z)}.25s`),ht(pe,`left:${(e(Z)+.75)*e(a)}px;`),ye(pe,"title",`${e(Z)}.75s`)}),u(y,P)}),u(te,J)};$(oe,te=>{c(p)&&te(Ge)})}var je=v(oe,2);{var Re=te=>{var J=$e(),O=be(J);Ke(O,1,()=>c(Be),tt,(y,Z)=>{var P=$e(),ke=be(P);Ke(ke,0,()=>c(()=>Array.from({length:9},(pe,X)=>X+1)),tt,(pe,X)=>{var ae=Uo();E(()=>{ht(ae,`left:${(e(Z)+X/10)*e(a)}px;`),ye(ae,"title",`${e(Z)}.${X}s`)}),u(pe,ae)}),u(y,P)}),u(te,J)};$(je,te=>{c(A)&&te(Re)})}var ve=v(je,2);Ke(ve,1,()=>S()??[],tt,(te,J)=>{var O=Jo(),y=s(O),Z=v(y,2);i(O),E(()=>{ht(O,(e(J),e(a),c(()=>`left:${e(J).time/1e3*e(a)}px;`))),ye(y,"title",(e(J),c(()=>e(J).name||e(J).id)))}),B("dblclick",y,P=>{var ke;P.stopPropagation(),(ke=C())==null||ke(e(J),P)}),B("click",Z,P=>{var ke;P.stopPropagation(),(ke=R())==null||ke(e(J))}),u(te,O)});var Me=v(ve,2);Ke(Me,1,()=>(m(Et),m(_()),c(()=>{var te;return((te=Et.getForTimeline)==null?void 0:te.call(Et,_()))??[]})),tt,(te,J)=>{var O=$e(),y=be(O);{var Z=P=>{var ke=$e(),pe=be(ke);{var X=ae=>{var Pe=$e(),Y=be(Pe);Ke(Y,1,()=>S()??[],tt,(Q,ee)=>{var Ne=$e(),Ze=be(Ne);{var xe=De=>{var Ee=Xo();E(()=>{ht(Ee,(e(ee),e(a),c(()=>`left:${e(ee).time/1e3*e(a)}px;`))),ye(Ee,"title",(e(ee),c(()=>`Trigger on cue: ${e(ee).name||e(ee).id}`)))}),u(De,Ee)};$(Ze,De=>{e(ee),e(J),c(()=>e(ee).id===e(J).source.cueId)&&De(xe)})}u(Q,Ne)}),u(ae,Pe)};$(pe,ae=>{e(J),c(()=>e(J).source.cueId)&&ae(X)})}u(P,ke)};$(y,P=>{e(J),c(()=>{var ke;return((ke=e(J).source)==null?void 0:ke.kind)==="timeline"&&e(J).source.event==="cue"})&&P(Z)})}u(te,O)});var U=v(Me,2),ge=v(U,2);i(se);var he=v(se,2),we=v(s(he),2);ht(we,"left:0px"),i(he),i(H),Gt(H,te=>g(D,te),()=>e(D)),E(te=>{ht(se,te),ht(U,`left:${n()/1e3*e(a)}px`),ht(ge,`left:${n()/1e3*e(a)}px`),ht(he,`left:${l()/1e3*e(a)}px`)},[()=>(m(n()),e(a),m(M()),m(T()),c(()=>`width: ${Math.max(n()/1e3*e(a),M()+T(),T())}px`))]),B("pointerdown",U,I),B("pointerdown",H,le),B("contextmenu",H,ie),u(r,H),Tt()}var ti=f("<div></div>"),ai=f('<span class="ml-1 align-middle" title="Locked">🔒</span>'),ri=f('<div class="absolute -translate-y-1/2 cursor-ew-resize"><div></div></div>'),ni=f('<div title="Trigger" class="absolute -translate-y-full"><div class="w-3 h-3 bg-rose-500 rounded-sm"></div></div>'),oi=f('<div><div></div> <div class="flex-1 px-2 text-xs font-medium text-white truncate"> <!></div> <div></div> <!> <!></div>'),ii=f('<div class="absolute left-0 pointer-events-none opacity-0"></div>'),li=f('<div class="relative"><!> <!> <!></div>');function si(r,t){Ct(t,!1);const a=Ie();let n=He(t,"layers",24,()=>[]),l=He(t,"clips",24,()=>[]),d=He(t,"duration",8),o=He(t,"basePps",8),M=He(t,"zoom",8),T=He(t,"rowHeight",8,36),S=He(t,"minClipPx",8,12),_=He(t,"hScroll",8,0),q=He(t,"viewportPx",8,0),k=He(t,"highlightKeyframeId",8,null),V=He(t,"onClipLive",8),G=He(t,"onClipCommit",8),C=He(t,"onKeyframeLive",8),R=He(t,"onKeyframeCommit",8);function de(){return o()*M()}function L(W){return Math.round(W/de()*1e3)}function j(W,p,A){var I,h;if(W.stopPropagation(),p!=null&&p.locked){(h=(I=W.currentTarget)==null?void 0:I.blur)==null||h.call(I);return}if(A==="move"){const H=W.currentTarget;if(H){const se=H.getBoundingClientRect(),me=W.clientX-se.left,ce=8;me<=ce?A="resize-start":se.width-me<=ce&&(A="resize-end")}}const D=W.clientX,le=p.start,N=p.end;function fe(H){var ue;if(p!=null&&p.locked)return;const se=H.clientX-D,me=L(se);let ce=le,ne=N;if(A==="move"){const oe=N-le;ce=Math.max(0,Math.min(d()-oe,le+me)),ne=ce+oe}else A==="resize-start"?(ce=Math.max(0,Math.min(N,le+me)),ce>ne&&(ce=ne)):A==="resize-end"&&(ne=Math.max(le,Math.min(d(),N+me)),ne<ce&&(ne=ce));p.start=ce,p.end=ne,(ue=V())==null||ue({id:p.id,layerId:p.layerId,start:ce,end:ne})}function ie(){var H;window.removeEventListener("pointermove",fe),window.removeEventListener("pointerup",ie),(H=G())==null||H({id:p.id,layerId:p.layerId,start:p.start,end:p.end})}window.addEventListener("pointermove",fe),window.addEventListener("pointerup",ie,{once:!0})}wt(()=>(m(o()),m(M())),()=>{g(a,o()*M())}),ea(),Bt();var _e=li(),Fe=s(_e);Ke(Fe,1,n,tt,(W,p,A)=>{var D=ti();rt(D,1,`absolute left-0 right-0 ${A%2===0?"bg-white/0 dark:bg-slate-900/20":""}`),E(()=>ht(D,`top:${A*T()}px; height:${T()}px`)),u(W,D)});var Be=v(Fe,2);Ke(Be,1,l,W=>W.id,(W,p)=>{var A=$e(),D=be(A);lr(D,()=>(e(p),c(()=>e(p).id)),le=>{var N=$e(),fe=be(N);{var ie=I=>{var h=oi();const H=yt(()=>(m(n()),e(p),c(()=>n().findIndex(U=>U.id===e(p).layerId))));let se;var me=s(h);let ce;var ne=v(me,2),ue=s(ne,!0),oe=v(ue);{var Ge=U=>{var ge=ai();u(U,ge)};$(oe,U=>{e(p),c(()=>e(p).locked)&&U(Ge)})}i(ne);var je=v(ne,2);let Re;var ve=v(je,2);Ke(ve,1,()=>(e(p),c(()=>e(p).keyframes??[])),tt,(U,ge,he)=>{var we=ri(),te=s(we);i(we),E(J=>{ht(we,(e(ge),e(p),e(a),c(()=>`left:${(e(ge).time-e(p).start)/1e3*e(a)}px; top:50%; transform: translate(-50%,-50%);`))),ye(we,"title",J),rt(te,1,(m(k()),e(ge),c(()=>`w-3 h-3 rotate-45 ${k()===e(ge).id?"bg-emerald-400 animate-pulse":"bg-yellow-400"}`)))},[()=>(e(ge),c(()=>`Keyframe @ ${((e(ge).time||0)/1e3).toFixed(3)}s`))]),B("pointerdown",we,J=>{J.stopPropagation();const O=J.clientX,y=e(ge).time;function Z(ke){var Pe;const pe=ke.clientX-O,X=L(pe),ae=Math.max(e(p).start,Math.min(e(p).end,y+X));(Pe=C())==null||Pe(e(ge).id,ae),e(ge).time=ae,Qa(()=>(e(p),l()))}function P(){var ke;window.removeEventListener("pointermove",Z),window.removeEventListener("pointerup",P),(ke=R())==null||ke(e(ge).id,e(ge).time)}window.addEventListener("pointermove",Z),window.addEventListener("pointerup",P,{once:!0})}),u(U,we)});var Me=v(ve,2);Ke(Me,1,()=>(e(p),c(()=>e(p).triggers??[])),tt,(U,ge)=>{var he=ni();E(()=>ht(he,(e(ge),e(p),e(a),c(()=>`left:${(e(ge).time-e(p).start)/1e3*e(a)}px; top:0; transform: translateX(-50%);`)))),u(U,he)}),i(h),E((U,ge,he,we)=>{se=rt(h,1,"absolute rounded-sm shadow-sm flex items-center overflow-hidden select-none",null,se,U),ht(h,ge),ye(h,"aria-disabled",(e(p),c(()=>e(p).locked?"true":"false"))),ce=rt(me,1,"w-6 h-full bg-white/10 hover:bg-white/25",null,ce,he),Ae(ue,(e(p),c(()=>e(p).label))),Re=rt(je,1,"w-6 h-full bg-white/10 hover:bg-white/25",null,Re,we)},[()=>({"opacity-60":e(p).locked,"cursor-not-allowed":e(p).locked}),()=>(e(p),e(a),m(e(H)),m(T()),m(S()),c(()=>`left:${e(p).start/1e3*e(a)}px; top:${e(H)*T()+6}px; width:${Math.max(S(),(e(p).end-e(p).start)/1e3*e(a))}px; height:${T()-12}px; background: linear-gradient(90deg, rgba(59,130,246,0.9), rgba(37,99,235,0.75))`)),()=>({"cursor-ew-resize":!e(p).locked,"cursor-not-allowed":e(p).locked}),()=>({"cursor-ew-resize":!e(p).locked,"cursor-not-allowed":e(p).locked})]),B("pointerdown",me,U=>j(U,e(p),"resize-start")),B("pointerdown",je,U=>j(U,e(p),"resize-end")),B("pointerdown",h,U=>j(U,e(p),"move")),u(I,h)};$(fe,I=>{m(n()),e(p),c(()=>n().findIndex(h=>h.id===e(p).layerId)!==-1)&&I(ie)})}u(le,N)}),u(W,A)});var re=v(Be,2);Ke(re,1,n,tt,(W,p,A)=>{var D=ii();E(()=>ht(D,`top:${A*T()}px; height:${T()}px; width:100%`)),u(W,D)}),i(_e),E(W=>ht(_e,W),[()=>(m(n()),m(T()),m(d()),e(a),m(_()),m(q()),c(()=>`height:${n().length*T()}px; width:${Math.max(d()/1e3*e(a),_()+q(),q())}px`))]),u(r,_e),Tt()}const ci=1e3;function di(r,t){const a=Ut.getForTimeline(r);let n=!1;for(const l of a)l.end>t&&(Ut.upsert(r,{...l,end:t}),n=!0);return n}function Ya(r,t,a){var T,S,_;const n=Zt.getById(r);if(!n)return;const l=((S=(T=Ut).getMaxEnd)==null?void 0:S.call(T,r))??0,d=Math.max(ci,l,Math.floor(t));if(d===n.duration){a!=null&&a.commit&&Yt(r,"timeline");return}const o={...n,duration:d};Zt.update(o),di(r,d);const M=mt.get(o.id)||mt.create(o);(_=M.setDuration)==null||_.call(M,d),M.time>d&&M.seek(d),a!=null&&a.commit&&Yt(o.id,"timeline")}function Pr(r,t,a){var o;const n=((o=Zt.getById(r))==null?void 0:o.duration)??1/0;let l=Math.max(0,Math.min(t.start,t.end)),d=Math.max(l,Math.min(n,t.end));Ut.upsert(r,{id:t.id,elementId:t.elementId,start:l,end:d}),a!=null&&a.commit&&Yt(r,"timeline")}function Er(r,t,a){if(Zt.addCue(r,t),a!=null&&a.commit&&Yt(r,"timeline"),a!=null&&a.recreateRuntime){const n=Zt.getById(r);mt.delete(n.id),mt.create(n)}}function ui(r,t,a,n){Zt.renameCue(r,t,a),Yt(r,"timeline");{const l=Zt.getById(r);mt.delete(l.id),mt.create(l)}}function vi(r,t,a){Zt.deleteCue(r,t),Yt(r,"timeline");{const n=Zt.getById(r);mt.delete(n.id),mt.create(n)}}function pi(r,t,a){ka.addKeyframe(r,t);{const n=Zt.getById(r),l=(n==null?void 0:n.duration)??1/0,o=Ut.getForTimeline(r).find(M=>M.elementId===t.elementId);if(o){let M=o.start,T=o.end;t.time<o.start&&(M=Math.max(0,t.time)),t.time>o.end&&(T=Math.min(l,t.time)),(M!==o.start||T!==o.end)&&Ut.upsert(r,{id:o.id,elementId:o.elementId,start:M,end:T})}}Yt(r,"timeline")}function Vr(r,t,a,n){const l=ka.getForTimeline(r).find(d=>d.id===t);l&&(ka.updateKeyframe(r,{...l,time:a}),n!=null&&n.commit&&Yt(r,"timeline"))}var fi=qt('<svg class="w-5 h-5 text-emerald-600" viewBox="0 0 24 24" fill="currentColor"><path d="M8 5v14l11-7z"></path></svg>'),gi=qt('<svg class="w-5 h-5 text-amber-500" viewBox="0 0 24 24" fill="currentColor"><path d="M6 19h4V5H6v14zm8-14v14h4V5h-4z"></path></svg>'),mi=f('<div class="text-rose-500">⚡</div>'),hi=f('<li class="px-3 py-2 flex items-center gap-2 hover:bg-slate-100 dark:hover:bg-slate-800"><div class="w-6 text-xs font-mono opacity-60"></div> <div class="flex-1"> </div> <!></li>'),bi=f('<div class="fixed z-50 shadow-lg rounded bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-700 text-sm"><button class="w-full text-left px-3 py-2 hover:bg-slate-100 dark:hover:bg-slate-800">Add Keyframe…</button> <button class="w-full text-left px-3 py-2 hover:bg-slate-100 dark:hover:bg-slate-800">Add Trigger…</button> <button class="w-full text-left px-3 py-2 hover:bg-slate-100 dark:hover:bg-slate-800">Add Cue Point…</button> <div class="px-3 py-2 text-xs text-slate-500">Esc to close</div></div> <button class="fixed inset-0 z-40" aria-label="Close context menu"></button>',1),_i=f('<label class="block">Message <input class="w-full mt-1 px-2 py-1 rounded bg-slate-100 dark:bg-slate-800"/></label>'),wi=f('<div class="fixed z-50 right-4 top-20 w-80 border border-slate-200 dark:border-slate-700 rounded bg-white dark:bg-slate-900 shadow p-3 text-xs space-y-2"><div class="flex items-center justify-between"><div class="font-semibold">Add Trigger</div> <button class="px-2 py-0.5 rounded bg-slate-200 dark:bg-slate-700">Close</button></div> <div class="opacity-70"> </div> <label class="block">Action <select class="w-full mt-1 px-2 py-1 rounded bg-slate-100 dark:bg-slate-800"><option>Log message</option><option>Play this timeline</option><option>Pause this timeline</option><option>Stop this timeline</option></select></label> <!> <label class="inline-flex items-center gap-2"><input type="checkbox"/> Also add a cue at time</label> <div class="flex gap-2 justify-end"><button class="px-3 py-1 rounded bg-slate-200 dark:bg-slate-700">Cancel</button> <button class="px-3 py-1 rounded bg-emerald-600 text-white">Add Trigger</button></div></div> <button class="fixed inset-0 z-40" aria-label="Close trigger panel"></button>',1),xi=f('<div class="text-rose-500"> </div>'),yi=f('<div class="fixed z-50"><div class="w-72 border border-slate-200 dark:border-slate-700 rounded bg-white dark:bg-slate-900 shadow p-3 text-xs space-y-2"><div class="font-semibold"> </div> <div class="opacity-70"> </div> <label class="block">Name (optional, unique) <input class="w-full mt-1 px-2 py-1 rounded bg-slate-100 dark:bg-slate-800" placeholder="Cue name"/></label> <!> <div class="flex gap-2 justify-end"><button class="px-3 py-1 rounded bg-slate-200 dark:bg-slate-700">Cancel</button> <button class="px-3 py-1 rounded bg-emerald-600 text-white"> </button></div></div></div> <button class="fixed inset-0 z-40" aria-label="Close cue card"></button>',1),ki=f('<div class="w-full h-[420px] flex flex-col bg-white dark:bg-slate-900 text-slate-900 dark:text-slate-100 rounded shadow-sm" role="application" aria-label="Timeline Editor"><div class="px-3 py-2 flex items-center justify-between gap-2 border-b border-slate-200 dark:border-slate-700"><div class="flex items-center gap-2"><button class="p-1 rounded hover:bg-slate-100 dark:hover:bg-slate-800" aria-label="Play/Pause"><!></button> <button class="p-1 rounded hover:bg-slate-100 dark:hover:bg-slate-800" aria-label="Stop"><svg class="w-5 h-5 text-rose-600" viewBox="0 0 24 24" fill="currentColor"><path d="M6 6h12v12H6z"></path></svg></button> <div class="text-xs font-mono ml-2"> </div></div> <div class="flex items-center gap-3"><button class="px-2 py-1 rounded hover:bg-slate-100 dark:hover:bg-slate-800">-</button> <input type="range" min="0.25" max="2" step="0.05" class="w-44"/> <button class="px-2 py-1 rounded hover:bg-slate-100 dark:hover:bg-slate-800">+</button> <button class="px-2 py-1 rounded hover:bg-slate-100 dark:hover:bg-slate-800">Fit</button></div></div> <div class="flex flex-1 min-h-0"><aside class="w-56 border-r border-slate-200 dark:border-slate-700 bg-slate-50 dark:bg-slate-900/30"><div class="text-xs font-semibold px-3 py-2 border-b border-slate-200 dark:border-slate-700">Layers</div> <ul class="text-sm overflow-auto h-full"></ul></aside> <div class="flex-1 flex flex-col min-h-0"><!> <div class="flex-1 overflow-auto"><!></div></div></div> <!> <!> <!></div>');function Ii(r,t){Ct(t,!1);const a=1e3,n=12;let l=Ie(0),d=Ie(null),o=Ie([]),M=Ie([]),T=null;function S(){if(!e(d))return;const b=mt.get(e(d).id)||mt.create(e(d));T&&(T(),T=null);const w=x=>{x.type,x.type==="pause"||x.type,(x.type==="seek"||x.type==="tick")&&g(l,b.time)};b.on(w),g(l,b.time),b.isPlaying,T=()=>b.off(w)}const _=$o.subscribe(b=>{g(d,b.timeline),g(o,b.layers),g(M,b.clips),e(d)?(g(l,Math.min(e(l),e(d).duration)),e(d).duration<a&&Ya(e(d).id,a,{commit:!1})):g(l,0)}),q={get tl(){return e(d)?mt.get(e(d).id)||mt.create(e(d)):null},get isPlaying(){var b;return!!((b=this.tl)!=null&&b.isPlaying)},play(){var b;(b=this.tl)==null||b.play()},pause(){var b;(b=this.tl)==null||b.pause()},stop(){var b;(b=this.tl)==null||b.stop()},seek(b){var w;(w=this.tl)==null||w.seek(b)}};let k=Ie(null),V=Ie(null);S();let G=Ie(1);const C=300;let R=Ie(0),de=Ie(0);const L=36;let j=Ie(!1),_e=Ie(0),Fe=Ie(0),Be=Ie(0),re=Ie(!1),W=Ie(null),p=Ie("log"),A=Ie("Hello from trigger"),D=Ie(!0),le="",N=Ie({open:!1,mode:"add",time:0,value:"",x:0,y:0});function fe(b){g(N,{open:!0,...b})}function ie(){Dt(N,e(N).open=!1),Dt(N,e(N).error=void 0)}function I(){if(!e(d))return;const b=(e(N).value||"").trim();try{if(e(N).mode==="add")Er(e(d).id,{time:e(N).time,name:b||void 0},{commit:!0,recreateRuntime:!0});else if(e(N).mode==="rename"&&e(N).cueId){if(!b){Dt(N,e(N).error="Name cannot be empty");return}ui(e(d).id,e(N).cueId,b,{commit:!0,recreateRuntime:!0})}}catch(x){Dt(N,e(N).error=(x==null?void 0:x.message)||"Failed to save cue");return}const w=Zt.getById(e(d).id);mt.delete(w.id),mt.create(w),g(d,w),S(),le=b,ie()}function h(b){const w=Math.floor(b/1e3),x=Math.floor(w/60),z=w%60,Ce=Math.floor(b%1e3).toString().padStart(3,"0");return`${x.toString().padStart(2,"0")}:${z.toString().padStart(2,"0")}.${Ce}`}function H(){q.isPlaying?q.pause():q.play()}function se(){q.stop();const b=q.tl;g(l,b?b.time:0)}function me(){const w=Math.round(33.333333333333336);q.seek(e(l)+w);const x=q.tl;g(l,x?x.time:e(l))}function ce(){const w=Math.round(33.333333333333336);q.seek(Math.max(0,e(l)-w));const x=q.tl;g(l,x?x.time:e(l))}function ne(b,w){e(d)&&fe({mode:"rename",cueId:w.id,time:w.time,value:w.name||"",x:b.clientX,y:b.clientY})}function ue(b){if(!e(d))return;const w=b.name||b.id;if(!confirm(`Delete cue ${w}?`))return;vi(e(d).id,b.id);const x=Zt.getById(e(d).id);mt.delete(x.id),mt.create(x),g(d,x),S()}function oe(){var x;if(g(j,!1),!e(d))return;const b=Xe(Bo).selectedElementId??((x=e(o)[0])==null?void 0:x.id);if(!b)return;const w={id:So(),elementId:b,property:"opacity",time:e(Be),value:1,easing:"linear"};pi(e(d).id,w),g(Ge,w.id),setTimeout(()=>{e(Ge)===w.id&&g(Ge,null)},1200)}let Ge=Ie(null);function je(){g(j,!1),g(re,!0),g(W,e(Be)),g(p,"log"),g(A,`Cue fired at ${h(e(Be))}`),g(D,!0)}function Re(){g(j,!1),e(d)&&fe({mode:"add",time:e(Be),value:le||"",x:e(_e),y:e(Fe)})}let ve=null;function Me(){e(V)&&(g(R,e(V).clientWidth),g(de,e(V).scrollLeft))}ga(()=>{let b=Xe(Pn);xa("stage"),S(),e(d)&&Yt(e(d).id,"timeline");const w=La.subscribe(()=>{S(),e(d)&&Yt(e(d).id,"timeline")});e(V)&&(e(V).addEventListener("scroll",Me),ve=new ResizeObserver(Me),ve.observe(e(V)),Me());const x=setInterval(()=>{if(q.isPlaying){const z=q.tl;z&&g(l,z.time)}},50);return()=>{clearInterval(x),e(V)&&e(V).removeEventListener("scroll",Me),ve==null||ve.disconnect(),w(),_(),T&&(T(),T=null),xa(b)}}),or(()=>{});function U(b){if(g(G,Math.max(.25,Math.min(2,b))),e(V)){const w=C*e(G),x=e(d)?e(d).duration/1e3*w:0,Ce=e(l)/1e3*w-e(V).clientWidth/2,Ve=Math.max(0,x-e(V).clientWidth);Dt(V,e(V).scrollLeft=Math.max(0,Math.min(Ve,Ce))),Me()}}function ge(b){b.key===" "&&(b.preventDefault(),H()),b.key==="ArrowRight"&&me(),b.key==="ArrowLeft"&&ce()}function he(){if(!e(d)){g(re,!1);return}let b=null;if(e(D)&&e(W)!=null){const Ce=(le||"").trim();try{Er(e(d).id,{time:e(W),name:Ce||void 0},{commit:!0,recreateRuntime:!0})}catch(Le){alert((Le==null?void 0:Le.message)||"Failed to add cue");return}const Ve=Zt.getById(e(d).id),Oe=[...Ve.cuePoints??[]].filter(Le=>Le.time===e(W)).sort((Le,nt)=>Le.id.localeCompare(nt.id)).pop();Oe&&(b={id:Oe.id,name:Oe.name,time:Oe.time}),g(d,Ve)}const w=[];switch(e(p)){case"log":w.push({type:"log",message:e(A)||"Trigger fired"});break;case"playTimeline":w.push({type:"playTimeline",timelineId:e(d).id});break;case"pauseTimeline":w.push({type:"pauseTimeline",timelineId:e(d).id});break;case"stopTimeline":w.push({type:"stopTimeline",timelineId:e(d).id});break}const x={kind:"timeline.event",timelineId:e(d).id,event:"cue"};b&&(x.cueId=b.id,b.name&&(x.cueName=b.name),x.cueTime=b.time);const z={id:"trig-"+Math.random().toString(36).slice(2),source:x,actions:w,enabled:!0};vr(z),Et.add&&Et.add(z),g(re,!1)}function we(){g(re,!1)}Bt();var te=ki();B("keydown",Zn,ge);var J=s(te),O=s(J),y=s(O),Z=s(y);{var P=b=>{var w=fi();u(b,w)},ke=b=>{var w=gi();u(b,w)};$(Z,b=>{q.isPlaying?b(ke,!1):b(P)})}i(y);var pe=v(y,2),X=v(pe,2),ae=s(X);i(X),i(O);var Pe=v(O,2),Y=s(Pe),Q=v(Y,2);pt(Q);var ee=v(Q,2),Ne=v(ee,2);i(Pe),i(J);var Ze=v(J,2),xe=s(Ze),De=v(s(xe),2);Ke(De,5,()=>e(o),tt,(b,w,x)=>{var z=hi(),Ce=s(z);Ce.textContent=x+1;var Ve=v(Ce,2),Oe=s(Ve,!0);i(Ve);var Le=v(Ve,2);{var nt=ze=>{var ot=mi();u(ze,ot)};$(Le,ze=>{e(M).find(ot=>{var bt;return ot.layerId===e(w).id&&(((bt=ot.triggers)==null?void 0:bt.length)??0)>0})&&ze(nt)})}i(z),E(()=>Ae(Oe,e(w).name)),u(b,z)}),i(De),i(xe);var Ee=v(xe,2),Te=s(Ee);{let b=yt(()=>e(d).cuePoints??[]);ei(Te,{get playheadMs(){return e(l)},get duration(){return e(d).duration},get zoom(){return e(G)},basePps:C,get hScroll(){return e(de)},get viewportPx(){return e(R)},get timelineId(){return e(d).id},get cues(){return e(b)},onCueRename:(w,x)=>ne(x,w),onCueDelete:w=>ue(w),onSeek:w=>{q.seek(w);const x=q.tl;g(l,x?x.time:e(l))},onContextMenuAt:(w,x,z)=>{g(j,!0),g(_e,x),g(Fe,z),g(Be,w)},onDurationLive:w=>{e(d)&&Ya(e(d).id,w,{commit:!1}),g(d,Zt.getById(e(d).id))},onDurationCommit:()=>{e(d)&&Ya(e(d).id,e(d).duration,{commit:!0})}})}var et=v(Te,2),We=s(et);si(We,{get layers(){return e(o)},get clips(){return e(M)},get duration(){return e(d).duration},basePps:C,get zoom(){return e(G)},rowHeight:L,minClipPx:n,get hScroll(){return e(de)},get viewportPx(){return e(R)},get highlightKeyframeId(){return e(Ge)},onClipLive:b=>{e(d)&&Pr(e(d).id,{id:b.id,elementId:b.layerId,start:b.start,end:b.end},{commit:!1})},onClipCommit:b=>{e(d)&&Pr(e(d).id,{id:b.id,elementId:b.layerId,start:b.start,end:b.end},{commit:!0})},onKeyframeLive:(b,w)=>{e(d)&&Vr(e(d).id,b,w,{commit:!1})},onKeyframeCommit:(b,w)=>{e(d)&&Vr(e(d).id,b,w,{commit:!0})}}),i(et),Gt(et,b=>g(V,b),()=>e(V)),i(Ee),i(Ze);var Se=v(Ze,2);{var Ye=b=>{var w=bi(),x=be(w),z=s(x),Ce=v(z,2),Ve=v(Ce,2);Pt(2),i(x);var Oe=v(x,2);E(()=>ht(x,`left:${e(_e)}px; top:${e(Fe)}px; min-width: 180px;`)),B("click",z,oe),B("click",Ce,je),B("click",Ve,Re),B("click",Oe,()=>g(j,!1)),u(b,w)};$(Se,b=>{e(j)&&b(Ye)})}var Ue=v(Se,2);{var F=b=>{var w=wi(),x=be(w),z=s(x),Ce=v(s(z),2);i(z);var Ve=v(z,2),Oe=s(Ve);i(Ve);var Le=v(Ve,2),nt=v(s(Le)),ze=s(nt);ze.value=ze.__value="log";var ot=v(ze);ot.value=ot.__value="playTimeline";var bt=v(ot);bt.value=bt.__value="pauseTimeline";var _t=v(bt);_t.value=_t.__value="stopTimeline",i(nt);var Mt;en(nt),i(Le);var $t=v(Le,2);{var Ht=vt=>{var gt=_i(),dt=v(s(gt));pt(dt),i(gt),E(()=>jt(dt,e(A))),B("input",dt,ft=>{g(A,ft.target.value)}),u(vt,gt)};$($t,vt=>{e(p)==="log"&&vt(Ht)})}var it=v($t,2),Qe=s(it);pt(Qe),Pt(),i(it);var lt=v(it,2),St=s(lt),at=v(St,2);i(lt),i(x);var st=v(x,2);E(vt=>{Ae(Oe,`At ${vt??""}`),Mt!==(Mt=e(p))&&(nt.value=(nt.__value=e(p))??"",sr(nt,e(p))),ro(Qe,e(D))},[()=>e(W)!==null?h(e(W)):"--:--.---"]),B("click",Ce,we),B("change",nt,vt=>{g(p,vt.target.value)}),B("change",Qe,vt=>{g(D,vt.target.checked)}),B("click",St,we),B("click",at,he),B("click",st,we),u(b,w)};$(Ue,b=>{e(re)&&b(F)})}var K=v(Ue,2);{var qe=b=>{var w=yi(),x=be(w),z=s(x),Ce=s(z),Ve=s(Ce,!0);i(Ce);var Oe=v(Ce,2),Le=s(Oe);i(Oe);var nt=v(Oe,2),ze=v(s(nt));pt(ze),i(nt);var ot=v(nt,2);{var bt=Qe=>{var lt=xi(),St=s(lt,!0);i(lt),E(()=>Ae(St,e(N).error)),u(Qe,lt)};$(ot,Qe=>{e(N).error&&Qe(bt)})}var _t=v(ot,2),Mt=s(_t),$t=v(Mt,2),Ht=s($t,!0);i($t),i(_t),i(z),i(x);var it=v(x,2);E(Qe=>{ht(x,`left:${e(N).x}px; top:${e(N).y}px`),Ae(Ve,e(N).mode==="add"?"Add Cue Point":"Rename Cue Point"),Ae(Le,`At ${Qe??""}`),Ae(Ht,e(N).mode==="add"?"Add":"Save")},[()=>h(e(N).time)]),At(ze,()=>e(N).value,Qe=>Dt(N,e(N).value=Qe)),B("click",Mt,ie),B("click",$t,I),B("click",it,ie),u(b,w)};$(K,b=>{e(N).open&&b(qe)})}i(te),Gt(te,b=>g(k,b),()=>e(k)),E((b,w)=>Ae(ae,`${b??""} / ${w??""}`),[()=>h(e(l)),()=>h(e(d).duration)]),B("click",y,H),B("click",pe,se),B("click",Y,()=>U(Math.max(.25,e(G)-.25))),At(Q,()=>e(G),b=>g(G,b)),B("input",Q,b=>U(Number(b.target.value))),B("click",ee,()=>U(Math.min(2,e(G)+.25))),B("click",Ne,()=>U(1)),u(r,te),Tt()}function Ci(r="script"){return`${r}-${Math.random().toString(36).slice(2,8)}-${Date.now().toString(36)}`}const ra=kt([]),fa=kt(null),ln=kt(null),Ti=Ft([ra,ln],([r,t])=>r.filter(a=>a.scope==="global"||a.scope==="page"&&a.pageId===t)),pr=Ft([ra,fa],([r,t])=>t?r.find(a=>a.id===t)??null:null),fr=kt(null),Si=fr;function Ai(r,t){const a=Xe(pr);if(!a)return{ok:!1,reason:"no-script"};if(a.scope==="page"){const l=a.pageId??null,d=(t==null?void 0:t.pageId)??null;if(!d||l!==d)return{ok:!1,reason:"scope-mismatch",script:a,targetPage:d}}const n={id:Date.now()+Math.floor(Math.random()*1e3),scriptId:a.id,type:"insert-text",payload:{text:r}};return fr.set(n),{ok:!0,command:n}}function Bi(r){fr.update(t=>t&&t.id===r?null:t)}function Mi(r){fa.set(r)}function Zi(r){const t=Date.now(),d={id:Ci(),name:"New Script",scope:"global",pageId:null,code:`// start typing...
`,createdAt:t,updatedAt:t};return ra.update(o=>[...o,d]),fa.set(d.id),d.id}function Li(){const r=Xe(fa);r&&ra.update(t=>{const a=t.findIndex(d=>d.id===r);if(a===-1)return t;const n=t.slice();n.splice(a,1);const l=Math.min(a,n.length-1);return fa.set(l>=0?n[l].id:null),n})}function $i(r,t){ra.update(a=>a.map(n=>n.id===r?{...n,code:t,updatedAt:Date.now()}:n))}function Ni(r,t){ra.update(a=>a.map(n=>n.id===r?{...n,name:t,updatedAt:Date.now()}:n))}function Wi(r){ra.update(t=>t.map(a=>{if(a.id!==r)return a;const n=a.scope==="global"?"page":"global",l=n==="page"?Xe(ln)??null:null;return{...a,scope:n,pageId:l,updatedAt:Date.now()}}))}var qi=f('<div class="h-full w-full"></div>');function Hi(r,t){Ct(t,!1);let a=He(t,"scriptId",8),n=He(t,"code",8,""),l=He(t,"readOnly",8,!1),d=He(t,"onChange",8),o=He(t,"variableTypeDefs",8,null),M=He(t,"runtimeSymbols",24,()=>[]),T=Ie(),S=Ie(null),_=Ie(null),q=Ie(null),k=Ie(null),V=null,G=null,C=null,R=null;const de=ir();let L=null;function j(p,A){try{const D=p.getOffsetAt(A),N=p.getValue().slice(0,D);if(/Mava\.variables\.[\w$]*$/u.test(N))return"variables";if(/Mava\.timeline\.[\w$]*$/u.test(N))return"timeline";if(/Mava\.elements\.[\w$]*$/u.test(N))return"elements";if(/Mava\.builtin\.[\w$]*$/u.test(N))return"builtin";if(/Mava\.[\w$]*$/u.test(N))return"root"}catch{}return"any"}function _e(){var p;if(e(q)){if(L){try{(p=L.dispose)==null||p.call(L)}catch{}L=null}!M()||M().length===0||(L=e(q).languages.registerCompletionItemProvider("typescript",{triggerCharacters:[".",..."abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ$_0123456789".split("")],provideCompletionItems:(A,D)=>{try{const le=A.getWordUntilPosition(D),N={startLineNumber:D.lineNumber,startColumn:le.startColumn,endLineNumber:D.lineNumber,endColumn:le.endColumn},fe=j(A,D);return{suggestions:(M()??[]).filter(I=>{const h=I.contexts??["any"];return h.includes("any")||h.includes(fe)}).map(I=>({label:I.label,kind:I.kind??e(q).languages.CompletionItemKind.Variable,insertText:I.insertText??I.label,detail:I.detail,documentation:I.documentation,sortText:I.sortText,filterText:I.filterText,commitCharacters:I.commitCharacters,range:N}))}}catch{return{suggestions:[]}}}}))}}async function Fe(){try{if(!e(q))return;const A=await(await e(q).languages.typescript.getTypeScriptWorker())(e(_).uri),D=["async function test(){","  await Promise.resolve(1);","  document.body;","}"].join(`
`),le=e(q).editor.createModel(D,"typescript"),N=await A.getSemanticDiagnostics(le.uri.toString());le.dispose();const fe=N.map(ie=>({start:ie.start||0,end:(ie.start||0)+(ie.length||0),message:e(q).MarkerSeverity?ie.messageText:String(ie.messageText),severity:ie.category??1}));de("selfTest",{flags:e(q).languages.typescript.typescriptDefaults.getCompilerOptions(),diagnostics:fe}),de("libInfo",{defaultLib:"(monaco builtin)",length:0,hasPromise:fe.length===0,hasDocument:fe.length===0,build:"monaco-typescript"})}catch(p){de("libInfo",{error:String(p)})}}function Be(p){if(!e(S)||!e(_)||typeof p!="string")return;const A=e(S).getModel();if(!A)return;const le=e(S).getSelection()??(e(q)?new(e(q)).Range(1,1,1,1):null);if(!le)return;const N=le.getStartPosition(),fe=A.getOffsetAt(N),ie=p;e(S).executeEdits("mava-insert",[{range:le,text:ie,forceMoveMarkers:!0}]);const I=fe+ie.length,h=A.getPositionAt(I);e(S).setPosition(h),e(S).revealPositionInCenter(h),e(S).focus()}ga(async()=>{try{g(q,await Sr(()=>import("../chunks/DaNq8MIJ.js").then(A=>A.e),__vite__mapDeps([0,1,2,3]),import.meta.url))}catch{console.warn("Monaco not installed. Run: bun add monaco-editor vite-plugin-monaco-editor");return}try{const A={base:"vs-dark",inherit:!0,rules:[{token:"keyword",foreground:"225588"},{token:"type",foreground:"9966B8",fontStyle:"italic"},{token:"string",foreground:"22AA44"},{token:"number",foreground:"F280D0"},{token:"comment",foreground:"384887"},{token:"function",foreground:"DDBB88"}],colors:{"editor.background":"#000C18","editor.foreground":"#6688CC","editorCursor.foreground":"#DDBB88","editor.selectionBackground":"#770811","editor.lineHighlightBackground":"#082050","editorGutter.background":"#000C18","editorLineNumber.foreground":"#406385","editorActiveLineNumber.foreground":"#80A2C2","editorIndentGuide.background":"#103050","editorBracketMatch.border":"#596f99","editorBracketMatch.background":"#596f9955"}};e(q).editor.defineTheme("abyss",A),e(q).editor.setTheme("abyss")}catch{}e(q).languages.typescript.typescriptDefaults.setCompilerOptions({target:e(q).languages.typescript.ScriptTarget.ESNext,module:e(q).languages.typescript.ModuleKind.ESNext,allowJs:!1,esModuleInterop:!1,noImplicitAny:!1,lib:["esnext"],moduleResolution:e(q).languages.typescript.ModuleResolutionKind.NodeNext,allowNonTsExtensions:!0});async function p(){try{const A=await Sr(()=>import("../chunks/DwMp_OeT.js"),[],import.meta.url),D=A.default??A;return String(D)}catch{}try{const A=new URL("data:video/mp2t;base64,Ly8gR2VuZXJhdGVkIGJ5IHRvb2xzL2dlbmVyYXRlLW1hdmEtZHRzLnRzIG9uIDIwMjUtMTAtMTBUMDQ6NTA6NDAuMDE5WgovLyBEbyBub3QgZWRpdCB0aGlzIGZpbGUgZGlyZWN0bHk7IHJ1biAiYnVuIHRvb2xzL2dlbmVyYXRlLW1hdmEtZHRzLnRzIiBpbnN0ZWFkLgoKdHlwZSBVbnN1YnNjcmliZSA9ICgpID0+IHZvaWQ7CmludGVyZmFjZSBSZWFkb25seVNpZ25hbDxUPiB7CiAgICByZWFkb25seSB2YWx1ZTogVDsKICAgIHN1YnNjcmliZShmbjogKHZhbHVlOiBUKSA9PiB2b2lkKTogVW5zdWJzY3JpYmU7Cn0KaW50ZXJmYWNlIFNpZ25hbDxUPiBleHRlbmRzIFJlYWRvbmx5U2lnbmFsPFQ+IHsKICAgIHNldCh2YWx1ZTogVCk6IHZvaWQ7CiAgICB1cGRhdGUodXBkYXRlcjogKHByZXY6IFQpID0+IFQpOiB2b2lkOwp9CmRlY2xhcmUgbmFtZXNwYWNlIE1hdmFUeXBlcyB7CiAgICB0eXBlIEVudGl0eUlkID0gc3RyaW5nOwogICAgaW50ZXJmYWNlIFZlY3RvcjIgewogICAgICAgIHg6IG51bWJlcjsKICAgICAgICB5OiBudW1iZXI7CiAgICB9Cn0KaW50ZXJmYWNlIE1hdmFWYXJpYWJsZUFQSSB7CiAgICAvKiogR2V0IGEgcmVhY3RpdmUgcmVhZC1vbmx5IHNpZ25hbCBmb3IgYSB2YXJpYWJsZSBieSBuYW1lLCBzY29wZWQgKHBhZ2Ugb3ZlcnJpZGVzIGdsb2JhbCkuICovCiAgICAvKiogR2V0IGEgbXV0YWJsZSBzaWduYWwgKGlmIHZhcmlhYmxlIGlzIHdyaXRhYmxlKS4gU2V0dGluZyB0aGUgdmFsdWUgdXBkYXRlcyB0aGUgdmFyaWFibGUuICovCiAgICAvKiogUmVhZCBjdXJyZW50IHZhbHVlIChub24tcmVhY3RpdmUgc25hcHNob3QpLiAqLwogICAgLyoqIFdyaXRlIGEgdmFsdWUgKG5vLW9wIGlmIHJlYWRPbmx5KS4gKi8KICAgIC8qKiBEaXJlY3QgcHJvcGVydHkgYWNjZXNzIHRvIHZhcmlhYmxlIHZhbHVlcywgZS5nLiBgTWF2YS52YXJpYWJsZXMudXNlcm5hbWVgLiAqLwogICAgW3ZhcmlhYmxlTmFtZTogc3RyaW5nXTogYW55Owp9CmludGVyZmFjZSBNYXZhVGltZWxpbmVTbmFwc2hvdCB7CiAgICBpZD86IHN0cmluZzsKICAgIG5hbWU/OiBzdHJpbmc7CiAgICBkdXJhdGlvbj86IG51bWJlcjsKICAgIHBsYXlpbmc/OiBib29sZWFuOwogICAgdGltZT86IG51bWJlcjsKICAgIFtrOiBzdHJpbmddOiBhbnk7Cn0KaW50ZXJmYWNlIE1hdmFUaW1lbGluZUFQSSBleHRlbmRzIE1hdmFUaW1lbGluZVNuYXBzaG90IHsKICAgIC8qKiBDdXJyZW50IHNuYXBzaG90IHZhbHVlLiBNaXJyb3JzIHNwcmVhZCBwcm9wZXJ0aWVzIGZvciBlcmdvbm9taWMgYWNjZXNzLiAqLwogICAgLyoqIFJlYWN0aXZlIHRpbWVsaW5lIGluZm8gZmVlZC4gKi8KICAgIC8qKiBTdWJzY3JpYmUgdG8gdGltZWxpbmUgY2hhbmdlIGV2ZW50cy4gKi8KICAgIG9uQ2hhbmdlKGZuOiAoc25hcHNob3Q6IE1hdmFUaW1lbGluZVNuYXBzaG90KSA9PiB2b2lkKTogVW5zdWJzY3JpYmU7CiAgICAvKiogUmVxdWVzdCBwbGF5YmFjayBzdGFydCBmcm9tIHRoZSBob3N0IGVudmlyb25tZW50LiAqLwogICAgcGxheSgpOiB2b2lkOwogICAgLyoqIFJlcXVlc3QgcGxheWJhY2sgcGF1c2UgZnJvbSB0aGUgaG9zdCBlbnZpcm9ubWVudC4gKi8KICAgIHBhdXNlKCk6IHZvaWQ7CiAgICAvKiogU2VlayB0byBhIHRpbWVzdGFtcCAoaW4gbWlsbGlzZWNvbmRzKSBvbiB0aGUgaG9zdCB0aW1lbGluZS4gKi8KICAgIHNlZWsodGltZTogbnVtYmVyKTogdm9pZDsKfQppbnRlcmZhY2UgTWF2YUVsZW1lbnRTbmFwc2hvdCB7CiAgICBpZDogc3RyaW5nOwogICAgbmFtZT86IHN0cmluZzsKICAgIHR5cGU/OiBzdHJpbmc7CiAgICBwYWdlSWQ/OiBzdHJpbmcgfCBudWxsOwogICAgcGFyZW50SWQ/OiBzdHJpbmcgfCBudWxsOwogICAgcG9zaXRpb24/OiB7CiAgICAgICAgeDogbnVtYmVyOwogICAgICAgIHk6IG51bWJlcjsKICAgIH07CiAgICBzaXplPzogewogICAgICAgIHdpZHRoPzogbnVtYmVyOwogICAgICAgIGhlaWdodD86IG51bWJlcjsKICAgICAgICBkaW1lbnNpb25zPzogewogICAgICAgICAgICB3aWR0aDogbnVtYmVyOwogICAgICAgICAgICBoZWlnaHQ6IG51bWJlcjsKICAgICAgICB9OwogICAgfTsKICAgIHJvdGF0aW9uPzogbnVtYmVyOwogICAgb3BhY2l0eT86IG51bWJlcjsKICAgIHZpc2libGU/OiBib29sZWFuOwogICAgbG9ja2VkPzogYm9vbGVhbjsKICAgIHpJbmRleD86IG51bWJlcjsKICAgIFtrOiBzdHJpbmddOiBhbnk7Cn0KdHlwZSBNYXZhRWxlbWVudE11dGF0aW9ucyA9IFBhcnRpYWw8TWF2YUVsZW1lbnRTbmFwc2hvdD47CmludGVyZmFjZSBNYXZhRWxlbWVudHNBUEkgewogICAgLyoqIFNuYXBzaG90IGxpc3Qgb2YgZWxlbWVudHMgb24gdGhlIGFjdGl2ZSBwYWdlIChzaGFsbG93IGNvcHkpLiAqLwogICAgbGlzdCgpOiBNYXZhRWxlbWVudFNuYXBzaG90W107CiAgICAvKiogTG9va3VwIGVsZW1lbnQgYnkgaWQuICovCiAgICBnZXQoaWQ6IHN0cmluZyk6IE1hdmFFbGVtZW50U25hcHNob3QgfCB1bmRlZmluZWQ7CiAgICAvKiogTG9va3VwIGVsZW1lbnQgYnkgZGlzcGxheSBuYW1lIChwYWdlIHNjb3BlKS4gKi8KICAgIGJ5TmFtZShuYW1lOiBzdHJpbmcpOiBNYXZhRWxlbWVudFNuYXBzaG90IHwgdW5kZWZpbmVkOwogICAgLyoqIFJlYWN0aXZlIHNpZ25hbCB0cmFja2luZyBlbGVtZW50IHNuYXBzaG90IGxpc3QuICovCiAgICByZWFkb25seSBzaWduYWw6IFJlYWRvbmx5U2lnbmFsPE1hdmFFbGVtZW50U25hcHNob3RbXT47CiAgICAvKiogU3Vic2NyaWJlIHRvIGVsZW1lbnQgc25hcHNob3QgdXBkYXRlcy4gKi8KICAgIG9uQ2hhbmdlKGZuOiAoc25hcHNob3Q6IE1hdmFFbGVtZW50U25hcHNob3RbXSkgPT4gdm9pZCk6IFVuc3Vic2NyaWJlOwogICAgLyoqIFJlcXVlc3QgYSBwYXJ0aWFsIG11dGF0aW9uIHRvIGJlIGFwcGxpZWQgYnkgdGhlIGhvc3QgZWRpdG9yLiAqLwogICAgcGF0Y2goaWQ6IHN0cmluZywgY2hhbmdlczogTWF2YUVsZW1lbnRNdXRhdGlvbnMsIG9wdHM/OiB7CiAgICAgICAgcGFnZUlkPzogc3RyaW5nOwogICAgfSk6IHZvaWQ7CiAgICAvKiogQWxpYXMgb2YgcGF0Y2ggZm9yIGNvbXBhdGliaWxpdHkuICovCiAgICBzZXQoaWQ6IHN0cmluZywgbmV4dDogTWF2YUVsZW1lbnRNdXRhdGlvbnMsIG9wdHM/OiB7CiAgICAgICAgcGFnZUlkPzogc3RyaW5nOwogICAgfSk6IHZvaWQ7Cn0KaW50ZXJmYWNlIE1hdmFCdWlsdGluQVBJIHsKICAgIHByb2plY3Q6IFJlYWRvbmx5U2lnbmFsPHsKICAgICAgICBpZD86IHN0cmluZzsKICAgICAgICB0aXRsZT86IHN0cmluZzsKICAgICAgICB2ZXJzaW9uPzogbnVtYmVyOwogICAgICAgIFtrOiBzdHJpbmddOiBhbnk7CiAgICB9PjsKICAgIHBhZ2U6IFJlYWRvbmx5U2lnbmFsPHsKICAgICAgICBpZDogc3RyaW5nIHwgbnVsbDsKICAgICAgICBlbGVtZW50czogTWF2YUVsZW1lbnRTbmFwc2hvdFtdOwogICAgfT47Cn0KaW50ZXJmYWNlIE1hdmFBUEkgewogICAgcmVhZG9ubHkgdGltZTogUmVhZG9ubHlTaWduYWw8bnVtYmVyPjsKICAgIG9uVGljayhmbjogKHQ6IG51bWJlciwgZHQ6IG51bWJlcikgPT4gdm9pZCk6IFVuc3Vic2NyaWJlOwogICAgbG9nKC4uLmFyZ3M6IGFueVtdKTogdm9pZDsKICAgIHdhcm4oLi4uYXJnczogYW55W10pOiB2b2lkOwogICAgZXJyb3IoLi4uYXJnczogYW55W10pOiB2b2lkOwogICAgc2V0VGltZW91dChmbjogKCkgPT4gdm9pZCwgbXM6IG51bWJlcik6IFVuc3Vic2NyaWJlOwogICAgc2V0SW50ZXJ2YWwoZm46ICgpID0+IHZvaWQsIG1zOiBudW1iZXIpOiBVbnN1YnNjcmliZTsKICAgIGxlcnAoYTogbnVtYmVyLCBiOiBudW1iZXIsIHQ6IG51bWJlcik6IG51bWJlcjsKICAgIHZhcmlhYmxlczogTWF2YVZhcmlhYmxlQVBJOwogICAgdGltZWxpbmU6IE1hdmFUaW1lbGluZUFQSTsKICAgIGJ1aWx0aW46IE1hdmFCdWlsdGluQVBJOwp9CgpkZWNsYXJlIGNvbnN0IE1hdmE6IE1hdmFBUEk7Cg==",import.meta.url),D=await fetch(A);if(D.ok)return await D.text()}catch{}return`declare interface ReadonlySignal<T>{readonly value:T;subscribe(fn:(v:T)=>void):()=>void;}
declare interface Signal<T> extends ReadonlySignal<T>{set(v:T):void;update(u:(p:T)=>T):void;}
declare type Unsubscribe=()=>void;
declare namespace MavaTypes{type EntityId=string;interface Vector2{x:number;y:number}}
declare interface MavaAPI{readonly time:ReadonlySignal<number>;onTick(fn:(t:number,dt:number)=>Unsubscribe):Unsubscribe;readonly selection:ReadonlySignal<MavaTypes.EntityId|null>;signal<T>(i:T):Signal<T>;computed<T>(c:()=>T):ReadonlySignal<T>;effect(fn:()=>void):Unsubscribe;log(...a:any[]):void;warn(...a:any[]):void;error(...a:any[]):void;setTimeout(fn:()=>void,ms:number):Unsubscribe;setInterval(fn:()=>void,ms:number):Unsubscribe;lerp(a:number,b:number,t:number):number;}
declare const Mava: MavaAPI;
`}try{const A=await p();e(q).languages.typescript.typescriptDefaults.addExtraLib(A,"file:///mava.api.d.ts")}catch(A){console.warn("Failed to inject Mava API typings; Mava completions may be limited.",A)}g(_,e(q).editor.createModel(n()??"","typescript")),g(S,e(q).editor.create(e(T),{model:e(_),theme:"abyss",minimap:{enabled:!1},wordWrap:"on",automaticLayout:!0,readOnly:l(),suggestOnTriggerCharacters:!0,quickSuggestions:{other:!0,comments:!0,strings:!0}})),V=e(S).onDidChangeModelContent(A=>{var le;const D=e(_).getValue();(le=d())==null||le(D);try{if(A.isFlush)return;const N=A.changes||[],fe=N[N.length-1];(fe==null?void 0:fe.text)==="."&&e(S).trigger("suggest","editor.action.triggerSuggest",{})}catch{}}),_e(),G=Si.subscribe(A=>{A&&A.scriptId===a()&&A.type==="insert-text"&&(Be(A.payload.text),Bi(A.id))}),await Fe(),g(k,a())}),or(()=>{var p,A,D,le,N,fe,ie;try{(p=V==null?void 0:V.dispose)==null||p.call(V)}catch{}try{(A=L==null?void 0:L.dispose)==null||A.call(L)}catch{}try{(le=(D=e(S))==null?void 0:D.dispose)==null||le.call(D)}catch{}try{(fe=(N=e(_))==null?void 0:N.dispose)==null||fe.call(N)}catch{}try{(ie=C==null?void 0:C.dispose)==null||ie.call(C),C=null}catch{}try{G==null||G(),G=null}catch{}});function re(p){var D;if(!e(q))return;const A=p?p.trim():"";if(R!==A){R=A;try{(D=C==null?void 0:C.dispose)==null||D.call(C)}catch{}C=null,A&&(C=e(q).languages.typescript.typescriptDefaults.addExtraLib(A,"file:///mava.variables.d.ts"))}}wt(()=>(e(S),e(_),m(a()),e(k),m(n()),m(l())),()=>{if(e(S)&&e(_)){if(a()!==e(k))e(_).setValue(n()??""),g(k,a());else{const p=e(_).getValue();n()!=null&&n()!==p&&e(_).pushEditOperations([],[{range:e(_).getFullModelRange(),text:n()}],()=>null)}e(S).updateOptions({readOnly:l()})}}),wt(()=>(m(M()),e(q)),()=>{M()&&e(q)&&_e()}),wt(()=>(e(q),m(o())),()=>{e(q)&&re(o())}),ea(),Bt();var W=qi();return Gt(W,p=>g(T,p),()=>e(T)),u(r,W),io(t,"insertText",Be),Tt({insertText:Be})}function Pi(){const r=new Worker(new URL(""+new URL("../workers/sandboxWorker-BvtdsBJR.js",import.meta.url).href,import.meta.url),{type:"module"}),t=new Set,a=new Set;r.onmessage=l=>{const d=l.data||{};if(d.type==="log"){const{level:o,args:M}=d;for(const T of Array.from(t))try{T(o,M)}catch{}return}for(const o of Array.from(a))try{o(d)}catch{}};function n(l,d){r.postMessage({type:l,payload:d})}return{run:async l=>{n("run",{code:l})},stop:async()=>{n("stop")},setTime:(l,d)=>n("setTime",{t:l,dt:d}),setSelection:l=>n("setSelection",{id:l}),setVar:(l,d)=>n("setVar",{name:l,value:d}),setBuiltin:l=>n("setBuiltin",l),onLog:l=>(t.add(l),()=>t.delete(l)),onEvent:l=>(a.add(l),()=>a.delete(l))}}function Ei(){Lt.clear()}function Vi(r,t,a,n,l){t()&&(g(a,!0),g(n,t().name),queueMicrotask(()=>{var d;return(d=e(l))==null?void 0:d.focus()}),queueMicrotask(()=>{var d;return(d=e(l))==null?void 0:d.select()}))}var Ri=(r,t)=>t("scripts"),Di=(r,t)=>t("timeline"),zi=(r,t)=>t("output"),Fi=()=>Zi(),Gi=()=>Li(),ji=(r,t,a,n)=>e(t)?a():n(),Oi=qt('<path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 6h12v12H6z"></path>'),Yi=qt('<path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 5v14l11-7-11-7z"></path>'),Ki=f('<button type="button" class="inline-flex items-center justify-center cursor-pointer text-gray-800 dark:text-white" aria-label="Add script"><svg class="w-4 h-4" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 12h14m-7 7V5"></path></svg></button> <button type="button" class="inline-flex items-center cursor-pointer justify-center text-gray-800 dark:text-white" aria-label="Delete selected script"><svg class="w-4 h-4" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 7h14m-9 3v8m4-8v8M10 3h4a1 1 0 0 1 1 1v3H9V4a1 1 0 0 1 1-1ZM6 7h12v13a1 1 0 0 1-1 1H7a1 1 0 0 1-1-1V7Z"></path></svg></button> <button type="button" class="inline-flex items-center cursor-pointer justify-center text-gray-800 dark:text-white"><svg class="w-4 h-4" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><!></svg></button>',1),Ui=(r,t)=>t(),Ji=qt('<path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 8h4V4m12 4h-4V4M4 16h4v4m12-4h-4v4"></path>'),Xi=qt('<path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 4H4m0 0v4m0-4 5 5m7-5h4m0 0v4m0-4-5 5M8 20H4m0 0v-4m0 4 5-5m7 5h4m0 0v-4m0 4-5-5"></path>'),Qi=(r,t)=>t(),el=(r,t,a)=>{r.key==="Enter"?t():r.key==="Escape"&&a()},tl=f('<input class="min-w-0 flex-1 bg-transparent outline-none border border-slate-300 dark:border-slate-600 rounded px-1 py-0.5 text-slate-700 dark:text-slate-200" type="text"/>'),al=r=>{r.detail},rl=f('<button type="button" class="truncate select-none text-left bg-transparent p-0 m-0 underline-offset-2 hover:underline" title="Double-click to rename"> </button>'),nl=(r,t)=>Wi(t().id),ol=f('<!> <button type="button" class="capitalize cursor-pointer" title="Toggle scope"> </button>',1),il=f("<span>No script selected</span>"),ll=f('<span class="px-1.5 py-0.5 rounded bg-rose-100 text-rose-700 dark:bg-rose-900/30 dark:text-rose-300">TS libs: error</span>'),sl=f('<span class="px-1.5 py-0.5 rounded bg-emerald-100 text-emerald-700 dark:bg-emerald-900/30 dark:text-emerald-300"> </span>'),cl=f('<div class="h-full w-full grid place-items-center text-slate-400 text-xs">No script selected</div>'),dl=(r,t)=>Mi(e(t).id),ul=f('<li><button type="button"><span class="truncate"> </span></button></li>'),vl=f('<div class="flex-1 h-full grid grid-cols-[1fr_8rem] gap-0 min-h-0"><div class="min-h-0 flex flex-col border-r border-slate-200 dark:border-slate-700"><div class="px-2 py-1 text-xs text-slate-500 dark:text-slate-400 border-b border-slate-200 dark:border-slate-700 flex items-center gap-2 justify-between"><div class="flex items-center gap-2 min-w-0"><!></div> <div class="flex items-center gap-2 shrink-0"><!></div></div> <div class="flex-1 min-h-0"><!></div></div> <div class="min-h-0 flex flex-col"><div class="px-2 py-1 text-xs text-slate-500 dark:text-slate-400 border-b border-slate-200 dark:border-slate-700">Scripts</div> <div class="flex-1 overflow-auto"><ul class="text-xs divide-y divide-slate-200 dark:divide-slate-700"></ul></div></div></div>'),pl=f('<li class="px-2 py-1"><span class="mr-2 opacity-60"> </span> <span> </span> <span> </span></li>'),fl=f('<div class="flex-1 overflow-auto"><ul class="text-xs divide-y divide-slate-200 dark:divide-slate-700"></ul></div> <div class="p-2 border-t border-slate-200 dark:border-slate-700 flex gap-2"><button class="px-2 py-0.5 rounded bg-slate-200 dark:bg-slate-700 hover:bg-slate-300 dark:hover:bg-slate-600">Clear</button></div>',1),gl=f('<div class="text-sm h-[92%]"><section class="flex justify-between px-2"><ul class="flex my-2"><li class="me-2 cursor-pointer"><button type="button">Scripts</button></li> <li class="me-2 cursor-pointer"><button type="button">Timeline</button></li> <li class="me-2 cursor-pointer"><button type="button">Output</button></li></ul> <div class="flex space-x-4 my-2"><!> <button type="button" class="inline-flex items-center cursor-pointer justify-center text-gray-800 dark:text-white" aria-label="Toggle full screen"><svg class="w-4 h-4" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><!></svg></button> <button type="button" class="inline-flex items-center cursor-pointer justify-center text-gray-800 dark:text-white" aria-label="Close terminal"><svg class="w-4 h-4" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18 17.94 6M18 18 6.06 6"></path></svg></button></div></section> <section class="flex flex-col h-full"><!></section></div>');function ml(r,t){Ct(t,!1);const[a,n]=Kt(),l=()=>ut(pr,"$selectedScript",a),d=()=>ut(C,"$terminalTab",a),o=()=>ut(G,"$terminalState",a),M=()=>ut(A,"$runtimeCompletions",a),T=()=>ut(Be,"$variableTypeDefsSource",a),S=()=>ut(Ti,"$visibleScripts",a),_=()=>ut(fa,"$selectedScriptId",a),q=()=>ut(de,"$entries",a),{toggleFull:k,closeTerminal:V,terminalState:G,terminalTab:C,setTerminalTab:R}=ma,de=Ft(Lt,F=>F);function L(F){switch(F){case"string":return"string";case"number":return"number";case"boolean":return"boolean";case"json":return"unknown";case"object":return"Record<string, unknown>";case"array":return"unknown[]";default:return"any"}}function j(F){return F.replace(/\\/g,"\\\\").replace(/'/g,"\\'")}function _e(F){return/^[$A-Z_a-z][$\w]*$/u.test(F)}function Fe(F){const K=`// Auto-generated variable typings from current project state
`;if(!F.length)return`${K}interface MavaVariableAPI {
  /* no user variables declared yet */
}
`;const qe=[],b=[],w=[],x=[],z=[],Ce=[...F].sort((Oe,Le)=>Oe.name.localeCompare(Le.name));for(const Oe of Ce){const Le=Oe.name,nt=j(Le),ze=L(Oe.type),ot=Oe.scope==="global"?"global":`page:${Oe.pageId??"unknown"}`,bt=_e(Le)?Le:`['${nt}']`,_t=`  /** variable "${Le}" (${ot}) · ${ze} */`;qe.push(_t),qe.push(`  ${Oe.readOnly?"readonly ":""}${bt}: ${ze};`),b.push(_t),b.push(`  get(name: '${nt}'): ${ze};`),w.push(_t),w.push(`  readonly(name: '${nt}'): ReadonlySignal<${ze}>;`),Oe.readOnly||(x.push(_t),x.push(`  set(name: '${nt}', value: ${ze}): void;`),z.push(_t),z.push(`  mutable(name: '${nt}'): Signal<${ze}>;`))}const Ve=[K,"interface MavaVariableAPI {"];return Ve.push(...qe),Ve.push(...b),Ve.push(...w),x.length&&Ve.push(...x),z.length&&Ve.push(...z),Ve.push(`}
`),Ve.join(`
`)}const Be=Ft(la,F=>Fe(F));function re(F){switch(F){case"string":return"";case"number":return 0;case"boolean":return!1;case"json":case"object":return{};case"array":return[];default:return}}function W(F,K){return K!==void 0?K:re(F.type)}function p(F,K,qe){for(const b of K){const w=qe[b.id],x=W(b,w);try{F.setVar(b.name,x)}catch{}}}const A=Ft([la,Nt],([F,K])=>{const qe=[],b=[];for(const w of F)(w.scope==="global"||w.scope==="page"&&w.pageId===K)&&b.push({name:w.name,type:L(w.type),readOnly:!!w.readOnly,scope:w.scope==="global"?"Global":`Page · ${w.pageId??"unknown"}`});return b.sort((w,x)=>w.name.localeCompare(x.name)).forEach((w,x)=>{qe.push({label:w.name,detail:`Variable · ${w.type}`,documentation:`${w.scope} variable "${w.name}" (${w.type})${w.readOnly?" · read-only":""}`,contexts:["variables"],sortText:`az${x.toString().padStart(3,"0")}`})}),qe});let D=Ie(!1),le=Ie(""),N=Ie(null);function fe(){g(D,!1)}function ie(){l()&&e(le).trim()&&e(le)!==l().name&&Ni(l().id,e(le).trim()),g(D,!1)}const I=Pi();let h=Ie(!1),H=null,se=null,me=null,ce=null,ne=null;function ue(){if(ce!=null)return;const F=K=>{if(!e(h)){ce=null;return}const b=K-(ne??K);ne=K;try{I.setTime(K,b)}catch{}ce=requestAnimationFrame(F)};ce=requestAnimationFrame(F)}function oe(){ce!=null&&(cancelAnimationFrame(ce),ce=null),ne=null}function Ge(F){if(F===null||typeof F!="object")return F;if(typeof structuredClone=="function")try{return structuredClone(F)}catch{}try{return JSON.parse(JSON.stringify(F))}catch{}return Array.isArray(F)?F.slice():{...F}}function je(){var w;const F=Xe(aa),K=Xe(Nt);if(!K)return{id:null,elements:[]};const qe=(w=F==null?void 0:F.pagesById)==null?void 0:w[K];if(!qe)return{id:K,elements:[]};const b=qe.elements.map(x=>{const z=Ge(x);return z&&typeof z=="object"&&(z.pageId=K),z});return{id:K,elements:b}}async function Re(){if(!l()){Lt.append("warn","No script selected");return}try{await I.stop()}catch{}H&&(H(),H=null),se&&(se(),se=null),me&&(me(),me=null),H=I.onLog((x,z)=>{const Ce=z.map(Oe=>typeof Oe=="string"?Oe:JSON.stringify(Oe)).join(" "),Ve=x==="error"?"error":x==="warn"?"warn":"info";Lt.append(Ve,Ce,{source:"script"})}),se=I.onEvent(x=>{if(x){if(x.type==="runtimeError")Lt.append("error",x.message||"Runtime error",{stack:x.stack});else if(x.type==="ran")Lt.append("info","Script ran");else if(x.type==="stopped")Lt.append("info","Script stopped");else if(x.type==="elementPatch"){const z=x.payload??x;z!=null&&z.id&&(z!=null&&z.changes)&&typeof z.changes=="object"&&En(String(z.id),z.changes,{pageId:z.pageId??void 0,reason:"style"})}else if(x.type==="timelineCommand"){const z=x.payload??x,Ce=(z&&typeof z=="object"?z.action:void 0)??"unknown";Lt.append("info",`Timeline command from script: ${Ce}`,{source:"script"})}}}),me=er.subscribe(x=>{try{I.setSelection(x)}catch{}});try{I.setSelection(Xe(er))}catch{}try{const x=Xe(la),z=Xe(Ma);p(I,x,z)}catch{}const F=Ma.subscribe(x=>{try{const z=Xe(la);p(I,z,x)}catch{}});ve.push(()=>F());const K=la.subscribe(x=>{try{const z=Xe(Ma);p(I,x,z)}catch{}});ve.push(()=>K());const qe=()=>{var Oe,Le,nt;const x=Xe(aa),z={title:(Le=(Oe=x.course)==null?void 0:Oe.metadata)==null?void 0:Le.title,version:x.projectVersion},Ce={time:((nt=performance.now)==null?void 0:nt.call(performance))??Date.now()},Ve=je();try{I.setBuiltin({project:z,timeline:Ce,page:Ve})}catch{}};qe();const b=aa.subscribe(()=>qe()),w=Nt.subscribe(()=>qe());ve.push(()=>w()),ve.push(()=>b());try{await I.run(l().code??""),g(h,!0),ue()}catch(x){Lt.append("error",(x==null?void 0:x.message)||String(x)||"Failed to run script")}}const ve=[];async function Me(){g(h,!1),oe();try{await I.stop()}catch{}for(H&&(H(),H=null),se&&(se(),se=null),me&&(me(),me=null);ve.length;){const F=ve.pop();try{F&&F()}catch{}}}let U=Ie(null),ge=Ie(null),he=Ie(null),we=Ie("");function te(F){return F===1?"error":F===0?"warning":"info"}function J(F){const K=F.detail;K&&typeof K=="object"&&"error"in K?(g(U,null),g(ge,String(K.error))):(g(ge,null),g(U,K))}function O(F){g(he,F.detail||null)}wt(()=>(e(U),e(he)),()=>{var F,K;if(!e(U))g(we,"");else{const qe=[`lib=${e(U).defaultLib}`,`length=${e(U).length}`,`Promise=${e(U).hasPromise}`,`Document=${e(U).hasDocument}`,`source=${e(U).libSource??"?"}`,`getLibFromBundle=${e(U).hasGetLibFileFromBundle?"yes":"no"}`,`libMap=${e(U).hasLibMap?"yes":"no"}`,`libsCount=${e(U).libsCount??0}`,`build=${e(U).build??""}`],b=((K=(F=e(he))==null?void 0:F.diagnostics)==null?void 0:K.length)??0;if(qe.push(`selfDiag=${b}`),b>0){const w=e(he).diagnostics.slice(0,5).map((x,z)=>{const Ce=(x.message||"").replace(/\s+/g," ").slice(0,200);return`  #${z+1} [${te(x.severity)}] ${Ce}`});e(he).diagnostics.length>w.length&&w.push(`  …and ${e(he).diagnostics.length-w.length} more`),qe.push(`selfDiagMessages:
`+w.join(`
`))}g(we,qe.join(`
`))}}),ea(),Bt();var y=gl(),Z=s(y),P=s(Z),ke=s(P),pe=s(ke);pe.__click=[Ri,R],i(ke);var X=v(ke,2),ae=s(X);ae.__click=[Di,R],i(X);var Pe=v(X,2),Y=s(Pe);Y.__click=[zi,R],i(Pe),i(P);var Q=v(P,2),ee=s(Q);{var Ne=F=>{var K=Ki(),qe=be(K);qe.__click=[Fi];var b=v(qe,2);b.__click=[Gi];var w=v(b,2);w.__click=[ji,h,Me,Re];var x=s(w),z=s(x);{var Ce=Oe=>{var Le=Oi();u(Oe,Le)},Ve=Oe=>{var Le=Yi();u(Oe,Le)};$(z,Oe=>{e(h)?Oe(Ce):Oe(Ve,!1)})}i(x),i(w),E(()=>ye(w,"aria-label",e(h)?"Stop script":"Run script")),u(F,K)};$(ee,F=>{d()==="scripts"&&F(Ne)})}var Ze=v(ee,2);Ze.__click=[Ui,k];var xe=s(Ze),De=s(xe);{var Ee=F=>{var K=Ji();u(F,K)},Te=F=>{var K=Xi();u(F,K)};$(De,F=>{o()==="full"?F(Ee):F(Te,!1)})}i(xe),i(Ze);var et=v(Ze,2);et.__click=[Qi,V],i(Q),i(Z);var We=v(Z,2),Se=s(We);{var Ye=F=>{var K=vl(),qe=s(K),b=s(qe),w=s(b),x=s(w);{var z=it=>{var Qe=ol(),lt=be(Qe);{var St=gt=>{var dt=tl();pt(dt),dt.__keydown=[el,ie,fe],Gt(dt,ft=>g(N,ft),()=>e(N)),B("blur",dt,ie),At(dt,()=>e(le),ft=>g(le,ft)),u(gt,dt)},at=gt=>{var dt=rl();dt.__dblclick=[Vi,l,D,le,N],dt.__click=[al];var ft=s(dt,!0);i(dt),E(()=>Ae(ft,(l(),c(()=>l().name)))),u(gt,dt)};$(lt,gt=>{e(D)?gt(St):gt(at,!1)})}var st=v(lt,2);st.__click=[nl,l];var vt=s(st);i(st),E(()=>Ae(vt,`(${l(),c(()=>l().scope=="global"?"Global":"Local")??""})`)),u(it,Qe)},Ce=it=>{var Qe=il();u(it,Qe)};$(x,it=>{l()?it(z):it(Ce,!1)})}i(w);var Ve=v(w,2),Oe=s(Ve);{var Le=it=>{var Qe=ll();E(()=>ye(Qe,"title",e(ge))),u(it,Qe)},nt=it=>{var Qe=$e(),lt=be(Qe);{var St=at=>{var st=sl(),vt=s(st);i(st),E(()=>{ye(st,"title",e(we)),Ae(vt,`TS libs: ${e(U),c(()=>e(U).hasPromise&&e(U).hasDocument?"OK":"Partial")??""}`)}),u(at,st)};$(lt,at=>{e(U)&&at(St)},!0)}u(it,Qe)};$(Oe,it=>{e(ge)?it(Le):it(nt,!1)})}i(Ve),i(b);var ze=v(b,2),ot=s(ze);{var bt=it=>{{let Qe=yt(()=>(l(),c(()=>l().code??"")));Hi(it,{get scriptId(){return l(),c(()=>l().id)},get code(){return e(Qe)},onChange:lt=>$i(l().id,lt),get runtimeSymbols(){return M()},get variableTypeDefs(){return T()},$$events:{libInfo:J,selfTest:O}})}},_t=it=>{var Qe=cl();u(it,Qe)};$(ot,it=>{l()?it(bt):it(_t,!1)})}i(ze),i(qe);var Mt=v(qe,2),$t=v(s(Mt),2),Ht=s($t);Ke(Ht,5,S,tt,(it,Qe)=>{var lt=ul(),St=s(lt);St.__click=[dl,Qe];var at=s(St),st=s(at,!0);i(at),i(St),i(lt),E(()=>{rt(St,1,`w-full px-2 py-1 flex justify-between items-center text-left ${_(),e(Qe),c(()=>_()===e(Qe).id?"bg-slate-100 dark:bg-slate-800":"")??""}`),Ae(st,(e(Qe),c(()=>e(Qe).name)))}),u(it,lt)}),i(Ht),i($t),i(Mt),i(K),u(F,K)},Ue=F=>{var K=$e(),qe=be(K);{var b=x=>{Ii(x,{})},w=x=>{var z=fl(),Ce=be(z),Ve=s(Ce);Ke(Ve,5,q,tt,(nt,ze)=>{var ot=pl(),bt=s(ot),_t=s(bt,!0);i(bt);var Mt=v(bt,2),$t=s(Mt);i(Mt);var Ht=v(Mt,2),it=s(Ht,!0);i(Ht),i(ot),E(Qe=>{Ae(_t,Qe),rt(Mt,1,`mr-2 font-mono ${e(ze),c(()=>e(ze).level==="error"?"text-rose-600":e(ze).level==="warn"?"text-amber-600":"text-emerald-600")??""}`),Ae($t,`[${e(ze),c(()=>e(ze).level)??""}]`),Ae(it,(e(ze),c(()=>e(ze).message)))},[()=>(e(ze),c(()=>new Date(e(ze).time).toLocaleTimeString()))]),u(nt,ot)}),i(Ve),i(Ce);var Oe=v(Ce,2),Le=s(Oe);Le.__click=[Ei],i(Oe),u(x,z)};$(qe,x=>{d()==="timeline"?x(b):x(w,!1)},!0)}u(F,K)};$(Se,F=>{d()==="scripts"?F(Ye):F(Ue,!1)})}i(We),i(y),E(()=>{rt(pe,1,"inline-block border-b-1 rounded-t-lg "+(d()==="scripts"?"text-gray-600 border-gray-300 dark:text-gray-300":"text-gray-500 hover:text-gray-600 hover:border-gray-300 dark:hover:text-gray-300 border-transparent")),ye(pe,"aria-current",d()==="scripts"?"page":void 0),rt(ae,1,"inline-block border-b-1 rounded-t-lg "+(d()==="timeline"?"text-gray-600 border-gray-300 dark:text-gray-300":"text-gray-500 hover:text-gray-600 hover:border-gray-300 dark:hover:text-gray-300 border-transparent")),rt(Y,1,"inline-block border-b-1 rounded-t-lg "+(d()==="output"?"text-gray-600 border-gray-300 dark:text-gray-300":"text-gray-500 hover:text-gray-600 hover:border-gray-300 dark:hover:text-gray-300 border-transparent"))}),u(r,y),Tt(),n()}Ia(["click","keydown","dblclick"]);var hl=f('<li><button type="button"><svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 24 24"><!></svg></button></li>'),bl=f('<li class="cursor-pointer"><svg class="w-7 h-7 text-gray-800 dark:text-white" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 24 24"><!></svg></li>'),_l=f('<section class="h-full flex flex-col justify-between"><ul class="flex flex-col space-y-2 p-2 items-center"></ul> <ul class="mt-4 flex flex-col space-y-2 p-2 items-center"></ul></section>');function wl(r){const[t,a]=Kt(),n=()=>ut(l,"$activeSideNav",t),{activeSideNav:l,setActiveSideNav:d}=ma,o=[{key:"structure",name:"Structure",icon:'<svg class="w-6 h-6" xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="currentColor"><path d="M280-160v-441q0-33 24-56t57-23h439q33 0 56.5 23.5T880-600v320L680-80H360q-33 0-56.5-23.5T280-160ZM81-710q-6-33 13-59.5t52-32.5l434-77q33-6 59.5 13t32.5 52l10 54h-82l-7-40-433 77 40 226v279q-16-9-27.5-24T158-276L81-710Zm279 110v440h280v-160h160v-280H360Zm220 220Z"/></svg>'},{key:"elements",name:"Elements",icon:'<svg class="w-6 h-6" xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="currentColor"><path d="M240-520q-83 0-141.5-58.5T40-720q0-84 58.5-142T240-920q84 0 142 58t58 142q0 83-58 141.5T240-520Zm0-80q51 0 85.5-35t34.5-85q0-51-34.5-85.5T240-840q-50 0-85 34.5T120-720q0 50 35 85t85 35ZM640-40q-33 0-56.5-23.5T560-120v-200q0-33 23.5-56.5T640-400h200q33 0 56.5 23.5T920-320v200q0 33-23.5 56.5T840-40H640Zm0-80h200v-200H640v200Zm100-100ZM240-720Zm469 68L308-252q5 12 8.5 25t3.5 27q0 50-34.5 85T200-80q-50 0-85-35t-35-85q0-51 35-85.5t85-34.5q14 0 27 3.5t25 8.5l400-401q-5-12-8.5-24.5T640-760q0-51 35-85.5t85-34.5q51 0 85.5 34.5T880-760q0 50-34.5 85T760-640q-14 0-26.5-3.5T709-652Z"/></svg>'},{key:"components",name:"Components",icon:'<svg class="w-6 h-6" xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="currentColor"><path d="M240-240h220v-160H240v160Zm0-200h220v-280H240v280Zm260 200h220v-280H500v280Zm0-320h220v-160H500v160ZM200-120q-33 0-56.5-23.5T120-200v-560q0-33 23.5-56.5T200-840h560q33 0 56.5 23.5T840-760v80h80v80h-80v80h80v80h-80v80h80v80h-80v80q0 33-23.5 56.5T760-120H200Zm0-80h560v-560H200v560Zm0-560v560-560Z"/></svg>'},{key:"cf_map",name:"CF Map",icon:'<svg class="w-6 h-6" xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="currentColor"><path d="M200-80q-50 0-85-35t-35-85q0-39 22.5-70t57.5-43v-87q0-50 35-85t85-35h160v-127q-35-12-57.5-43T360-760q0-50 35-85t85-35q50 0 85 35t35 85q0 39-22.5 70T520-647v127h160q50 0 85 35t35 85v87q35 12 57.5 43t22.5 70q0 50-35 85t-85 35q-50 0-85-35t-35-85q0-39 22.5-70t57.5-43v-87q0-17-11.5-28.5T680-440H520v127q35 12 57.5 43t22.5 70q0 50-35 85t-85 35q-50 0-85-35t-35-85q0-39 22.5-70t57.5-43v-127H280q-17 0-28.5 11.5T240-400v87q35 12 57.5 43t22.5 70q0 50-35 85t-85 35Zm0-80q17 0 28.5-11.5T240-200q0-17-11.5-28.5T200-240q-17 0-28.5 11.5T160-200q0 17 11.5 28.5T200-160Zm280 0q17 0 28.5-11.5T520-200q0-17-11.5-28.5T480-240q-17 0-28.5 11.5T440-200q0 17 11.5 28.5T480-160Zm280 0q17 0 28.5-11.5T800-200q0-17-11.5-28.5T760-240q-17 0-28.5 11.5T720-200q0 17 11.5 28.5T760-160ZM480-720q17 0 28.5-11.5T520-760q0-17-11.5-28.5T480-800q-17 0-28.5 11.5T440-760q0 17 11.5 28.5T480-720Z"/></svg>'},{key:"assets",name:"Assets",icon:'<svg class="w-6 h-6" xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="currentColor"><path d="M200-120q-33 0-56.5-23.5T120-200v-560q0-33 23.5-56.5T200-840h560q33 0 56.5 23.5T840-760v560q0 33-23.5 56.5T760-120H200Zm0-80h560v-560H200v560Zm40-80h480L570-480 450-320l-90-120-120 160Zm-40 80v-560 560Zm140-360q25 0 42.5-17.5T400-620q0-25-17.5-42.5T340-680q-25 0-42.5 17.5T280-620q0 25 17.5 42.5T340-560Z"/></svg>'},{key:"inspector",name:"Inspector",icon:'<svg class="w-6 h-6" xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="currentColor"><path d="M480-320q17 0 28.5-11.5T520-360q0-17-11.5-28.5T480-400q-17 0-28.5 11.5T440-360q0 17 11.5 28.5T480-320Zm-40-160h80v-200h-80v200Zm40 400q-139-35-229.5-159.5T160-516v-244l320-120 320 120v244q0 152-90.5 276.5T480-80Zm0-84q104-33 172-132t68-220v-189l-240-90-240 90v189q0 121 68 220t172 132Zm0-316Z"/></svg>'},{key:"animations",name:"Animations",icon:'<svg class="w-6 h-6" xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="currentColor"><path d="m438-592 40-116h4l40 116h-84Zm42 232q-100 0-170-70t-70-170q0-100 70-170t170-70q100 0 170 70t70 170q0 100-70 170t-170 70ZM350-480h48l26-72h112l26 72h48L504-760h-50L350-480ZM120-80v-200h80v200h-80Zm160 0v-200h80v200h-80Zm160 0v-200h80v200h-80Zm160 0v-200h240v200H600Z"/></svg>'}],M=[{name:"Profile",icon:'<svg class="w-6 h-6" xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="currentColor"><path d="M234-276q51-39 114-61.5T480-360q69 0 132 22.5T726-276q35-41 54.5-93T800-480q0-133-93.5-226.5T480-800q-133 0-226.5 93.5T160-480q0 59 19.5 111t54.5 93Zm246-164q-59 0-99.5-40.5T340-580q0-59 40.5-99.5T480-720q59 0 99.5 40.5T620-580q0 59-40.5 99.5T480-440Zm0 360q-83 0-156-31.5T197-197q-54-54-85.5-127T80-480q0-83 31.5-156T197-763q54-54 127-85.5T480-880q83 0 156 31.5T763-763q54 54 85.5 127T880-480q0 83-31.5 156T763-197q-54 54-127 85.5T480-80Zm0-80q53 0 100-15.5t86-44.5q-39-29-86-44.5T480-280q-53 0-100 15.5T294-220q39 29 86 44.5T480-160Zm0-360q26 0 43-17t17-43q0-26-17-43t-43-17q-26 0-43 17t-17 43q0 26 17 43t43 17Zm0-60Zm0 360Z"/></svg>',children:[{name:"Billing",href:"/account/billing"},{name:"API Keys",href:"/account/api-keys"},{name:"Integrations",href:"/account/integrations"}]},{name:"Settings",icon:'<svg class="w-6 h-6" xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="currentColor"><path d="m370-80-16-128q-13-5-24.5-12T307-235l-119 50L78-375l103-78q-1-7-1-13.5v-27q0-6.5 1-13.5L78-585l110-190 119 50q11-8 23-15t24-12l16-128h220l16 128q13 5 24.5 12t22.5 15l119-50 110 190-103 78q1 7 1 13.5v27q0 6.5-2 13.5l103 78-110 190-118-50q-11 8-23 15t-24 12L590-80H370Zm70-80h79l14-106q31-8 57.5-23.5T639-327l99 41 39-68-86-65q5-14 7-29.5t2-31.5q0-16-2-31.5t-7-29.5l86-65-39-68-99 42q-22-23-48.5-38.5T533-694l-13-106h-79l-14 106q-31 8-57.5 23.5T321-633l-99-41-39 68 86 64q-5 15-7 30t-2 32q0 16 2 31t7 30l-86 65 39 68 99-42q22 23 48.5 38.5T427-266l13 106Zm42-180q58 0 99-41t41-99q0-58-41-99t-99-41q-59 0-99.5 41T342-480q0 58 40.5 99t99.5 41Zm-2-140Z"/></svg>',children:[{name:"General",href:"/settings/general"},{name:"Security",href:"/settings/security"},{name:"Notifications",href:"/settings/notifications"}]}];var T=_l(),S=s(T);Ke(S,5,()=>o,tt,(q,k)=>{var V=hl(),G=s(V),C=s(G),R=s(C);sa(R,()=>e(k).icon,!0),i(C),i(G),ca(G,(de,L)=>{var j;return(j=da)==null?void 0:j(de,L)},()=>({content:e(k).name,placement:"auto"})),Ur(()=>B("click",G,()=>d(n()===e(k).key?null:e(k).key))),i(V),E(de=>{rt(G,1,`cursor-pointer p-1 rounded ${n()===e(k).key?"bg-slate-300 dark:bg-slate-600":""}`),rt(C,0,`${de??""} text-gray-800 dark:text-white`)},[()=>e(k).name.toLowerCase()=="animations"?"w-8 h-8":"w-6 h-6"]),u(q,V)}),i(S);var _=v(S,2);Ke(_,5,()=>M,tt,(q,k)=>{var V=bl(),G=s(V),C=s(G);sa(C,()=>e(k).icon,!0),i(G),ca(G,(R,de)=>{var L;return(L=da)==null?void 0:L(R,de)},()=>({content:e(k).name,placement:"auto"})),i(V),u(q,V)}),i(_),i(T),u(r,T),a()}function Ka(r,t,a,n,l,d){if(e(t)==="workspace")return a();if(e(t)==="module"&&e(n))return l(e(n));if(e(t)==="lesson"&&e(n))return d(e(n))}function Ua(r,t,a){if(e(t)){if(e(a)==="module")return pa(e(t));if(e(a)==="lesson")return va(e(t));if(e(a)==="page")return ua(e(t))}}function Ja(r,t,a){r.key==="Enter"?t():r.key==="Escape"&&a()}var xl=(r,t)=>t("workspace"),yl=(r,t)=>t(r,"workspace"),kl=(r,t)=>t(),Il=(r,t,a,n)=>t()?ua(t()):a()?va(a()):n()?pa(n()):null,Cl=(r,t)=>t(),Tl=(r,t)=>t(),Sl=(r,t,a)=>t(r,"module",e(a).id),Al=(r,t,a)=>t(`m:${e(a).id}`),Bl=f('<input class="px-1 rounded border border-slate-400/40 dark:border-slate-600/60 bg-white dark:bg-slate-700 text-sm w-full"/>'),Ml=(r,t,a)=>t("module",e(a).id,e(a).metadata.title),Zl=f('<span class="text-gray-800 dark:text-gray-200" role="button" tabindex="0"> </span>'),Ll=(r,t,a)=>t(e(a).id),$l=(r,t,a)=>t(r,"lesson",e(a).id),Nl=(r,t,a)=>t(`l:${e(a).id}`),Wl=f('<input class="px-1 rounded border border-slate-400/40 dark:border-slate-600/60 bg-white dark:bg-slate-700 text-sm w-full"/>'),ql=(r,t,a)=>t("lesson",e(a).id,e(a).metadata.title),Hl=f('<span class="text-gray-700 dark:text-gray-300" role="button" tabindex="0"> </span>'),Pl=(r,t,a)=>t(e(a).id),El=(r,t,a)=>t(r,"page",e(a).id),Vl=(r,t,a)=>{e(t)!=="page"&&Qr(e(a).id)},Rl=f('<input class="px-1 rounded border border-slate-400/40 dark:border-slate-600/60 bg-white dark:bg-slate-700 text-sm w-full"/>'),Dl=(r,t,a)=>t("page",e(a).id,e(a).metadata.title),zl=f('<span class="flex items-center gap-1 text-gray-600 dark:text-gray-300" role="button" tabindex="0"><svg class="w-6 h-6 text-gray-800 dark:text-white" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 3v4a1 1 0 0 1-1 1H5m8-2h3m-3 3h3m-4 3v6m4-3H8M19 4v16a1 1 0 0 1-1 1H6a1 1 0 0 1-1-1V7.914a1 1 0 0 1 .293-.707l3.914-3.914A1 1 0 0 1 9.914 3H18a1 1 0 0 1 1 1ZM8 12v6h8v-6H8Z"></path></svg> </span>'),Fl=f('<button draggable="true"><!></button>'),Gl=f('<div class="ml-4"></div>'),jl=f('<div class="ml-4"><div class="row flex items-center justify-between px-2 svelte-1ktad3d" role="button" tabindex="0" aria-haspopup="menu" draggable="true"><button class="flex items-center gap-2 grow text-left"><svg viewBox="0 0 24 24" fill="none"><path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m9 5 7 7-7 7"></path></svg> <svg class="w-6 h-6 text-gray-800 dark:text-white" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 20H5a1 1 0 0 1-1-1V6a1 1 0 0 1 1-1h2.429M7 8h3M8 8V4h4v2m4 0V5h-4m3 4v3a1 1 0 0 1-1 1h-3m9-3v9a1 1 0 0 1-1 1h-7a1 1 0 0 1-1-1v-6.397a1 1 0 0 1 .27-.683l2.434-2.603a1 1 0 0 1 .73-.317H19a1 1 0 0 1 1 1Z"></path></svg> <!> <span class="badge svelte-1ktad3d" title="Pages"> </span></button> <div class="invisible group-hover:visible flex items-center gap-1 pr-2"><button aria-label="New Page" title="New Page"><svg class="icon svelte-1ktad3d" viewBox="0 0 24 24" fill="none"><path stroke="currentColor" stroke-width="2" d="M12 5v14M5 12h14"></path></svg></button></div></div> <!></div>'),Ol=f('<div class="group"><div class="row flex items-center justify-between px-2 svelte-1ktad3d" role="button" tabindex="0" aria-haspopup="menu" draggable="true"><button class="flex items-center gap-2 grow text-left"><svg viewBox="0 0 24 24" fill="none"><path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m9 5 7 7-7 7"></path></svg> <svg class="w-6 h-6 text-gray-800 dark:text-white" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 24 24"><path fill-rule="evenodd" d="M3 6a2 2 0 0 1 2-2h5.532a2 2 0 0 1 1.536.72l1.9 2.28H3V6Zm0 3v10a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V9H3Z" clip-rule="evenodd"></path></svg> <!> <span class="badge svelte-1ktad3d" title="Lessons"> </span></button> <div class="invisible group-hover:visible flex items-center gap-1 pr-2"><button aria-label="New Lesson" title="New Lesson"><svg class="icon svelte-1ktad3d" viewBox="0 0 24 24" fill="none"><path stroke="currentColor" stroke-width="2" d="M12 5v14M5 12h14"></path></svg></button></div></div> <!></div>'),Yl=f('<div id="sec-workspace" class="pb-2"></div>'),Kl=(r,t)=>t("outline"),Ul=(r,t)=>{const a=r.target;a&&a.closest&&a.closest('button[aria-label="Toggle collection"]')||(e(t).visible===!1?$a(e(t).id):Na(e(t).id,r.metaKey||r.ctrlKey))},Jl=(r,t)=>{if(r.key==="Enter"||r.key===" "){const a=r.target;if(a&&a.closest&&a.closest('button[aria-label="Toggle collection"]'))return;r.preventDefault(),e(t).visible===!1?$a(e(t).id):Na(e(t).id,r.ctrlKey||r.metaKey)}},Xl=(r,t,a)=>t(`e:${e(a).id}`),Ql=f('<button class="flex items-center gap-1" aria-label="Toggle collection"><svg viewBox="0 0 24 24" fill="none"><path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m9 5 7 7-7 7"></path></svg></button>'),es=f('<span class="w-4 h-4"></span>'),ts=qt('<svg class="w-3 h-3 text-amber-500" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="11" width="18" height="11" rx="2"></rect><path d="M7 11V7a5 5 0 0 1 10 0v4"></path></svg>'),as=qt('<svg class="w-3 h-3 text-sky-500" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z"></path><circle cx="12" cy="12" r="3"></circle></svg>'),rs=(r,t,a,n)=>{e(t).allowed&&(r.stopPropagation(),r.preventDefault(),a(e(n).id))},ns=(r,t)=>{e(t).visible===!1?$a(e(t).id):Na(e(t).id,r.metaKey||r.ctrlKey)},os=(r,t)=>{(r.key==="Enter"||r.key===" ")&&(r.preventDefault(),e(t).visible===!1?$a(e(t).id):Na(e(t).id,r.ctrlKey||r.metaKey))},is=qt('<svg class="w-3 h-3 text-amber-500" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="11" width="18" height="11" rx="2"></rect><path d="M7 11V7a5 5 0 0 1 10 0v4"></path></svg>'),ls=qt('<svg class="w-3 h-3 text-sky-500" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z"></path><circle cx="12" cy="12" r="3"></circle></svg>'),ss=(r,t,a,n)=>{e(t).allowed&&(r.stopPropagation(),r.preventDefault(),a(e(n).id))},cs=f('<div role="button" tabindex="0"><span class="w-4 h-4"></span> <span class="text-gray-700 dark:text-gray-300 truncate flex items-center gap-1"> <!> <!></span> <div class="ml-auto flex items-center gap-1"><button type="button" class="outline-action svelte-1ktad3d" aria-label="Insert element id into script"><svg class="w-3.5 h-3.5 text-gray-500" viewBox="0 0 20 20" fill="none" aria-hidden="true"><path d="M7.5 4.5H6A1.5 1.5 0 0 0 4.5 6v8A1.5 1.5 0 0 0 6 15.5h2m3-11h2A1.5 1.5 0 0 1 15.5 6v8A1.5 1.5 0 0 1 14 15.5h-1.5m-5-5H13" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path><path d="M9 10 7.5 8.5 9 7" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path></svg></button> <span class="text-[11px] text-gray-400 flex items-center gap-1"> </span></div></div>'),ds=f('<div class="ml-6"></div>'),us=f('<div role="button" tabindex="0"><!> <span class="text-gray-700 dark:text-gray-300 truncate flex items-center gap-1"> <!> <!></span> <div class="ml-auto flex items-center gap-1"><button type="button" class="outline-action svelte-1ktad3d" aria-label="Insert element id into script"><svg class="w-3.5 h-3.5 text-gray-500" viewBox="0 0 20 20" fill="none" aria-hidden="true"><path d="M7.5 4.5H6A1.5 1.5 0 0 0 4.5 6v8A1.5 1.5 0 0 0 6 15.5h2m3-11h2A1.5 1.5 0 0 1 15.5 6v8A1.5 1.5 0 0 1 14 15.5h-1.5m-5-5H13" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path><path d="M9 10 7.5 8.5 9 7" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path></svg></button> <span class="text-[11px] text-gray-400 flex items-center gap-1"> </span></div></div> <!>',1),vs=f('<div class="pl-2"></div>'),ps=f('<div class="px-3 pb-3 text-gray-500 dark:text-gray-400">No elements on this page</div>'),fs=f('<div id="sec-outline" class="pb-2"><!></div>'),gs=f('<li class="svelte-1ktad3d"><button type="button" role="menuitem" class="w-full text-left">New Module</button></li> <li class="svelte-1ktad3d"><button type="button" role="menuitem" class="w-full text-left">Expand All</button></li> <li class="svelte-1ktad3d"><button type="button" role="menuitem" class="w-full text-left">Collapse All</button></li>',1),ms=(r,t,a,n)=>{if(e(t)){const l=a().modulesById[e(t)];l&&n("module",e(t),l.metadata.title)}},hs=f('<li class="svelte-1ktad3d"><button type="button" role="menuitem" class="w-full text-left">New Lesson</button></li> <li class="svelte-1ktad3d"><button type="button" role="menuitem" class="w-full text-left"> </button></li> <li class="svelte-1ktad3d"><button type="button" role="menuitem" class="w-full text-left">Delete Module</button></li>',1),bs=(r,t,a,n)=>{if(e(t)){const l=a().lessonsById[e(t)];l&&n("lesson",e(t),l.metadata.title)}},_s=f('<li class="svelte-1ktad3d"><button type="button" role="menuitem" class="w-full text-left">New Page</button></li> <li class="svelte-1ktad3d"><button type="button" role="menuitem" class="w-full text-left"> </button></li> <li class="svelte-1ktad3d"><button type="button" role="menuitem" class="w-full text-left">Delete Lesson</button></li>',1),ws=(r,t,a,n)=>{if(e(t)){const l=a().pagesById[e(t)];l&&n("page",e(t),l.metadata.title)}},xs=f('<li class="svelte-1ktad3d"><button type="button" role="menuitem" class="w-full text-left"> </button></li> <li class="svelte-1ktad3d"><button type="button" role="menuitem" class="w-full text-left">Delete Page</button></li>',1),ys=f('<ul class="ctx bg-white/95 dark:bg-slate-800/95 border border-black/10 dark:border-white/10 rounded shadow-lg svelte-1ktad3d" role="menu"><!></ul>'),ks=f('<div class="h-full text-sm select-none"><div class="border-b border-slate-300/30 dark:border-slate-600/40"><div class="w-full flex items-center justify-between px-2 py-2"><button type="button" class="flex items-center gap-2" aria-controls="sec-workspace"><svg viewBox="0 0 24 24" fill="none"><path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m9 5 7 7-7 7"></path></svg> <span class="uppercase tracking-wider text-[11px] text-gray-600 dark:text-gray-300">Workspace</span></button> <div class="toolbar flex items-center gap-1 svelte-1ktad3d"><button aria-label="New Module" title="New Module" class="svelte-1ktad3d"><svg class="icon svelte-1ktad3d" viewBox="0 0 24 24" fill="none"><path stroke="currentColor" stroke-width="2" d="M12 5v14M5 12h14"></path></svg></button> <button aria-label="Delete Selected" title="Delete Selected" class="svelte-1ktad3d"><svg class="icon svelte-1ktad3d" viewBox="0 0 24 24" fill="none"><path stroke="currentColor" stroke-width="2" d="M6 7h12M9 7V5h6v2m-8 2 1 11h8l1-11"></path></svg></button> <button aria-label="Collapse All" title="Collapse All" class="svelte-1ktad3d"><svg class="icon svelte-1ktad3d" viewBox="0 0 24 24" fill="none"><path stroke="currentColor" stroke-width="2" d="M8 9h8M8 15h8"></path></svg></button> <button aria-label="Expand All" title="Expand All" class="svelte-1ktad3d"><svg class="icon svelte-1ktad3d" viewBox="0 0 24 24" fill="none"><path stroke="currentColor" stroke-width="2" d="M6 12h12M12 6v12"></path></svg></button> <button aria-label="More options" title="More" class="svelte-1ktad3d"><svg class="icon svelte-1ktad3d" viewBox="0 0 24 24" fill="none"><circle cx="6" cy="12" r="1.5" fill="currentColor"></circle><circle cx="12" cy="12" r="1.5" fill="currentColor"></circle><circle cx="18" cy="12" r="1.5" fill="currentColor"></circle></svg></button></div></div> <!></div> <div class="border-b border-slate-300/30 dark:border-slate-600/40"><div class="w-full flex items-center justify-between px-2 py-2"><button type="button" class="flex items-center gap-2" aria-controls="sec-outline"><svg viewBox="0 0 24 24" fill="none"><path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m9 5 7 7-7 7"></path></svg> <span class="uppercase tracking-wider text-[11px] text-gray-600 dark:text-gray-300">Outline</span></button></div> <!></div> <!></div>');function Is(r,t){Ct(t,!1);const[a,n]=Kt(),l=()=>ut(aa,"$projectData",a),d=()=>ut(pr,"$selectedScript",a),o=()=>ut(Nt,"$currentPageId",a),M=()=>ut(tr,"$currentLessonId",a),T=()=>ut(ar,"$currentModuleId",a),S=()=>ut(Kn,"$selectedElementIds",a),_=Ie(),q=Ie();let k=Ie({});const V="structure:expanded";function G(){try{localStorage.setItem(V,JSON.stringify(e(k)))}catch{}}function C(Y){const Q=e(k)[Y]??!0;g(k,{...e(k),[Y]:!Q}),G()}function R(){const Y=l(),Q={workspace:!0,outline:e(k).outline??!0};for(const ee of Y.course.modules)Q[`m:${ee.id}`]=!0;for(const ee of Object.values(Y.lessonsById))Q[`l:${ee.id}`]=!0;g(k,Q),G()}function de(){g(k,{workspace:!0,outline:e(k).outline??!0}),G()}async function L(Y){var Ne,Ze,xe;const Q=o()??null,ee=Ai(`'${Y}'`,{pageId:Q});if(!ee.ok){ee.reason==="no-script"?Lt.append("warn","Select a script to insert element IDs",{source:"outline"}):ee.reason==="scope-mismatch"&&Lt.append("warn","Current script is scoped to a different page",{source:"outline",script:(Ne=d())==null?void 0:Ne.name});return}try{(Ze=navigator==null?void 0:navigator.clipboard)!=null&&Ze.writeText&&await navigator.clipboard.writeText(Y)}catch{}Lt.append("info",`Inserted element id ${Y} into ${((xe=d())==null?void 0:xe.name)??"script"}`,{source:"outline"})}let j=Ie(!1),_e=Ie(0),Fe=Ie(0),Be=Ie(null),re=Ie(null);function W(Y,Q,ee=null){Y.preventDefault(),g(j,!0),g(Be,Q),g(re,ee),g(_e,Y.clientX),g(Fe,Y.clientY),window.addEventListener("click",p,{once:!0})}function p(){g(j,!1),g(Be,null),g(re,null)}let A=Ie(null),D=Ie(null),le=Ie(""),N=!1,fe=Ie(null);function ie(Y,Q,ee,Ne=!1){g(A,Y),g(D,Q),g(le,ee),N=Ne,Ln().then(()=>{e(fe)&&(e(fe).focus(),e(fe).select())})}function I(){if(!e(A)||!e(D))return;const Y=e(le).trim();if(!Y){N&&(e(A)==="module"?pa(e(D)):e(A)==="lesson"?va(e(D)):e(A)==="page"&&ua(e(D))),g(A,null),g(D,null),g(le,""),N=!1;return}let Q="";e(A)==="module"?Q=l().modulesById[e(D)].metadata.title:e(A)==="lesson"?Q=l().lessonsById[e(D)].metadata.title:e(A)==="page"&&(Q=l().pagesById[e(D)].metadata.title),Y!==Q&&(e(A)==="module"?Fn(e(D),Y):e(A)==="lesson"?Gn(e(D),Y):e(A)==="page"&&jn(e(D),Y)),g(A,null),g(D,null),g(le,""),N=!1}function h(){e(A)&&(N&&e(D)&&(e(A)==="module"?pa(e(D)):e(A)==="lesson"?va(e(D)):e(A)==="page"&&ua(e(D))),g(A,null),g(D,null),g(le,""),N=!1)}function H(){N&&e(D)&&e(le).trim()===""&&e(A)&&(e(A)==="module"?pa(e(D)):e(A)==="lesson"?va(e(D)):e(A)==="page"&&ua(e(D)),g(A,null),g(D,null),g(le,""),N=!1)}function se(Y){let Q=!1;for(const ee of Y)e(k)[ee]===!1&&(Q=!0),e(k)[ee]!==!0&&Dt(k,e(k)[ee]=!0);Q&&(g(k,{...e(k)}),G())}function me(Y){const Q=l();for(const ee of Q.course.modules){const Ne=Q.modulesById[ee.id];if(Ne.lessons.some(Ze=>Ze.id===Y))return Ne.id}return null}function ce(){H(),se(["workspace"]);const Y=Vn();se([`m:${Y}`]),ie("module",Y,"",!0)}function ne(Y){H(),se(["workspace",`m:${Y}`]);const Q=zn(Y);Q&&(se([`l:${Q}`]),ie("lesson",Q,"",!0))}function ue(Y){H();const Q=me(Y),ee=["workspace"];Q&&ee.push(`m:${Q}`),ee.push(`l:${Y}`),se(ee);const Ne=On(Y);Ne&&(Qr(Ne),ie("page",Ne,"",!0))}function oe(Y){if(Y.key==="F2"){if(o()){const Q=l().pagesById[o()];Q&&ie("page",Q.id,Q.metadata.title,!1)}else if(M()){const Q=l().lessonsById[M()];Q&&ie("lesson",Q.id,Q.metadata.title,!1)}else if(T()){const Q=l().modulesById[T()];Q&&ie("module",Q.id,Q.metadata.title,!1)}}}ga(()=>{window.addEventListener("keydown",oe);try{const Y=localStorage.getItem(V),Q=Y?JSON.parse(Y):{},ee=l(),Ne={workspace:Q.workspace??!0,outline:Q.outline??!0};for(const Ze of ee.course.modules)Ne[`m:${Ze.id}`]=Q[`m:${Ze.id}`]??!0;for(const Ze of Object.values(ee.lessonsById))Ne[`l:${Ze.id}`]=Q[`l:${Ze.id}`]??!0;g(k,Ne)}catch{const Y=l(),Q={workspace:!0,outline:!0};for(const ee of Y.course.modules)Q[`m:${ee.id}`]=!0;for(const ee of Object.values(Y.lessonsById))Q[`l:${ee.id}`]=!0;g(k,Q)}}),or(()=>{window.removeEventListener("keydown",oe)}),wt(()=>(d(),o()),()=>{g(_,(()=>{const Y=d();if(!Y)return{allowed:!1,reason:"Select a script to insert element IDs"};if(Y.scope==="page"){const Q=o()??null;if(!Q||Y.pageId!==Q)return{allowed:!1,reason:"Selected script is scoped to a different page"}}return{allowed:!0,reason:""}})())}),wt(()=>e(_),()=>{g(q,e(_).allowed?"Insert element id into script":e(_).reason)}),ea(),Bt();var Ge=ks(),je=s(Ge),Re=s(je),ve=s(Re);ve.__click=[xl,C],ve.__contextmenu=[yl,W];var Me=s(ve);Pt(2),i(ve);var U=v(ve,2),ge=s(U);ge.__click=[kl,ce];var he=v(ge,2);he.__click=[Il,o,M,T];var we=v(he,2);we.__click=[Cl,de];var te=v(we,2);te.__click=[Tl,R],Pt(2),i(U),i(Re);var J=v(Re,2);{var O=Y=>{var Q=Yl();Ke(Q,5,()=>(l(),c(()=>l().course.modules)),ee=>ee.id,(ee,Ne)=>{var Ze=Ol();const xe=yt(()=>(l(),e(Ne),c(()=>l().modulesById[e(Ne).id])));var De=s(Ze);De.__contextmenu=[Sl,W,xe];var Ee=s(De);Ee.__click=[Al,C,xe];var Te=s(Ee),et=v(Te,4);{var We=w=>{var x=Bl();pt(x),x.__keydown=[Ja,I,h],Gt(x,z=>g(fe,z),()=>e(fe)),B("blur",x,I),At(x,()=>e(le),z=>g(le,z)),u(w,x)},Se=w=>{var x=Zl();x.__dblclick=[Ml,ie,xe];var z=s(x,!0);i(x),E(()=>Ae(z,(m(e(xe)),c(()=>e(xe).metadata.title)))),u(w,x)};$(et,w=>{e(A),e(D),m(e(xe)),c(()=>e(A)==="module"&&e(D)===e(xe).id)?w(We):w(Se,!1)})}var Ye=v(et,2),Ue=s(Ye,!0);i(Ye),i(Ee);var F=v(Ee,2),K=s(F);K.__click=[Ll,ne,xe],i(F),i(De);var qe=v(De,2);{var b=w=>{var x=$e(),z=be(x);Ke(z,1,()=>(m(e(xe)),c(()=>e(xe).lessons)),Ce=>Ce.id,(Ce,Ve)=>{var Oe=jl();const Le=yt(()=>(l(),e(Ve),c(()=>l().lessonsById[e(Ve).id])));var nt=s(Oe);nt.__contextmenu=[$l,W,Le];var ze=s(nt);ze.__click=[Nl,C,Le];var ot=s(ze),bt=v(ot,4);{var _t=at=>{var st=Wl();pt(st),st.__keydown=[Ja,I,h],Gt(st,vt=>g(fe,vt),()=>e(fe)),B("blur",st,I),At(st,()=>e(le),vt=>g(le,vt)),u(at,st)},Mt=at=>{var st=Hl();st.__dblclick=[ql,ie,Le];var vt=s(st,!0);i(st),E(()=>Ae(vt,(m(e(Le)),c(()=>e(Le).metadata.title)))),u(at,st)};$(bt,at=>{e(A),e(D),m(e(Le)),c(()=>e(A)==="lesson"&&e(D)===e(Le).id)?at(_t):at(Mt,!1)})}var $t=v(bt,2),Ht=s($t,!0);i($t),i(ze);var it=v(ze,2),Qe=s(it);Qe.__click=[Pl,ue,Le],i(it),i(nt);var lt=v(nt,2);{var St=at=>{var st=Gl();Ke(st,5,()=>(m(e(Le)),c(()=>e(Le).pages)),vt=>vt.id,(vt,gt)=>{var dt=Fl();const ft=yt(()=>(l(),e(gt),c(()=>l().pagesById[e(gt).id])));dt.__contextmenu=[El,W,ft],dt.__click=[Vl,A,ft];var na=s(dt);{var Sa=ct=>{var xt=Rl();pt(xt),xt.__keydown=[Ja,I,h],Gt(xt,Vt=>g(fe,Vt),()=>e(fe)),B("blur",xt,I),At(xt,()=>e(le),Vt=>g(le,Vt)),u(ct,xt)},Wa=ct=>{var xt=zl();xt.__dblclick=[Dl,ie,ft];var Vt=v(s(xt));i(xt),E(()=>Ae(Vt,` ${m(e(ft)),c(()=>e(ft).metadata.title)??""}`)),u(ct,xt)};$(na,ct=>{e(A),e(D),m(e(ft)),c(()=>e(A)==="page"&&e(D)===e(ft).id)?ct(Sa):ct(Wa,!1)})}i(dt),E(()=>rt(dt,1,`row w-full text-left px-2 ${o(),m(e(ft)),c(()=>o()===e(ft).id?"active":"")??""}`,"svelte-1ktad3d")),B("dragstart",dt,ct=>{ct.dataTransfer&&(ct.dataTransfer.setData("text/plain",JSON.stringify({kind:"page",id:e(ft).id,lessonId:e(Le).id})),ct.dataTransfer.effectAllowed="move",ct.dataTransfer.setDragImage(new Image,0,0))}),B("dragover",dt,ct=>{ct.preventDefault();const xt=ct.currentTarget.getBoundingClientRect(),Vt=ct.clientY-xt.top<xt.height/2;ct.currentTarget.classList.toggle("drag-over-before",Vt),ct.currentTarget.classList.toggle("drag-over-after",!Vt)}),B("dragleave",dt,ct=>{ct.currentTarget.classList.remove("drag-over-before","drag-over-after")}),B("drop",dt,ct=>{var xt;ct.currentTarget.classList.remove("drag-over-before","drag-over-after");try{const Vt=(xt=ct.dataTransfer)==null?void 0:xt.getData("text/plain");if(!Vt)return;const ha=JSON.parse(Vt),hr=ct.currentTarget.getBoundingClientRect(),br=ct.clientY-hr.top<hr.height/2;ha.kind==="page"&&ha.id!==e(ft).id&&(ha.lessonId===e(Le).id?Yn(e(Le).id,ha.id,e(ft).id,br):Br(ha.id,e(Le).id,e(ft).id,br))}catch{}}),u(vt,dt)}),i(st),u(at,st)};$(lt,at=>{e(k),m(e(Le)),c(()=>e(k)[`l:${e(Le).id}`])&&at(St)})}i(Oe),E(()=>{ye(ze,"aria-expanded",(e(k),m(e(Le)),c(()=>e(k)[`l:${e(Le).id}`]??!0))),rt(ot,0,`w-4 h-4 chev ${e(k),m(e(Le)),c(()=>e(k)[`l:${e(Le).id}`]?"rot":"")??""}`,"svelte-1ktad3d"),Ae(Ht,(m(e(Le)),c(()=>e(Le).pages.length)))}),B("dragstart",nt,at=>{at.dataTransfer&&(at.dataTransfer.setData("text/plain",JSON.stringify({kind:"lesson",id:e(Le).id,moduleId:e(xe).id})),at.dataTransfer.effectAllowed="move",at.dataTransfer.setDragImage(new Image,0,0))}),B("dragover",nt,at=>{var gt;at.preventDefault();try{const dt=(gt=at.dataTransfer)==null?void 0:gt.getData("text/plain");if(dt&&JSON.parse(dt).kind==="page"){at.currentTarget.classList.add("drag-over-after");return}}catch{}const st=at.currentTarget.getBoundingClientRect(),vt=at.clientY-st.top<st.height/2;at.currentTarget.classList.toggle("drag-over-before",vt),at.currentTarget.classList.toggle("drag-over-after",!vt)}),B("dragleave",nt,at=>{at.currentTarget.classList.remove("drag-over-before","drag-over-after")}),B("drop",nt,at=>{var st;at.currentTarget.classList.remove("drag-over-before","drag-over-after");try{const vt=(st=at.dataTransfer)==null?void 0:st.getData("text/plain");if(!vt)return;const gt=JSON.parse(vt),dt=at.currentTarget.getBoundingClientRect(),ft=at.clientY-dt.top<dt.height/2;gt.kind==="lesson"&&gt.id!==e(Le).id?gt.moduleId===e(xe).id?Dn(e(xe).id,gt.id,e(Le).id,ft):Ar(gt.id,e(xe).id,e(Le).id,ft):gt.kind==="page"&&gt.lessonId!==e(Le).id&&Br(gt.id,e(Le).id,null,!1)}catch{}}),u(Ce,Oe)}),u(w,x)};$(qe,w=>{e(k),m(e(xe)),c(()=>e(k)[`m:${e(xe).id}`])&&w(b)})}i(Ze),E(()=>{ye(Ee,"aria-expanded",(e(k),m(e(xe)),c(()=>e(k)[`m:${e(xe).id}`]??!0))),rt(Te,0,`w-4 h-4 chev ${e(k),m(e(xe)),c(()=>e(k)[`m:${e(xe).id}`]?"rot":"")??""}`,"svelte-1ktad3d"),Ae(Ue,(m(e(xe)),c(()=>e(xe).lessons.length)))}),B("dragstart",De,w=>{var x,z;(x=w.dataTransfer)==null||x.setData("text/plain",JSON.stringify({kind:"module",id:e(xe).id})),(z=w.dataTransfer)==null||z.setDragImage(new Image,0,0)}),B("dragover",De,w=>{var Ce;w.preventDefault();try{const Ve=(Ce=w.dataTransfer)==null?void 0:Ce.getData("text/plain");if(Ve&&JSON.parse(Ve).kind==="lesson"){w.currentTarget.classList.add("drag-over-after");return}}catch{}const x=w.currentTarget.getBoundingClientRect(),z=w.clientY-x.top<x.height/2;w.currentTarget.classList.toggle("drag-over-before",z),w.currentTarget.classList.toggle("drag-over-after",!z)}),B("dragleave",De,w=>{w.currentTarget.classList.remove("drag-over-before","drag-over-after")}),B("drop",De,w=>{var x;w.currentTarget.classList.remove("drag-over-before","drag-over-after");try{const z=(x=w.dataTransfer)==null?void 0:x.getData("text/plain");if(!z)return;const Ce=JSON.parse(z);if(Ce.kind==="module"&&Ce.id!==e(xe).id){const Ve=w.currentTarget.getBoundingClientRect(),Oe=w.clientY-Ve.top<Ve.height/2;Rn(Ce.id,e(xe).id,Oe)}else Ce.kind==="lesson"&&Ce.moduleId!==e(xe).id&&Ar(Ce.id,e(xe).id,null,!1)}catch{}}),u(ee,Ze)}),i(Q),u(Y,Q)};$(J,Y=>{e(k),c(()=>e(k).workspace)&&Y(O)})}i(je);var y=v(je,2),Z=s(y),P=s(Z);P.__click=[Kl,C];var ke=s(P);Pt(2),i(P),i(Z);var pe=v(Z,2);{var X=Y=>{var Q=fs(),ee=s(Q);{var Ne=xe=>{var De=vs();Ke(De,5,()=>(l(),o(),c(()=>l().pagesById[o()].elements)),Ee=>Ee.id,(Ee,Te)=>{var et=us(),We=be(et);We.__click=[Ul,Te],We.__keydown=[Jl,Te];var Se=s(We);{var Ye=ze=>{var ot=Ql();ot.__click=[Xl,C,Te];var bt=s(ot);i(ot),E(()=>rt(bt,0,`w-4 h-4 chev ${e(k),e(Te),c(()=>e(k)[`e:${e(Te).id}`]?"rot":"")??""}`,"svelte-1ktad3d")),u(ze,ot)},Ue=ze=>{var ot=es();u(ze,ot)};$(Se,ze=>{e(Te),c(()=>e(Te).type==="collection"&&e(Te).memberIds&&e(Te).memberIds.length)?ze(Ye):ze(Ue,!1)})}var F=v(Se,2),K=s(F),qe=v(K);{var b=ze=>{var ot=ts();u(ze,ot)};$(qe,ze=>{e(Te),c(()=>e(Te).locked)&&ze(b)})}var w=v(qe,2);{var x=ze=>{var ot=as();u(ze,ot)};$(w,ze=>{e(Te),c(()=>e(Te).visible===!1)&&ze(x)})}i(F);var z=v(F,2),Ce=s(z);Ce.__click=[rs,_,L,Te];var Ve=v(Ce,2),Oe=s(Ve,!0);i(Ve),i(z),i(We);var Le=v(We,2);{var nt=ze=>{var ot=ds();Ke(ot,5,()=>(e(Te),c(()=>e(Te).memberIds)),bt=>bt,(bt,_t)=>{var Mt=$e(),$t=be(Mt);{var Ht=it=>{var Qe=cs();const lt=yt(()=>(l(),o(),e(_t),c(()=>l().pagesById[o()].elements.find(ct=>ct.id===e(_t)))));Qe.__click=[ns,lt],Qe.__keydown=[os,lt];var St=v(s(Qe),2),at=s(St),st=v(at);{var vt=ct=>{var xt=is();u(ct,xt)};$(st,ct=>{m(e(lt)),c(()=>e(lt).locked)&&ct(vt)})}var gt=v(st,2);{var dt=ct=>{var xt=ls();u(ct,xt)};$(gt,ct=>{m(e(lt)),c(()=>e(lt).visible===!1)&&ct(dt)})}i(St);var ft=v(St,2),na=s(ft);na.__click=[ss,_,L,lt];var Sa=v(na,2),Wa=s(Sa,!0);i(Sa),i(ft),i(Qe),E(ct=>{rt(Qe,1,`row w-full flex items-center gap-2 px-2 ${ct??""}`,"svelte-1ktad3d"),ye(Qe,"title",(m(e(lt)),c(()=>e(lt).name||e(lt).type))),Ae(at,`${m(e(lt)),c(()=>e(lt).name||e(lt).type)??""} `),ye(na,"title",e(q)),na.disabled=(e(_),c(()=>!e(_).allowed)),Ae(Wa,(m(e(lt)),c(()=>e(lt).type)))},[()=>(S(),m(e(lt)),c(()=>S().has(e(lt).id)?"active":""))]),u(it,Qe)};$($t,it=>{l(),o(),e(_t),c(()=>l().pagesById[o()].elements.find(Qe=>Qe.id===e(_t)))&&it(Ht)})}u(bt,Mt)}),i(ot),u(ze,ot)};$(Le,ze=>{e(Te),e(k),c(()=>e(Te).type==="collection"&&e(Te).memberIds&&e(Te).memberIds.length&&e(k)[`e:${e(Te).id}`]!==!1)&&ze(nt)})}E(ze=>{rt(We,1,`row w-full flex items-center gap-2 px-2 ${ze??""}`,"svelte-1ktad3d"),ye(We,"title",(e(Te),c(()=>e(Te).name||e(Te).type))),Ae(K,`${e(Te),c(()=>e(Te).name||e(Te).type)??""} `),ye(Ce,"title",e(q)),Ce.disabled=(e(_),c(()=>!e(_).allowed)),Ae(Oe,(e(Te),c(()=>e(Te).type)))},[()=>(S(),e(Te),c(()=>S().has(e(Te).id)?"active":""))]),u(Ee,et)}),i(De),u(xe,De)},Ze=xe=>{var De=ps();u(xe,De)};$(ee,xe=>{l(),o(),c(()=>l().pagesById[o()]&&l().pagesById[o()].elements.length)?xe(Ne):xe(Ze,!1)})}i(Q),u(Y,Q)};$(pe,Y=>{e(k),c(()=>e(k).outline)&&Y(X)})}i(y);var ae=v(y,2);{var Pe=Y=>{var Q=ys(),ee=s(Q);{var Ne=xe=>{var De=gs(),Ee=be(De),Te=s(Ee);Te.__click=[Ka,Be,ce,re,ne,ue],i(Ee);var et=v(Ee,2),We=s(et);We.__click=R,i(et);var Se=v(et,2),Ye=s(Se);Ye.__click=de,i(Se),u(xe,De)},Ze=xe=>{var De=$e(),Ee=be(De);{var Te=We=>{var Se=hs(),Ye=be(Se),Ue=s(Ye);Ue.__click=[Ka,Be,ce,re,ne,ue],i(Ye);var F=v(Ye,2),K=s(F);K.__click=[ms,re,l,ie];var qe=s(K,!0);i(K),i(F);var b=v(F,2),w=s(b);w.__click=[Ua,re,Be],i(b),E(()=>Ae(qe,e(A)==="module"&&e(D)===e(re)?"Renaming…":"Rename")),u(We,Se)},et=We=>{var Se=$e(),Ye=be(Se);{var Ue=K=>{var qe=_s(),b=be(qe),w=s(b);w.__click=[Ka,Be,ce,re,ne,ue],i(b);var x=v(b,2),z=s(x);z.__click=[bs,re,l,ie];var Ce=s(z,!0);i(z),i(x);var Ve=v(x,2),Oe=s(Ve);Oe.__click=[Ua,re,Be],i(Ve),E(()=>Ae(Ce,e(A)==="lesson"&&e(D)===e(re)?"Renaming…":"Rename")),u(K,qe)},F=K=>{var qe=$e(),b=be(qe);{var w=x=>{var z=xs(),Ce=be(z),Ve=s(Ce);Ve.__click=[ws,re,l,ie];var Oe=s(Ve,!0);i(Ve),i(Ce);var Le=v(Ce,2),nt=s(Le);nt.__click=[Ua,re,Be],i(Le),E(()=>Ae(Oe,e(A)==="page"&&e(D)===e(re)?"Renaming…":"Rename")),u(x,z)};$(b,x=>{e(Be)==="page"&&x(w)},!0)}u(K,qe)};$(Ye,K=>{e(Be)==="lesson"?K(Ue):K(F,!1)},!0)}u(We,Se)};$(Ee,We=>{e(Be)==="module"?We(Te):We(et,!1)},!0)}u(xe,De)};$(ee,xe=>{e(Be)==="workspace"?xe(Ne):xe(Ze,!1)})}i(Q),E(()=>ht(Q,`left:${e(_e)}px; top:${e(Fe)}px`)),u(Y,Q)};$(ae,Y=>{e(j)&&Y(Pe)})}i(Ge),E(()=>{ye(ve,"aria-expanded",(e(k),c(()=>e(k).workspace??!0))),rt(Me,0,`w-4 h-4 text-gray-800 dark:text-white chev ${e(k),c(()=>e(k).workspace?"rot":"")??""}`,"svelte-1ktad3d"),ye(P,"aria-expanded",(e(k),c(()=>e(k).outline??!0))),rt(ke,0,`w-4 h-4 text-gray-800 dark:text-white chev ${e(k),c(()=>e(k).outline?"rot":"")??""}`,"svelte-1ktad3d")}),u(r,Ge),Tt(),n()}Ia(["click","contextmenu","keydown","dblclick"]);var Cs=f('<button type="button" class="border border-slate-300 dark:border-slate-600 rounded px-2 py-1 hover:bg-slate-100 dark:hover:bg-slate-700 text-left text-xs svelte-1p1nrj6"> </button>'),Ts=f('<div class="p-3 space-y-3 text-sm"><h3 class="font-semibold text-xs uppercase tracking-wide text-slate-500 dark:text-slate-300">Add Elements</h3> <div class="grid grid-cols-2 gap-2"></div> <p class="text-[11px] text-slate-500 dark:text-slate-400 leading-snug">Elements are placed with an automatic staggered layout near the origin. You can drag & resize immediately.</p></div>');function Ss(r,t){Ct(t,!1);const a=[{type:"rectangle",label:"Rectangle"},{type:"ellipse",label:"Circle"},{type:"line",label:"Line"},{type:"text",label:"Text"},{type:"image",label:"Image"},{type:"hotspot",label:"Hotspot"},{type:"collection",label:"Collection"}];function n(o){const M=Xe(Nt);M&&Un(o,M)}Bt();var l=Ts(),d=v(s(l),2);Ke(d,5,()=>a,tt,(o,M)=>{var T=Cs(),S=s(T,!0);i(T),E(()=>Ae(S,e(M).label)),B("click",T,()=>n(e(M).type)),u(o,T)}),i(d),Pt(2),i(l),u(r,l),Tt()}var As=f('<div class="p-4">Components panel</div>'),Bs=f('<div class="p-4">CF Map panel</div>'),Ms=f('<div class="p-4">Assets panel</div>'),Zs=f('<div class="p-4">Inspector panel</div>'),Ls=f('<div class="p-4">Animations panel</div>'),$s=f('<div class="p-4 text-sm text-gray-500 dark:text-gray-300">No panel selected</div>'),Ns=f('<section class="h-full w-full"><!></section>');function Ws(r){const[t,a]=Kt(),n=()=>ut(l,"$activeSideNav",t),{activeSideNav:l}=ma;var d=Ns(),o=s(d);{var M=S=>{Is(S,{})},T=S=>{var _=$e(),q=be(_);{var k=G=>{Ss(G,{})},V=G=>{var C=$e(),R=be(C);{var de=j=>{var _e=As();u(j,_e)},L=j=>{var _e=$e(),Fe=be(_e);{var Be=W=>{var p=Bs();u(W,p)},re=W=>{var p=$e(),A=be(p);{var D=N=>{var fe=Ms();u(N,fe)},le=N=>{var fe=$e(),ie=be(fe);{var I=H=>{var se=Zs();u(H,se)},h=H=>{var se=$e(),me=be(se);{var ce=ue=>{var oe=Ls();u(ue,oe)},ne=ue=>{var oe=$s();u(ue,oe)};$(me,ue=>{n()==="animations"?ue(ce):ue(ne,!1)},!0)}u(H,se)};$(ie,H=>{n()==="inspector"?H(I):H(h,!1)},!0)}u(N,fe)};$(A,N=>{n()==="assets"?N(D):N(le,!1)},!0)}u(W,p)};$(Fe,W=>{n()==="cf_map"?W(Be):W(re,!1)},!0)}u(j,_e)};$(R,j=>{n()==="components"?j(de):j(L,!1)},!0)}u(G,C)};$(q,G=>{n()==="elements"?G(k):G(V,!1)},!0)}u(S,_)};$(o,S=>{n()==="structure"?S(M):S(T,!1)})}i(d),u(r,d),a()}const Je={width:{name:"width",path:"size.dimensions.width",label:"W"},height:{name:"height",path:"size.dimensions.height",label:"H"},x:{name:"x",path:"position.x",label:"X"},y:{name:"y",path:"position.y",label:"Y"},rotation:{name:"rotation",path:"rotation",label:"R°"},fillColor:{name:"fillColor",path:"style.fillColor",label:"Fill"},strokeColor:{name:"strokeColor",path:"style.strokeColor",label:"Stroke"},strokeWidth:{name:"strokeWidth",path:"style.strokeWidth",label:"StrokeW"},shadowLevel:{name:"shadowLevel",path:"style.shadowLevel",label:"Shadow"},opacity:{name:"opacity",path:"opacity",label:"Opacity"},blur:{name:"blur",path:"style.blur",label:"Blur"},radiusTopLeft:{name:"radiusTopLeft",path:"style.borderRadius.dimensions.topLeft",label:"&#x25DC;"},radiusTopRight:{name:"radiusTopRight",path:"style.borderRadius.dimensions.topRight",label:"&#x25DD;"},radiusBottomRight:{name:"radiusBottomRight",path:"style.borderRadius.dimensions.bottomRight",label:"&#x25DF;"},radiusBottomLeft:{name:"radiusBottomLeft",path:"style.borderRadius.dimensions.bottomLeft",label:"&#x25DE;"},padTop:{name:"padTop",path:"style.padding.top",label:"Pt"},padRight:{name:"padRight",path:"style.padding.right",label:"Pr"},padBottom:{name:"padBottom",path:"style.padding.bottom",label:"Pb"},padLeft:{name:"padLeft",path:"style.padding.left",label:"Pl"},fontFamily:{name:"fontFamily",path:"style.fontFamily",label:"Font"},fontSize:{name:"fontSize",path:"style.fontSize",label:"Size"},fontWeight:{name:"fontWeight",path:"style.fontWeight",label:"Weight",options:["light","normal","medium","semibold","bold"]},textColor:{name:"textColor",path:"style.color",label:"Color"},textAlign:{name:"textAlign",path:"style.textAlign",label:"Align"},fontStyle:{name:"fontStyle",path:"style.fontStyle",label:"Style",options:["normal","italic"]},textTransform:{name:"textTransform",path:"style.textTransform",label:"Transform",options:["none","uppercase","lowercase","capitalize"]},lineHeight:{name:"lineHeight",path:"style.lineHeight",label:"LineH"},letterSpacing:{name:"letterSpacing",path:"style.letterSpacing",label:"LetterS"},orientation:{name:"orientation",path:"metadata.viewport.orientation",label:"Orientation",options:["landscape","portrait"]}},qs={type:"shape",sections:[{name:"size",title:"Size & Position",controls:["x","width","y","height","rotation"]},{name:"typography",title:"Text",controls:["fontFamily","fontSize","textColor","fontWeight","textTransform","lineHeight","letterSpacing","textAlign","fontStyle"]},{name:"appearance",title:"Fill & Stroke",controls:["fillColor","strokeColor","strokeWidth"]},{name:"radius",title:"Corners",controls:["radiusTopLeft","radiusTopRight","radiusBottomRight","radiusBottomLeft"]},{name:"padding",title:"Padding",controls:["padTop","padRight","padBottom","padLeft"]},{name:"effects",title:"Effects",controls:["shadowLevel","opacity","blur"]}]},Hs={type:"text",sections:[{name:"typography",title:"Text",controls:["fontFamily","fontSize","fontWeight","textColor","textAlign"]},{name:"transform",title:"Transform",controls:["rotation"]},{name:"effects",title:"Effects",controls:["shadowLevel","opacity"]}]},Ps={type:"page",sections:[{name:"size",title:"Page Size",controls:["width","height","orientation"]},{name:"appearance",title:"Background",controls:["fillColor"]},{name:"typography",title:"Default Text Settings",controls:["fontFamily","fontSize","textColor"]}]};function Es(r){return r==="text"?Hs:r==="page"?Ps:qs}const Rr={0:"none",2:"sm",4:"",6:"md",8:"lg",12:"xl",16:"2xl",24:"3xl",9999:"full"},Vs={normal:"normal",regular:"normal",bold:"bold",medium:"medium",semibold:"semibold",light:"light"};function wa(r){return r.startsWith("[")?r:`[${r}]`}function Rs(r){if(r>=9999)return"rounded-full";const t=Object.keys(Rr).map(Number).sort((n,l)=>n-l).find(n=>n===r);if(t===void 0)return`rounded-${wa(r+"px")}`;const a=Rr[t];return a===""?"rounded":a==="none"?"rounded-none":`rounded-${a}`}function Xa(r,t){return t?/^[a-z]+-\d{1,3}$/i.test(t)?`${r}-${t}`:/^#|rgb|hsl/i.test(t)?`${r}-[${t}]`:`${r}-[${t}]`:""}function Ds(r){const t=Math.max(0,Math.min(100,Math.round(r)));return[0,5,10,20,25,30,40,50,60,70,75,80,90,95,100].includes(t)?`opacity-${t}`:`opacity-[${t}%]`}function Dr(r){var n;const t=[],a=r.style||{};switch(r.type){case"rectangle":case"ellipse":case"hotspot":case"collection":{if(a.fillColor&&t.push(Xa("bg",a.fillColor)),a.strokeColor||a.strokeWidth){a.strokeColor&&t.push(Xa("border",a.strokeColor));const l=a.strokeWidth??1;l===1?t.push("border"):l===2?t.push("border-2"):t.push(`border-[${l}px]`)}if((n=a.borderRadius)!=null&&n.dimensions){const l=a.borderRadius.dimensions,d=[l.topLeft,l.topRight,l.bottomRight,l.bottomLeft];d.every(o=>o===d[0])?t.push(Rs(d[0])):(l.topLeft!=null&&t.push(`rounded-tl-${wa(l.topLeft+"px")}`),l.topRight!=null&&t.push(`rounded-tr-${wa(l.topRight+"px")}`),l.bottomRight!=null&&t.push(`rounded-br-${wa(l.bottomRight+"px")}`),l.bottomLeft!=null&&t.push(`rounded-bl-${wa(l.bottomLeft+"px")}`))}if(a.padding){const l=a.padding,d=[l.top,l.right,l.bottom,l.left];d.every(o=>o===d[0])?t.push(`p-[${d[0]}px]`):t.push(`pt-[${l.top}px]`,`pr-[${l.right}px]`,`pb-[${l.bottom}px]`,`pl-[${l.left}px]`)}if(a.shadowLevel){const l=a.shadowLevel;["sm","md","lg","xl"].includes(l)?t.push(l==="md"?"shadow":"shadow-"+l):l==="none"||t.push("shadow")}break}case"text":{if(a.color&&t.push(Xa("text",a.color)),a.fontSize){const l=Number(a.fontSize),d={12:"text-xs",14:"text-sm",16:"text-base",18:"text-lg",20:"text-xl",24:"text-2xl"};d[l]?t.push(d[l]):t.push(`text-[${l}px]`)}if(a.fontWeight){const l=Vs[String(a.fontWeight).toLowerCase()]||a.fontWeight;l&&l!=="normal"&&t.push("font-"+l)}if(a.textAlign){const l=a.textAlign;["left","center","right","justify"].includes(l)&&t.push("text-"+l)}break}}return r.opacity!=null&&r.opacity!==100&&t.push(Ds(r.opacity)),Array.from(new Set(t))}const zr=()=>{},gr={open:!1,value:void 0,original:void 0,label:void 0,onPreview:zr,onCommit:zr},Ta=kt({...gr});function zs(r){Ta.update(()=>({open:!0,value:r.value,original:r.value,label:r.label,onPreview:r.onPreview,onCommit:r.onCommit}))}function Fs(r=!1){Ta.update(t=>(!r&&t.original!==void 0&&(t.onPreview(t.original),t.onCommit(t.original)),{...gr,open:!1}))}function Gs(r){Ta.update(t=>(t.value=r,t.onPreview(r),t))}function js(r){Ta.update(t=>(t.value=r,t.onPreview(r),t.onCommit(r),{...gr,open:!1}))}const zt={subscribe:Ta.subscribe,openPalette:zs,closePalette:Fs,preview:Gs,commit:js};var Os=f('<button class="color-chip svelte-115sz26"></button>');function Fr(r,t){Ct(t,!1);let a=He(t,"value",8),n=He(t,"label",8,""),l=He(t,"onPreview",8,()=>{}),d=He(t,"onCommit",8,()=>{}),o=He(t,"chipWidth",8),M=He(t,"chipHeight",8);function T(){zt.openPalette({value:a(),label:n(),onPreview:_=>{l()(_)},onCommit:_=>{d()(_)}})}Bt();var S=Os();E(()=>{ht(S,`width: ${o()??""}%; height: ${M()??""}rem; background: ${a()||"#334155"}`),ye(S,"aria-label",n())}),B("click",S,T),u(r,S),Tt()}var Ys=f('<div class="orient svelte-1lo0n9c" role="group" aria-label="Orientation"><button aria-label="Landscape" title="Landscape"><div class="frame landscape svelte-1lo0n9c" aria-hidden="true"></div></button> <span class="sep svelte-1lo0n9c" aria-hidden="true">|</span> <button aria-label="Portrait" title="Portrait"><div class="frame portrait svelte-1lo0n9c" aria-hidden="true"></div></button></div>'),Ks=f('<span class="unit svelte-1lo0n9c"> </span>'),Us=f('<label class="clab svelte-1lo0n9c"> </label> <div class="num svelte-1lo0n9c"><input type="number" class="svelte-1lo0n9c"/> <!> <div class="steppers svelte-1lo0n9c" aria-hidden="false"><button class="step up svelte-1lo0n9c" type="button" title="Increment">▴</button> <button class="step down svelte-1lo0n9c" type="button" title="Decrement">▾</button></div></div>',1),Js=f('<span class="clab svelte-1lo0n9c"> </span> <!>',1),Xs=f("<option> </option>"),Qs=f('<select class="svelte-1lo0n9c"><option disabled selected>Font family</option><!></select>'),ec=f("<option> </option>"),tc=f('<select class="svelte-1lo0n9c"><option disabled selected>Tranform</option><!></select>'),ac=f('<option class="capitalize"> </option>'),rc=f('<select class="svelte-1lo0n9c"></select>'),nc=f('<div class="seg svelte-1lo0n9c" role="group"><button><svg class="w-5 h-5 text-gray-800 dark:text-white" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 6h8m-8 4h12M6 14h8m-8 4h12"></path></svg></button> <button><svg class="w-5 h-5 text-gray-800 dark:text-white" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M18 6H6m12 4H6m12 4H6m12 4H6"></path></svg></button> <button><svg class="w-5 h-5 text-gray-800 dark:text-white" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 6h8M6 10h12M8 14h8M6 18h12"></path></svg></button> <button><svg class="w-5 h-5 text-gray-800 dark:text-white" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M18 6h-8m8 4H6m12 4h-8m8 4H6"></path></svg></button></div> <button><svg class="w-5 h-5 text-gray-800 dark:text-white" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m8.874 19 6.143-14M6 19h6.33m-.66-14H18"></path></svg></button> <button><svg class="w-5 h-5 text-gray-800 dark:text-white" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path stroke="currentColor" stroke-linecap="round" stroke-width="2" d="M5 19h14M7.6 16l4.2979-10.92963c.0368-.09379.1674-.09379.2042 0L16.4 16m-8.8 0H6.5m1.1 0h1.65m7.15 0h-1.65m1.65 0h1.1m-8.33315-4h5.66025"></path></svg></button> <button><svg class="w-5 h-5 text-gray-800 dark:text-white" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" width="24" fill="currentColor"><path d="M0 0h24v24H0z" fill="none"></path><path stroke="none" d="M7.24 8.75c-.26-.48-.39-1.03-.39-1.67 0-.61.13-1.16.4-1.67.26-.5.63-.93 1.11-1.29.48-.35 1.05-.63 1.7-.83.66-.19 1.39-.29 2.18-.29.81 0 1.54.11 2.21.34.66.22 1.23.54 1.69.94.47.4.83.88 1.08 1.43s.38 1.15.38 1.81h-3.01c0-.31-.05-.59-.15-.85-.09-.27-.24-.49-.44-.68-.2-.19-.45-.33-.75-.44-.3-.1-.66-.16-1.06-.16-.39 0-.74.04-1.03.13s-.53.21-.72.36c-.19.16-.34.34-.44.55-.1.21-.15.43-.15.66 0 .48.25.88.74 1.21.38.25.77.48 1.41.7H7.39c-.05-.08-.11-.17-.15-.25zM21 12v-2H3v2h9.62c.18.07.4.14.55.2.37.17.66.34.87.51s.35.36.43.57c.07.2.11.43.11.69 0 .23-.05.45-.14.66-.09.2-.23.38-.42.53-.19.15-.42.26-.71.35-.29.08-.63.13-1.01.13-.43 0-.83-.04-1.18-.13s-.66-.23-.91-.42c-.25-.19-.45-.44-.59-.75s-.25-.76-.25-1.21H6.4c0 .55.08 1.13.24 1.58s.37.85.65 1.21c.28.35.6.66.98.92.37.26.78.48 1.22.65.44.17.9.3 1.38.39.48.08.96.13 1.44.13.8 0 1.53-.09 2.18-.28s1.21-.45 1.67-.79c.46-.34.82-.77 1.07-1.27s.38-1.07.38-1.71c0-.6-.1-1.14-.31-1.61-.05-.11-.11-.23-.17-.33H21V12z"></path></svg></button>',1),oc=f('<span class="unit svelte-1lo0n9c"> </span>'),ic=f('<div class="num svelte-1lo0n9c"><input type="number" class="svelte-1lo0n9c"/> <!> <div class="steppers svelte-1lo0n9c" aria-hidden="false"><button class="step up svelte-1lo0n9c" type="button" title="Increment">▴</button> <button class="step down svelte-1lo0n9c" type="button" title="Decrement">▾</button></div></div>'),lc=f('<span class="unit svelte-1lo0n9c"> </span>'),sc=f('<div class="num svelte-1lo0n9c"><input type="number" class="svelte-1lo0n9c"/> <!> <div class="steppers svelte-1lo0n9c" aria-hidden="false"><button class="step up svelte-1lo0n9c" type="button" title="Increment">▴</button> <button class="step down svelte-1lo0n9c" type="button" title="Decrement">▾</button></div></div>'),cc=f('<span class="unit svelte-1lo0n9c"> </span>'),dc=f('<div class="num svelte-1lo0n9c"><input type="number" class="svelte-1lo0n9c"/> <!> <div class="steppers svelte-1lo0n9c" aria-hidden="false"><button class="step up svelte-1lo0n9c" type="button" title="Increment">▴</button> <button class="step down svelte-1lo0n9c" type="button" title="Decrement">▾</button></div></div>'),uc=f('<span class="unit"> </span>'),vc=f('<div class="flex"><label><!></label> <input class="bg-transparent w-full svelte-1lo0n9c" type="number"/> <!></div>'),pc=f('<input class="w-full text-center col-start-2 row-start-1 svelte-1lo0n9c" type="number" placeholder="T"/>'),fc=f('<input class="w-full text-center col-start-1 row-start-2 svelte-1lo0n9c" type="number" placeholder="L"/>'),gc=f('<input class="w-full text-center col-start-3 row-start-2 svelte-1lo0n9c" type="number" placeholder="R"/>'),mc=f('<input class="w-full text-center col-start-0 row-start-3 svelte-1lo0n9c" type="number" placeholder="B"/>'),hc=f('<div class="flex flex-col"><label class="clab svelte-1lo0n9c"> </label> <div class="sliderRow svelte-1lo0n9c"><input class="range svelte-1lo0n9c" type="range"/> <div class="valueBox svelte-1lo0n9c"> <span class="unitBox svelte-1lo0n9c">px</span></div></div></div>'),bc=f('<div class="flex flex-col"><label class="clab svelte-1lo0n9c"> </label> <div class="sliderRow svelte-1lo0n9c"><input class="range svelte-1lo0n9c" type="range"/> <div class="valueBox svelte-1lo0n9c"> </div></div></div>'),_c=f('<div class="flex flex-col"><label class="clab svelte-1lo0n9c"> </label> <div class="sliderRow svelte-1lo0n9c"><input class="range svelte-1lo0n9c" type="range"/> <div class="valueBox svelte-1lo0n9c"> <span class="unitBox svelte-1lo0n9c">%</span></div></div></div>'),wc=f('<label class="clab svelte-1lo0n9c"> </label> <input type="text" class="svelte-1lo0n9c"/>',1),xc=f('<div class="control svelte-1lo0n9c"><!></div>');function Rt(r,t){Ct(t,!1);const a=Ie(),n=Ie(),l=Ie(),d=Ie();let o=He(t,"ctrlDesc",12),M=He(t,"sectionName",8),T=He(t,"ctx",8),S=He(t,"onPreview",8,()=>{}),_=He(t,"onCommit",8,()=>{});const q=["system-ui","Georgia, serif","ui-monospace, monospace"],k=["none","sm","md","lg","xl","2xl","inner"],V={width:"Width (px)",height:"Height (px)",x:"X position (px)",y:"Y position (px)",rotation:"Rotation (degrees)",fillColor:"Fill color",strokeColor:"Stroke color",strokeWidth:"Stroke width (px)",shadowLevel:"Shadow level",opacity:"Opacity (%)",blur:"Blur (px)",radiusTopLeft:"Top-left corner radius (px)",radiusTopRight:"Top-right corner radius (px)",radiusBottomRight:"Bottom-right corner radius (px)",radiusBottomLeft:"Bottom-left corner radius (px)",padTop:"Padding top (px)",padRight:"Padding right (px)",padBottom:"Padding bottom (px)",padLeft:"Padding left (px)",fontFamily:"Font family",fontSize:"Font size (px)",fontWeight:"Font weight",textColor:"Text color",textAlign:"Text alignment",fontStyle:"Font style",textTransform:"Text transform",lineHeight:"Line height",letterSpacing:"Letter spacing",orientation:"Page orientation",defFontFamily:"Default font family",defFontSize:"Default font size",defTextColor:"Default text color"};function G(re){return re.split(".").reduce((W,p)=>W==null?void 0:W[p],T())}let C=Ie(void 0);function R(re,W){return re==="rotation"?(W%360+360)%360:(re==="opacity"&&(W<0&&(W=0),W>100&&(W=100)),W)}function de(re,W){return re==="rotation"?W!=null&&W.shiftKey?15:W!=null&&W.altKey?5:1:W!=null&&W.shiftKey?5:1}function L(re){S()(re)}function j(re){_()(re)}function _e(re){const W=e(C)!==void 0&&e(C)!==""?Number(e(C)):typeof e(n)=="number"?e(n):0,p=de(o().name);let A=R(o().name,W+re*p);g(C,String(A)),L(A)}wt(()=>m(o()),()=>{g(a,V[o().name]||o().label||String(o().name))}),wt(()=>m(o()),()=>{g(n,o().path?G(o().path):void 0)}),wt(()=>e(n),()=>{g(l,e(n)==null?"":e(n))}),wt(()=>m(o()),()=>{g(d,o().name==="rotation"?"°":o().name==="opacity"?"%":"")}),ea(),Bt();var Fe=xc(),Be=s(Fe);lr(Be,()=>(m(o()),c(()=>o().path)),re=>{var W=$e(),p=be(W);{var A=le=>{var N=$e(),fe=be(N);{var ie=h=>{var H=Ys(),se=s(H);let me;var ce=v(se,4);let ne;i(H),E((ue,oe)=>{me=rt(se,1,"svelte-1lo0n9c",null,me,ue),ne=rt(ce,1,"svelte-1lo0n9c",null,ne,oe)},[()=>({selected:e(n)==="landscape"}),()=>({selected:e(n)==="portrait"})]),B("click",se,()=>j("landscape")),B("click",ce,()=>j("portrait")),u(h,H)},I=h=>{var H=Us(),se=be(H),me=s(se,!0);i(se);var ce=v(se,2),ne=s(ce);pt(ne);var ue=v(ne,2);{var oe=ve=>{var Me=Ks(),U=s(Me,!0);i(Me),E(()=>Ae(U,e(d))),u(ve,Me)};$(ue,ve=>{e(d)&&ve(oe)})}var Ge=v(ue,2),je=s(Ge),Re=v(je,2);i(Ge),i(ce),E(()=>{ye(se,"for",(m(o()),c(()=>o().path))),Ae(me,(m(o()),c(()=>o().label))),ye(ne,"id",(m(o()),c(()=>o().path))),ye(ne,"placeholder",e(l))}),At(ne,()=>e(C),ve=>g(C,ve)),B("focus",ne,()=>{g(C,e(n)==null?"":String(e(n)))}),B("keydown",ne,ve=>{if(["ArrowUp","ArrowDown"].includes(ve.key)){ve.stopPropagation();let Me=e(C)!==void 0&&e(C)!==""?Number(e(C)):typeof e(n)=="number"?e(n):0;const U=de(o().name,ve);Me+=(ve.key==="ArrowUp"?1:-1)*U,Me=R(o().name,Me),g(C,String(Me)),L(Number(Me))}}),B("input",ne,ve=>{g(C,ve.target.value);let Me=Number(e(C));Me=R(o().name,Me),L(Me)}),B("blur",ne,()=>{let ve=Number(e(C));ve=R(o().name,ve),g(C,String(ve)),j(ve)}),B("click",je,()=>_e(1)),B("click",Re,()=>_e(-1)),u(h,H)};$(fe,h=>{m(o()),c(()=>o().name==="orientation")?h(ie):h(I,!1)})}u(le,N)},D=le=>{var N=$e(),fe=be(N);{var ie=h=>{var H=Js(),se=be(H),me=s(se,!0);i(se);var ce=v(se,2);Fr(ce,{chipWidth:100,chipHeight:1.5,get value(){return e(n)},get label(){return m(o()),c(()=>o().label)},onPreview:ne=>L(ne),onCommit:ne=>j(ne)}),E(()=>Ae(me,(m(o()),c(()=>o().label)))),u(h,H)},I=h=>{var H=$e(),se=be(H);{var me=ne=>{var ue=$e(),oe=be(ue);{var Ge=Re=>{var ve=Qs(),Me=s(ve);Me.value=Me.__value="";var U=v(Me);Ke(U,1,()=>q,tt,(ge,he)=>{var we=Xs(),te=s(we,!0);i(we);var J={};E(()=>{It(we,e(he)===e(n)),Ae(te,e(he)),J!==(J=e(he))&&(we.value=(we.__value=e(he))??"")}),u(ge,we)}),i(ve),E(()=>ye(ve,"id",(m(o()),c(()=>o().path)))),B("change",ve,ge=>j(ge.target.value)),u(Re,ve)},je=Re=>{var ve=$e(),Me=be(ve);{var U=he=>{var we=tc(),te=s(we);te.value=te.__value="";var J=v(te);Ke(J,1,()=>(m(o()),c(()=>o().options||["None","Uppercase","Lowercase","Capitalize"])),tt,(O,y)=>{var Z=ec(),P=s(Z,!0);i(Z);var ke={};E(()=>{It(Z,e(y)===e(n)),Ae(P,e(y)),ke!==(ke=e(y))&&(Z.value=(Z.__value=e(y))??"")}),u(O,Z)}),i(we),E(()=>ye(we,"id",(m(o()),c(()=>o().path)))),B("change",we,O=>j(O.target.value)),u(he,we)},ge=he=>{var we=$e(),te=be(we);{var J=y=>{var Z=rc();Ke(Z,5,()=>(m(o()),c(()=>o().options||["Light","Normal","Medium","Semibold","Bold"])),tt,(P,ke)=>{var pe=ac(),X=s(pe,!0);i(pe);var ae={};E(()=>{It(pe,e(ke)===e(n)),Ae(X,e(ke)),ae!==(ae=e(ke))&&(pe.value=(pe.__value=e(ke))??"")}),u(P,pe)}),i(Z),E(()=>ye(Z,"id",(m(o()),c(()=>o().path)))),B("change",Z,P=>j(P.target.value)),u(y,Z)},O=y=>{var Z=$e(),P=be(Z);{var ke=X=>{var ae=nc(),Pe=be(ae),Y=s(Pe);let Q;var ee=v(Y,2);let Ne;var Ze=v(ee,2);let xe;var De=v(Ze,2);let Ee;i(Pe);var Te=v(Pe,2);let et;var We=v(Te,2);let Se;var Ye=v(We,2);let Ue;E((F,K,qe,b,w,x,z)=>{ye(Pe,"aria-labelledby",(m(o()),c(()=>o().path+"-label"))),Q=rt(Y,1,"svelte-1lo0n9c",null,Q,F),Ne=rt(ee,1,"svelte-1lo0n9c",null,Ne,K),xe=rt(Ze,1,"svelte-1lo0n9c",null,xe,qe),Ee=rt(De,1,"svelte-1lo0n9c",null,Ee,b),et=rt(Te,1,"",null,et,w),Se=rt(We,1,"",null,Se,x),Ue=rt(Ye,1,"",null,Ue,z)},[()=>({selected:e(n)==="left"}),()=>({selected:e(n)==="justify"}),()=>({selected:e(n)==="center"}),()=>({selected:e(n)==="right"}),()=>({selected:e(n)==="right"}),()=>({selected:e(n)==="right"}),()=>({selected:e(n)==="right"})]),B("click",Y,()=>j("left")),B("click",ee,()=>j("justify")),B("click",Ze,()=>j("center")),B("click",De,()=>j("right")),B("click",Te,()=>j("right")),B("click",We,()=>j("right")),B("click",Ye,()=>j("right")),u(X,ae)},pe=X=>{var ae=$e(),Pe=be(ae);{var Y=ee=>{var Ne=ic(),Ze=s(Ne);pt(Ze);var xe=v(Ze,2);{var De=We=>{var Se=oc(),Ye=s(Se,!0);i(Se),E(()=>Ae(Ye,e(d))),u(We,Se)};$(xe,We=>{e(d)&&We(De)})}var Ee=v(xe,2),Te=s(Ee),et=v(Te,2);i(Ee),i(Ne),E(()=>{ye(Ze,"id",(m(o()),c(()=>o().path))),ye(Ze,"placeholder",e(l))}),At(Ze,()=>e(C),We=>g(C,We)),B("focus",Ze,()=>{g(C,e(n)==null?"":String(e(n)))}),B("keydown",Ze,We=>{if(["ArrowUp","ArrowDown"].includes(We.key)){We.stopPropagation();let Se=e(C)!==void 0&&e(C)!==""?Number(e(C)):typeof e(n)=="number"?e(n):0;const Ye=de(o().name,We);Se+=(We.key==="ArrowUp"?1:-1)*Ye,Se=R(o().name,Se),g(C,String(Se)),L(Number(Se))}}),B("input",Ze,We=>{g(C,We.target.value);let Se=Number(e(C));Se=R(o().name,Se),L(Se)}),B("blur",Ze,()=>{let We=Number(e(C));We=R(o().name,We),g(C,String(We)),j(We)}),B("click",Te,()=>_e(1)),B("click",et,()=>_e(-1)),u(ee,Ne)},Q=ee=>{var Ne=$e(),Ze=be(Ne);{var xe=Ee=>{var Te=sc(),et=s(Te);pt(et),ye(et,"placeholder","Line height");var We=v(et,2);{var Se=K=>{var qe=lc(),b=s(qe,!0);i(qe),E(()=>Ae(b,e(d))),u(K,qe)};$(We,K=>{e(d)&&K(Se)})}var Ye=v(We,2),Ue=s(Ye),F=v(Ue,2);i(Ye),i(Te),E(()=>ye(et,"id",(m(o()),c(()=>o().path)))),At(et,()=>e(C),K=>g(C,K)),B("focus",et,()=>{g(C,e(n)==null?"":String(e(n)))}),B("keydown",et,K=>{if(["ArrowUp","ArrowDown"].includes(K.key)){K.stopPropagation();let qe=e(C)!==void 0&&e(C)!==""?Number(e(C)):typeof e(n)=="number"?e(n):0;const b=de(o().name,K);qe+=(K.key==="ArrowUp"?1:-1)*b,qe=R(o().name,qe),g(C,String(qe)),L(Number(qe))}}),B("input",et,K=>{g(C,K.target.value);let qe=Number(e(C));qe=R(o().name,qe),L(qe)}),B("blur",et,()=>{let K=Number(e(C));K=R(o().name,K),g(C,String(K)),j(K)}),B("click",Ue,()=>_e(1)),B("click",F,()=>_e(-1)),u(Ee,Te)},De=Ee=>{var Te=$e(),et=be(Te);{var We=Ye=>{var Ue=dc(),F=s(Ue);pt(F),ye(F,"placeholder","Letter spacing");var K=v(F,2);{var qe=z=>{var Ce=cc(),Ve=s(Ce,!0);i(Ce),E(()=>Ae(Ve,e(d))),u(z,Ce)};$(K,z=>{e(d)&&z(qe)})}var b=v(K,2),w=s(b),x=v(w,2);i(b),i(Ue),E(()=>ye(F,"id",(m(o()),c(()=>o().path)))),At(F,()=>e(C),z=>g(C,z)),B("focus",F,()=>{g(C,e(n)==null?"":String(e(n)))}),B("keydown",F,z=>{if(["ArrowUp","ArrowDown"].includes(z.key)){z.stopPropagation();let Ce=e(C)!==void 0&&e(C)!==""?Number(e(C)):typeof e(n)=="number"?e(n):0;const Ve=de(o().name,z);Ce+=(z.key==="ArrowUp"?1:-1)*Ve,Ce=R(o().name,Ce),g(C,String(Ce)),L(Number(Ce))}}),B("input",F,z=>{g(C,z.target.value);let Ce=Number(e(C));Ce=R(o().name,Ce),L(Ce)}),B("blur",F,()=>{let z=Number(e(C));z=R(o().name,z),g(C,String(z)),j(z)}),B("click",w,()=>_e(1)),B("click",x,()=>_e(-1)),u(Ye,Ue)},Se=Ye=>{var Ue=$e(),F=be(Ue);{var K=qe=>{Fr(qe,{chipWidth:100,chipHeight:2,get value(){return e(n)},get label(){return m(o()),c(()=>o().label)},onPreview:b=>L(b),onCommit:b=>j(b)})};$(F,qe=>{m(o()),c(()=>o().name==="textColor")&&qe(K)},!0)}u(Ye,Ue)};$(et,Ye=>{m(o()),c(()=>o().name==="letterSpacing")?Ye(We):Ye(Se,!1)},!0)}u(Ee,Te)};$(Ze,Ee=>{m(o()),c(()=>o().name==="lineHeight")?Ee(xe):Ee(De,!1)},!0)}u(ee,Ne)};$(Pe,ee=>{m(o()),c(()=>o().name==="fontSize")?ee(Y):ee(Q,!1)},!0)}u(X,ae)};$(P,X=>{m(o()),c(()=>o().name==="textAlign")?X(ke):X(pe,!1)},!0)}u(y,Z)};$(te,y=>{m(o()),c(()=>o().name==="fontWeight")?y(J):y(O,!1)},!0)}u(he,we)};$(Me,he=>{m(o()),c(()=>o().name=="textTransform")?he(U):he(ge,!1)},!0)}u(Re,ve)};$(oe,Re=>{m(o()),c(()=>o().name=="fontFamily")?Re(Ge):Re(je,!1)})}u(ne,ue)},ce=ne=>{var ue=$e(),oe=be(ue);{var Ge=Re=>{var ve=vc(),Me=s(ve);let U;var ge=s(Me);sa(ge,()=>(m(o()),c(()=>o().label))),i(Me);var he=v(Me,2);pt(he);var we=v(he,2);{var te=J=>{var O=uc(),y=s(O,!0);i(O),E(()=>Ae(y,e(d))),u(J,O)};$(we,J=>{e(d)&&J(te)})}i(ve),E(J=>{U=rt(Me,1,"text-2xl",null,U,J),ye(Me,"for",(m(o()),c(()=>o().path))),ye(he,"id",(m(o()),c(()=>o().path))),ye(he,"placeholder",e(l))},[()=>({"order-1":o().name=="radiusBottomLeft"||o().name=="radiusTopRight"})]),At(he,()=>e(C),J=>g(C,J)),B("focus",he,()=>{g(C,e(n)==null?"":String(e(n)))}),B("keydown",he,J=>{if(["ArrowUp","ArrowDown"].includes(J.key)){J.stopPropagation();let O=e(C)!==void 0&&e(C)!==""?Number(e(C)):typeof e(n)=="number"?e(n):0;const y=de(o().name,J);O+=(J.key==="ArrowUp"?1:-1)*y,O=R(o().name,O),g(C,String(O)),L(Number(O))}}),B("input",he,J=>{g(C,J.target.value);let O=Number(e(C));O=R(o().name,O),L(O)}),B("blur",he,()=>{let J=Number(e(C));J=R(o().name,J),g(C,String(J)),j(J)}),u(Re,ve)},je=Re=>{var ve=$e(),Me=be(ve);{var U=he=>{var we=$e(),te=be(we);{var J=y=>{var Z=pc();pt(Z),E(()=>ye(Z,"id",(m(o()),c(()=>o().path)))),At(Z,()=>o().path,P=>o(o().path=P,!0)),u(y,Z)},O=y=>{var Z=$e(),P=be(Z);{var ke=X=>{var ae=fc();pt(ae),E(()=>ye(ae,"id",(m(o()),c(()=>o().path)))),At(ae,()=>o().path,Pe=>o(o().path=Pe,!0)),u(X,ae)},pe=X=>{var ae=$e(),Pe=be(ae);{var Y=ee=>{var Ne=gc();pt(Ne),E(()=>ye(Ne,"id",(m(o()),c(()=>o().path)))),At(Ne,()=>o().path,Ze=>o(o().path=Ze,!0)),u(ee,Ne)},Q=ee=>{var Ne=$e(),Ze=be(Ne);{var xe=De=>{var Ee=mc();pt(Ee),E(()=>ye(Ee,"id",(m(o()),c(()=>o().path)))),At(Ee,()=>o().path,Te=>o(o().path=Te,!0)),u(De,Ee)};$(Ze,De=>{m(o()),c(()=>o().name==="padBottom")&&De(xe)},!0)}u(ee,Ne)};$(Pe,ee=>{m(o()),c(()=>o().name==="padRight")?ee(Y):ee(Q,!1)},!0)}u(X,ae)};$(P,X=>{m(o()),c(()=>o().name==="padLeft")?X(ke):X(pe,!1)},!0)}u(y,Z)};$(te,y=>{m(o()),c(()=>o().name==="padTop")?y(J):y(O,!1)})}u(he,we)},ge=he=>{var we=$e(),te=be(we);{var J=y=>{var Z=$e(),P=be(Z);{var ke=X=>{var ae=hc(),Pe=s(ae),Y=s(Pe,!0);i(Pe);var Q=v(Pe,2),ee=s(Q);pt(ee),ye(ee,"min",0),ye(ee,"max",50),ye(ee,"step",1);var Ne=v(ee,2),Ze=s(Ne,!0);Pt(),i(Ne),i(Q),i(ae),E(()=>{ye(Pe,"for",(m(o()),c(()=>o().path))),Ae(Y,(m(o()),c(()=>o().label))),ye(ee,"id",(m(o()),c(()=>o().path))),jt(ee,typeof e(n)=="number"?e(n):0),Ae(Ze,e(n)??0)}),B("input",ee,xe=>{const De=Number(xe.target.value);L(De)}),B("change",ee,xe=>{const De=Number(xe.target.value);j(De)}),u(X,ae)},pe=X=>{var ae=$e(),Pe=be(ae);{var Y=ee=>{var Ne=bc(),Ze=s(Ne),xe=s(Ze,!0);i(Ze);var De=v(Ze,2),Ee=s(De);pt(Ee),ye(Ee,"min",0),ye(Ee,"step",1);var Te=v(Ee,2),et=s(Te,!0);i(Te),i(De),i(Ne),E(We=>{ye(Ze,"for",(m(o()),c(()=>o().path))),Ae(xe,(m(o()),c(()=>o().label))),ye(Ee,"id",(m(o()),c(()=>o().path))),ye(Ee,"max",c(()=>k.length-1)),jt(Ee,We),Ae(et,e(n)??"none")},[()=>(e(n),c(()=>Math.max(0,k.indexOf(e(n)??"none"))))]),B("input",Ee,We=>{const Se=Number(We.target.value);L(k[Se])}),B("change",Ee,We=>{const Se=Number(We.target.value);j(k[Se])}),u(ee,Ne)},Q=ee=>{var Ne=$e(),Ze=be(Ne);{var xe=De=>{var Ee=_c(),Te=s(Ee),et=s(Te,!0);i(Te);var We=v(Te,2),Se=s(We);pt(Se),ye(Se,"min",0),ye(Se,"max",100),ye(Se,"step",1);var Ye=v(Se,2),Ue=s(Ye,!0);Pt(),i(Ye),i(We),i(Ee),E(F=>{ye(Te,"for",(m(o()),c(()=>o().path))),Ae(et,(m(o()),c(()=>o().label))),ye(Se,"id",(m(o()),c(()=>o().path))),jt(Se,F),Ae(Ue,e(n)??100)},[()=>(e(n),c(()=>typeof e(n)=="number"?e(n):e(n)==null?100:Number(e(n))))]),B("input",Se,F=>{let K=Number(F.target.value);K=R("opacity",K),L(K)}),B("change",Se,F=>{let K=Number(F.target.value);K=R("opacity",K),j(K)}),u(De,Ee)};$(Ze,De=>{m(o()),c(()=>o().name==="opacity")&&De(xe)},!0)}u(ee,Ne)};$(Pe,ee=>{m(o()),c(()=>o().name==="shadowLevel")?ee(Y):ee(Q,!1)},!0)}u(X,ae)};$(P,X=>{m(o()),c(()=>o().name==="blur")?X(ke):X(pe,!1)})}u(y,Z)},O=y=>{var Z=wc(),P=be(Z),ke=s(P,!0);i(P);var pe=v(P,2);pt(pe),E(()=>{ye(P,"for",(m(o()),c(()=>o().path))),Ae(ke,(m(o()),c(()=>o().label))),ye(pe,"id",(m(o()),c(()=>o().path))),ye(pe,"placeholder",e(l))}),At(pe,()=>e(C),X=>g(C,X)),B("input",pe,X=>{g(C,X.target.value),L(e(C))}),B("blur",pe,()=>j(e(C))),u(y,Z)};$(te,y=>{M()==="effects"?y(J):y(O,!1)},!0)}u(he,we)};$(Me,he=>{M()==="padding"?he(U):he(ge,!1)},!0)}u(Re,ve)};$(oe,Re=>{M()==="radius"?Re(Ge):Re(je,!1)},!0)}u(ne,ue)};$(se,ne=>{M()=="typography"?ne(me):ne(ce,!1)},!0)}u(h,H)};$(fe,h=>{M()=="appearance"?h(ie):h(I,!1)},!0)}u(le,N)};$(p,le=>{M()=="size"?le(A):le(D,!1)})}u(re,W)}),i(Fe),ca(Fe,(re,W)=>{var p;return(p=da)==null?void 0:p(re,W)},()=>({content:e(a),placement:"auto",offset:8})),E(()=>ye(Fe,"data-id",(m(o()),c(()=>o().name)))),u(r,Fe),Tt()}var yc=f("<option> </option>"),kc=f("<optgroup></optgroup>"),Ic=f('<div class="control-row col-start-2 row-start-1 w-full"><!></div>'),Cc=f('<div class="control-row col-start-1 row-start-2 w-full"><!></div>'),Tc=f('<div class="control-row col-start-3 row-start-2 w-full"><!></div>'),Sc=f('<div class="control-row col-start-2 row-start-3 w-full"><!></div>'),Ac=f('<div class="grid grid-cols-3 grid-rows-3 gap-1 place-items-center w-full"><div></div> <!> <div></div> <!> <div class="w-full h-6"></div> <!> <div></div> <!> <div></div></div>'),Bc=f('<div class="control-row"><!></div>'),Mc=f("<div></div>"),Zc=f('<div class="control-row"><!></div>'),Lc=f("<div></div>"),$c=f('<div class="section svelte-1u2agdc"><div class="section-title font-bold svelte-1u2agdc"> </div> <!></div>'),Nc=f('<div class="panel-root flex-1 min-h-0 overflow-hidden svelte-1u2agdc"><div class="px-3 flex-1 min-h-0 overflow-y-auto overflow-x-hidden"><label class="element-header svelte-1u2agdc" for="device-select">Device</label> <select id="device-select" class="w-full mb-3 bg-slate-900 border border-slate-600 text-slate-100 text-xs p-2 rounded"><option>Custom size</option><!></select> <!></div></div>'),Wc=qt('<svg role="button" tabindex="0" aria-label="Unlock element" aria-pressed="true" class="w-4 h-4 cursor-pointer outline-0 text-gray-800 dark:text-white" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 24 24"><path fill-rule="evenodd" d="M8 10V7a4 4 0 1 1 8 0v3h1a2 2 0 0 1 2 2v7a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2v-7a2 2 0 0 1 2-2h1Zm2-3a2 2 0 1 1 4 0v3h-4V7Zm2 6a1 1 0 0 1 1 1v3a1 1 0 1 1-2 0v-3a1 1 0 0 1 1-1Z" clip-rule="evenodd"></path></svg>'),qc=qt('<svg role="button" tabindex="0" aria-label="Unlock element" aria-pressed="true" class="w-4 h-4 cursor-pointer outline-0 text-gray-800 dark:text-white" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 24 24"><path fill-rule="evenodd" d="M15 7a2 2 0 1 1 4 0v4a1 1 0 1 0 2 0V7a4 4 0 0 0-8 0v3H5a2 2 0 0 0-2 2v7a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2v-7a2 2 0 0 0-2-2V7Zm-5 6a1 1 0 0 1 1 1v3a1 1 0 1 1-2 0v-3a1 1 0 0 1 1-1Z" clip-rule="evenodd"></path></svg>'),Hc=qt('<svg role="button" tabindex="0" aria-label="Unlock element" aria-pressed="true" class="w-4 h-4 cursor-pointer outline-0 text-gray-800 dark:text-white" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path stroke="currentColor" stroke-width="2" d="M21 12c0 1.2-4.03 6-9 6s-9-4.8-9-6c0-1.2 4.03-6 9-6s9 4.8 9 6Z"></path><path stroke="currentColor" stroke-width="2" d="M15 12a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z"></path></svg>'),Pc=qt('<svg role="button" tabindex="0" aria-label="Unlock element" aria-pressed="true" class="w-4 h-4 cursor-pointer outline-0 text-gray-800 dark:text-white" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3.933 13.909A4.357 4.357 0 0 1 3 12c0-1 4-6 9-6m7.6 3.8A5.068 5.068 0 0 1 21 12c0 1-3 6-9 6-.314 0-.62-.014-.918-.04M5 19 19 5m-4 7a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z"></path></svg>'),Ec=f('<div class="text-[10px] mb-1 text-amber-600 font-medium">Locked (read-only)</div>'),Vc=f('<div class="control-row col-start-2 row-start-1 w-full"><!></div>'),Rc=f('<div class="control-row col-start-1 row-start-2 w-full"><!></div>'),Dc=f('<div class="control-row col-start-3 row-start-2 w-full"><!></div>'),zc=f('<div class="control-row col-start-2 row-start-3 w-full"><!></div>'),Fc=f('<div class="grid grid-cols-3 grid-rows-3 gap-1 place-items-center w-full"><div></div> <!> <div></div> <!> <div class="w-full h-6"></div> <!> <div></div> <!> <div></div></div>'),Gc=f("<div><!></div>"),jc=f("<div></div>"),Oc=f('<div class="section px-3 svelte-1u2agdc"><div class="section-title font-bold svelte-1u2agdc"> </div> <!> <!></div>'),Yc=f('<div class="panel-root flex-1 min-h-0 overflow-hidden svelte-1u2agdc"><div class="border-b border-slate-300 dark:border-slate-600 mb-2 px-3"><!></div> <div class="element-header flex justify-between items-center px-3 svelte-1u2agdc"><button aria-label="Edit element name" tabindex="0" aria-pressed="true" class="w-[60%] border-b border-dashed text-left"> </button> <div class="flex gap-2"><!> <!></div></div> <div class="flex-1 min-h-0 overflow-y-auto overflow-x-hidden thin-scroll"></div></div>'),Kc=f('<div class="text-xs text-slate-500">Nothing selected.</div>');function Uc(r,t){Ct(t,!1);const[a,n]=Kt(),l=()=>ut(aa,"$projectData",a),d=()=>ut(Nt,"$currentPageId",a),o=()=>ut(er,"$selectedElementId",a),M=()=>ut(e(T),"$contentEditable",a),T=Ie(),S=Ie(),_=Ie(),q=Ie(),k=Ie(),V=Ie(),G=Ie(),C=Ie(),R=Ie();function de(){var h;e(T).set(!0);const I=document.querySelector(".element-header [contenteditable]");I&&(I.focus(),(h=document.getSelection())==null||h.collapseToEnd())}function L(I,h,H){const se=h.split("."),me=se.pop();let ce=I;for(const ne of se)(!(ne in ce)||typeof ce[ne]!="object")&&(ce[ne]={}),ce=ce[ne];ce[me]=H}function j(I,h){try{return h.split(".").reduce((H,se)=>H==null?void 0:H[se],I)}catch{return}}let _e=null;function Fe(){!_e&&e(_)&&(_e=JSON.parse(JSON.stringify(e(_))))}function Be(){!e(_)||!_e||(Dt(_,e(_).style=_e.style),Dt(_,e(_).appliedClasses=Dr(e(_))),Pa(Xe(Nt),"style"))}function re(I,h,H,se){if(e(q)==="page"&&!e(_)){I.path&&L(e(S),I.path,h),Pa(Xe(Nt),"style");return}e(_)&&(e(_).locked||(Fe(),I.path&&L(_e,I.path,h),H?(Be(),_e=null):(Dt(_,e(_).style=_e.style),Dt(_,e(_).appliedClasses=Dr(e(_))))))}const W={size:"grid grid-cols-2 gap-2",typography:"grid grid-cols-2 gap-2",transform:"grid grid-cols-2 gap-2",radius:"grid grid-cols-2 gap-2",padding:"w-full",appearance:"grid gap-2",effects:"grid grid-cols-1 grid-rows-3 gap-2",page:"grid grid-cols-2 gap-2",defaultText:"grid grid-cols-2 gap-2"},p={mobile:{label:"Mobile",items:[{id:"iphone-13",label:"iPhone 13",w:390,h:844},{id:"iphone-se-2",label:"iPhone SE (2nd gen)",w:375,h:667},{id:"pixel-7",label:"Pixel 7",w:412,h:915}]},tablet:{label:"Tablet",items:[{id:"ipad-portrait",label:"iPad (P)",w:768,h:1024},{id:"ipad-landscape",label:"iPad (L)",w:1024,h:768}]},laptop:{label:"Laptop",items:[{id:"macbook-13",label:'13" MacBook',w:1280,h:800},{id:"hd-1366",label:"HD 1366×768",w:1366,h:768},{id:"fhd-1536",label:"FHD (scaled 1536×864)",w:1536,h:864}]},desktop:{label:"Desktop",items:[{id:"fhd",label:"FHD 1920×1080",w:1920,h:1080},{id:"wqhd",label:"WQHD 2560×1440",w:2560,h:1440}]}};function A(I,h){return e(C)===I&&e(R)===h}function D(){for(const I of Object.values(p))for(const h of I.items)if(A(h.w,h.h))return!0;return!1}wt(()=>kt,()=>{qn(g(T,kt(!1)),"$contentEditable",a)}),wt(()=>(l(),d()),()=>{g(S,l().pagesById[d()])}),wt(()=>(o(),e(S)),()=>{var I;g(_,o()?(I=e(S))==null?void 0:I.elements.find(h=>h.id===o()):null)}),wt(()=>e(_),()=>{g(q,e(_)?e(_).type:"page")}),wt(()=>e(q),()=>{g(k,Es(e(q)==="rectangle"||e(q)==="circle"||e(q)==="collection"?"shape":e(q)))}),wt(()=>Je,()=>{var I;g(V,(I=Je.width)==null?void 0:I.path)}),wt(()=>Je,()=>{var I;g(G,(I=Je.height)==null?void 0:I.path)}),wt(()=>(e(V),e(S)),()=>{g(C,e(V)?j(e(S),e(V)):void 0)}),wt(()=>(e(G),e(S)),()=>{g(R,e(G)?j(e(S),e(G)):void 0)}),ea(),Bt();var le=$e(),N=be(le);{var fe=I=>{var h=Nc(),H=s(h),se=v(s(H),2);se.__change=ue=>{var ve;const oe=ue.target.value;if(!oe)return;const[Ge,je]=oe.split(":"),Re=(ve=p[Ge])==null?void 0:ve.items.find(Me=>Me.id===je);Re&&(e(V)&&L(e(S),e(V),Re.w),e(G)&&L(e(S),e(G),Re.h),Pa(Xe(Nt),"style"))};var me=s(se);me.value=me.__value="";var ce=v(me);Ke(ce,1,()=>c(()=>Object.entries(p)),tt,(ue,oe)=>{var Ge=$n(()=>Nn(e(oe),2));let je=()=>e(Ge)[0],Re=()=>e(Ge)[1];var ve=kc();Ke(ve,5,()=>(Re(),c(()=>Re().items)),tt,(Me,U)=>{var ge=yc(),he=s(ge);i(ge);var we={};E(te=>{It(ge,te),Ae(he,`${e(U),c(()=>e(U).label)??""} — ${e(U),c(()=>e(U).w)??""}×${e(U),c(()=>e(U).h)??""}`),we!==(we=(je(),e(U),c(()=>`${je()}:${e(U).id}`)))&&(ge.value=(ge.__value=(je(),e(U),c(()=>`${je()}:${e(U).id}`)))??"")},[()=>(e(U),c(()=>A(e(U).w,e(U).h)))]),u(Me,ge)}),i(ve),E(()=>ye(ve,"label",(Re(),c(()=>Re().label)))),u(ue,ve)}),i(se);var ne=v(se,2);Ke(ne,1,()=>(e(k),c(()=>e(k).sections)),tt,(ue,oe)=>{var Ge=$c(),je=s(Ge),Re=s(je,!0);i(je);var ve=v(je,2);{var Me=ge=>{var he=Ac(),we=v(s(he),2);{var te=pe=>{var X=Ic();const ae=yt(()=>(m(Je),c(()=>Je.padTop)));var Pe=s(X);Rt(Pe,{get ctrlDesc(){return e(ae)},get sectionName(){return e(oe),c(()=>e(oe).name)},get ctx(){return e(S)},onPreview:Y=>re(e(ae),Y,!1,e(S)),onCommit:Y=>re(e(ae),Y,!0,e(S))}),i(X),u(pe,X)};$(we,pe=>{m(Je),c(()=>Je.padTop)&&pe(te)})}var J=v(we,4);{var O=pe=>{var X=Cc();const ae=yt(()=>(m(Je),c(()=>Je.padLeft)));var Pe=s(X);Rt(Pe,{get ctrlDesc(){return e(ae)},get sectionName(){return e(oe),c(()=>e(oe).name)},get ctx(){return e(S)},onPreview:Y=>re(e(ae),Y,!1,e(S)),onCommit:Y=>re(e(ae),Y,!0,e(S))}),i(X),u(pe,X)};$(J,pe=>{m(Je),c(()=>Je.padLeft)&&pe(O)})}var y=v(J,4);{var Z=pe=>{var X=Tc();const ae=yt(()=>(m(Je),c(()=>Je.padRight)));var Pe=s(X);Rt(Pe,{get ctrlDesc(){return e(ae)},get sectionName(){return e(oe),c(()=>e(oe).name)},get ctx(){return e(S)},onPreview:Y=>re(e(ae),Y,!1,e(S)),onCommit:Y=>re(e(ae),Y,!0,e(S))}),i(X),u(pe,X)};$(y,pe=>{m(Je),c(()=>Je.padRight)&&pe(Z)})}var P=v(y,4);{var ke=pe=>{var X=Sc();const ae=yt(()=>(m(Je),c(()=>Je.padBottom)));var Pe=s(X);Rt(Pe,{get ctrlDesc(){return e(ae)},get sectionName(){return e(oe),c(()=>e(oe).name)},get ctx(){return e(S)},onPreview:Y=>re(e(ae),Y,!1,e(S)),onCommit:Y=>re(e(ae),Y,!0,e(S))}),i(X),u(pe,X)};$(P,pe=>{m(Je),c(()=>Je.padBottom)&&pe(ke)})}Pt(2),i(he),u(ge,he)},U=ge=>{var he=$e(),we=be(he);{var te=O=>{var y=Mc();Ke(y,5,()=>(e(oe),c(()=>e(oe).controls)),tt,(Z,P)=>{var ke=$e(),pe=be(ke);{var X=ae=>{var Pe=Bc();const Y=yt(()=>(m(Je),e(P),c(()=>Je[e(P)])));var Q=s(Pe);Rt(Q,{get ctrlDesc(){return e(Y)},get sectionName(){return e(oe),c(()=>e(oe).name)},get ctx(){return e(S)},onPreview:ee=>re(e(Y),ee,!1,e(S)),onCommit:ee=>re(e(Y),ee,!0,e(S))}),i(Pe),u(ae,Pe)};$(pe,ae=>{m(Je),e(P),c(()=>Je[e(P)])&&ae(X)})}u(Z,ke)}),i(y),E(()=>rt(y,1,Ea((e(oe),c(()=>W[e(oe).name]||"grid gap-2"))),"svelte-1u2agdc")),u(O,y)},J=O=>{var y=Lc();Ke(y,5,()=>(e(oe),c(()=>e(oe).controls)),tt,(Z,P)=>{var ke=$e(),pe=be(ke);{var X=ae=>{var Pe=Zc();const Y=yt(()=>(m(Je),e(P),c(()=>Je[e(P)])));var Q=s(Pe);Rt(Q,{get ctrlDesc(){return e(Y)},get sectionName(){return e(oe),c(()=>e(oe).name)},get ctx(){return e(S)},onPreview:ee=>re(e(Y),ee,!1,e(S)),onCommit:ee=>re(e(Y),ee,!0,e(S))}),i(Pe),u(ae,Pe)};$(pe,ae=>{m(Je),e(P),c(()=>Je[e(P)])&&ae(X)})}u(Z,ke)}),i(y),E(()=>rt(y,1,Ea((e(oe),c(()=>W[e(oe).name]||"grid gap-2"))),"svelte-1u2agdc")),u(O,y)};$(we,O=>{e(oe),c(()=>e(oe).name==="size")?O(te):O(J,!1)},!0)}u(ge,he)};$(ve,ge=>{e(oe),c(()=>e(oe).name==="padding")?ge(Me):ge(U,!1)})}i(Ge),E(()=>{ye(Ge,"data-section",(e(oe),c(()=>e(oe).name))),Ae(Re,(e(oe),c(()=>e(oe).title)))}),u(ue,Ge)}),i(H),i(h),E(ue=>It(me,ue),[()=>c(()=>!D())]),u(I,h)},ie=I=>{var h=$e(),H=be(h);{var se=ce=>{var ne=Yc(),ue=s(ne),oe=s(ue);Jn(oe,{mode:"multiselect",singleStageAlign:!0,placement:"panel"}),i(ue);var Ge=v(ue,2),je=s(Ge);je.__dblclick=de;var Re=s(je,!0);i(je);var ve=v(je,2),Me=s(ve);{var U=O=>{var y=Wc();y.__click=function(...Z){var P;(P=Mr)==null||P.apply(this,Z)},u(O,y)},ge=O=>{var y=qc();y.__click=function(...Z){var P;(P=Mr)==null||P.apply(this,Z)},u(O,y)};$(Me,O=>{e(_),c(()=>e(_).locked)?O(U):O(ge,!1)})}var he=v(Me,2);{var we=O=>{var y=Hc();y.__click=function(...Z){var P;(P=Zr)==null||P.apply(this,Z)},u(O,y)},te=O=>{var y=Pc();y.__click=function(...Z){var P;(P=Zr)==null||P.apply(this,Z)},u(O,y)};$(he,O=>{e(_),c(()=>e(_).visible)?O(we):O(te,!1)})}i(ve),i(Ge);var J=v(Ge,2);Ke(J,5,()=>(e(k),c(()=>e(k).sections)),tt,(O,y)=>{var Z=Oc(),P=s(Z),ke=s(P,!0);i(P);var pe=v(P,2);{var X=Q=>{var ee=Ec();u(Q,ee)};$(pe,Q=>{e(_),c(()=>e(_).locked)&&Q(X)})}var ae=v(pe,2);{var Pe=Q=>{var ee=Fc(),Ne=v(s(ee),2);{var Ze=Se=>{var Ye=Vc();const Ue=yt(()=>(m(Je),c(()=>Je.padTop)));var F=s(Ye);Rt(F,{get ctrlDesc(){return e(Ue)},get sectionName(){return e(y),c(()=>e(y).name)},get ctx(){return e(_)},onPreview:K=>re(e(Ue),K,!1,e(_)),onCommit:K=>re(e(Ue),K,!0,e(_))}),i(Ye),u(Se,Ye)};$(Ne,Se=>{m(Je),c(()=>Je.padTop)&&Se(Ze)})}var xe=v(Ne,4);{var De=Se=>{var Ye=Rc();const Ue=yt(()=>(m(Je),c(()=>Je.padLeft)));var F=s(Ye);Rt(F,{get ctrlDesc(){return e(Ue)},get sectionName(){return e(y),c(()=>e(y).name)},get ctx(){return e(_)},onPreview:K=>re(e(Ue),K,!1,e(_)),onCommit:K=>re(e(Ue),K,!0,e(_))}),i(Ye),u(Se,Ye)};$(xe,Se=>{m(Je),c(()=>Je.padLeft)&&Se(De)})}var Ee=v(xe,4);{var Te=Se=>{var Ye=Dc();const Ue=yt(()=>(m(Je),c(()=>Je.padRight)));var F=s(Ye);Rt(F,{get ctrlDesc(){return e(Ue)},get sectionName(){return e(y),c(()=>e(y).name)},get ctx(){return e(_)},onPreview:K=>re(e(Ue),K,!1,e(_)),onCommit:K=>re(e(Ue),K,!0,e(_))}),i(Ye),u(Se,Ye)};$(Ee,Se=>{m(Je),c(()=>Je.padRight)&&Se(Te)})}var et=v(Ee,4);{var We=Se=>{var Ye=zc();const Ue=yt(()=>(m(Je),c(()=>Je.padBottom)));var F=s(Ye);Rt(F,{get ctrlDesc(){return e(Ue)},get sectionName(){return e(y),c(()=>e(y).name)},get ctx(){return e(_)},onPreview:K=>re(e(Ue),K,!1,e(_)),onCommit:K=>re(e(Ue),K,!0,e(_))}),i(Ye),u(Se,Ye)};$(et,Se=>{m(Je),c(()=>Je.padBottom)&&Se(We)})}Pt(2),i(ee),u(Q,ee)},Y=Q=>{var ee=jc();Ke(ee,5,()=>(e(y),c(()=>e(y).controls)),tt,(Ne,Ze)=>{var xe=$e(),De=be(xe);{var Ee=Te=>{var et=Gc();const We=yt(()=>(m(Je),e(Ze),c(()=>Je[e(Ze)])));let Se;var Ye=s(et);Rt(Ye,{get ctrlDesc(){return e(We)},get sectionName(){return e(y),c(()=>e(y).name)},get ctx(){return e(_)},onPreview:Ue=>re(e(We),Ue,!1,e(_)),onCommit:Ue=>re(e(We),Ue,!0,e(_))}),i(et),E(Ue=>Se=rt(et,1,"control-row w-full",null,Se,Ue),[()=>({"col-span-2":e(We).name=="textAlign"})]),u(Te,et)};$(De,Te=>{m(Je),e(Ze),c(()=>Je[e(Ze)])&&Te(Ee)})}u(Ne,xe)}),i(ee),E(()=>rt(ee,1,Ea((e(y),c(()=>W[e(y).name]))),"svelte-1u2agdc")),u(Q,ee)};$(ae,Q=>{e(y),c(()=>e(y).name==="padding")?Q(Pe):Q(Y,!1)})}i(Z),E(()=>{ye(Z,"data-section",(e(y),c(()=>e(y).name))),Ae(ke,(e(y),c(()=>e(y).title)))}),u(O,Z)}),i(J),i(ne),E(()=>{ye(je,"contenteditable",M()),Ae(Re,(e(_),c(()=>e(_).name)))}),u(ce,ne)},me=ce=>{var ne=Kc();u(ce,ne)};$(H,ce=>{e(_)?ce(se):ce(me,!1)},!0)}u(I,h)};$(N,I=>{e(q)==="page"&&!e(_)?I(fe):I(ie,!1)})}u(r,le),Tt(),n()}Ia(["change","dblclick","click"]);var Jc=f(" <!>",1),Xc=f('<div class="card svelte-klf66a" role="button" tabindex="0"><div class="head svelte-klf66a"><div class="name svelte-klf66a"> </div> <span> </span></div> <div class="sub svelte-klf66a"><!></div></div>'),Qc=f('<div class="py-2 text-sm flex items-center gap-2"><span class="font-mono text-xs px-1.5 py-0.5 rounded bg-slate-100 dark:bg-slate-700"> </span> <span class="font-semibold"> </span> <span class="opacity-60 text-xs"> </span> <span class="flex-1"></span> <button class="text-xs px-1.5 py-0.5 rounded bg-slate-200 dark:bg-slate-700">Rename</button> <button class="text-xs px-1.5 py-0.5 rounded bg-rose-600 text-white">Delete</button></div>'),ed=f('<button type="button" class="fixed inset-0 bg-black/30 z-10" aria-label="Close variables panel"></button> <div class="fixed z-20 bottom-4 right-4 w-[360px] bg-white dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded shadow-lg"><div class="px-3 py-2 border-b border-slate-200 dark:border-slate-700 flex items-center justify-between"><div class="text-sm font-semibold">Variables</div> <button class="text-xs px-2 py-0.5 rounded bg-slate-200 dark:bg-slate-700">Close</button></div> <div class="p-3 space-y-3"><form class="space-y-2"><div class="flex gap-2"><input class="flex-1 bg-transparent border border-slate-300 dark:border-slate-600 rounded px-2 py-1 text-sm" placeholder="Name (e.g. score)"/> <select class="border border-slate-300 dark:border-slate-600 rounded px-2 py-1 text-sm"><option>Global</option><option>Page</option></select> <select class="border border-slate-300 dark:border-slate-600 rounded px-2 py-1 text-sm"><option>string</option><option>number</option><option>boolean</option><option>json</option><option>object</option><option>array</option></select></div> <div class="flex gap-2 items-center"><label class="text-xs opacity-70"><input type="checkbox" class="mr-1 align-middle"/>Read only</label> <input class="flex-1 bg-transparent border border-slate-300 dark:border-slate-600 rounded px-2 py-1 text-sm" placeholder="Initial value (optional)"/></div> <div class="flex justify-end"><button class="text-xs px-2 py-1 rounded bg-emerald-600 text-white" type="submit">Add</button></div></form> <div class="max-h-64 overflow-auto divide-y divide-slate-200 dark:divide-slate-700"></div></div></div>',1),td=f('<div class="px-2"><div class="flex justify-between"><div><button class="cursor-pointer"><svg class="w-5 h-5 text-gray-800 dark:text-white" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 12h14m-7 7V5"></path></svg></button> <button class="cursor-pointer"><svg class="w-5 h-5 text-gray-800 dark:text-white" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.779 17.779 4.36 19.918 6.5 13.5m4.279 4.279 8.364-8.643a3.027 3.027 0 0 0-2.14-5.165 3.03 3.03 0 0 0-2.14.886L6.5 13.5m4.279 4.279L6.499 13.5m2.14 2.14 6.213-6.504M12.75 7.04 17 11.28"></path></svg></button> <button class="cursor-pointer"><svg class="w-5 h-5 text-gray-800 dark:text-white" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 24 24"><path fill-rule="evenodd" d="M7 9v6a4 4 0 0 0 4 4h4a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V9a2 2 0 0 1 2-2h1v2Z" clip-rule="evenodd"></path><path fill-rule="evenodd" d="M13 3.054V7H9.2a2 2 0 0 1 .281-.432l2.46-2.87A2 2 0 0 1 13 3.054ZM15 3v4a2 2 0 0 1-2 2H9v6a2 2 0 0 0 2 2h7a2 2 0 0 0 2-2V5a2 2 0 0 0-2-2h-3Z" clip-rule="evenodd"></path></svg></button> <button class="cursor-pointer"><svg class="w-5 h-5 text-gray-800 dark:text-white" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 7h14m-9 3v8m4-8v8M10 3h4a1 1 0 0 1 1 1v3H9V4a1 1 0 0 1 1-1ZM6 7h12v13a1 1 0 0 1-1 1H7a1 1 0 0 1-1-1V7Z"></path></svg></button></div> <button class="cursor-pointer"><svg class="w-5 h-5 text-gray-800 dark:text-white" xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="currentColor"><path d="M560-160v-80h120q17 0 28.5-11.5T720-280v-80q0-38 22-69t58-44v-14q-36-13-58-44t-22-69v-80q0-17-11.5-28.5T680-720H560v-80h120q50 0 85 35t35 85v80q0 17 11.5 28.5T840-560h40v160h-40q-17 0-28.5 11.5T800-360v80q0 50-35 85t-85 35H560Zm-280 0q-50 0-85-35t-35-85v-80q0-17-11.5-28.5T120-400H80v-160h40q17 0 28.5-11.5T160-600v-80q0-50 35-85t85-35h120v80H280q-17 0-28.5 11.5T240-680v80q0 38-22 69t-58 44v14q36 13 58 44t22 69v80q0 17 11.5 28.5T280-240h120v80H280Z"></path></svg></button></div> <!> <!></div>');function ad(r,t){Ct(t,!1);const[a,n]=Kt(),l=()=>ut(rn,"$variablesByPage",a),d=Ie();let o=He(t,"triggers",24,()=>[]),M=He(t,"filterTimelineId",8,""),T=Ie(null);const S=ir();function _(I,h){S(I,h)}let q=Ie(!1),k=Ie(""),V=Ie("global"),G=Ie("string"),C=Ie(""),R=Ie(!1);function de(){const I=e(k).trim();if(!I)return;const h=L(e(G),e(C));ja.createVariable({name:I,scope:e(V),type:e(G),initial:h,readOnly:e(R)}),g(k,""),g(C,"")}function L(I,h){if(h)try{return I==="number"?Number(h):I==="boolean"?/^(true|1|yes|on)$/i.test(h):I==="json"?JSON.parse(h):h}catch{return h}}function j(I){const h=l().find(se=>se.id===I);if(!h)return;const H=prompt("New variable name",h.name);H&&ja.renameVariable(I,H.trim())}function _e(I){confirm("Delete variable?")&&ja.deleteVariable(I)}wt(()=>(m(M()),m(o())),()=>{g(d,M()?o().filter(I=>(I.timelineId??"")===M()):o())}),ea(),Bt();var Fe=td(),Be=s(Fe),re=s(Be),W=s(re),p=v(W,2),A=v(p,2),D=v(A,2);i(re);var le=v(re,2);i(Be);var N=v(Be,2);Ke(N,1,()=>e(d),tt,(I,h)=>{var H=Xc(),se=s(H),me=s(se),ce=s(me,!0);i(me);var ne=v(me,2),ue=s(ne,!0);i(ne),i(se);var oe=v(se,2),Ge=s(oe);{var je=ve=>{var Me=Jc(),U=be(Me),ge=v(U);{var he=we=>{var te=Jt();E(()=>Ae(te,`· cue ${e(h),c(()=>e(h).source.cueId)??""}`)),u(we,te)};$(ge,we=>{e(h),c(()=>e(h).source.cueId)&&we(he)})}E(()=>Ae(U,`Timeline ${e(h),c(()=>e(h).source.timelineId??"current")??""} · ${e(h),c(()=>e(h).source.event)??""}`)),u(ve,Me)},Re=ve=>{var Me=$e(),U=be(Me);{var ge=we=>{var te=Jt();E(()=>Ae(te,`Element ${e(h),c(()=>e(h).source.selector)??""} · ${e(h),c(()=>e(h).source.event)??""}`)),u(we,te)},he=we=>{var te=Jt();E(()=>Ae(te,`Timer · ${e(h),c(()=>e(h).source.delayMs)??""} ms`)),u(we,te)};$(U,we=>{e(h),c(()=>e(h).source.kind==="element")?we(ge):we(he,!1)},!0)}u(ve,Me)};$(Ge,ve=>{e(h),c(()=>e(h).source.kind==="timeline")?ve(je):ve(Re,!1)})}i(oe),i(H),E(()=>{Ae(ce,(e(h),c(()=>e(h).name))),rt(ne,1,`badge ${e(h),c(()=>e(h).enabled?"enabled":"")??""}`,"svelte-klf66a"),Ae(ue,(e(h),c(()=>e(h).enabled?"enabled":"disabled")))}),B("click",H,()=>{g(T,e(h).id),_("edit",{id:e(h).id})}),B("keydown",H,ve=>{(ve.key==="Enter"||ve.key===" ")&&(ve.preventDefault(),g(T,e(h).id),_("edit",{id:e(h).id}))}),u(I,H)});var fe=v(N,2);{var ie=I=>{var h=ed(),H=be(h),se=v(H,2),me=s(se),ce=v(s(me),2);i(me);var ne=v(me,2),ue=s(ne),oe=s(ue),Ge=s(oe);pt(Ge);var je=v(Ge,2);E(()=>{e(V),Qa(()=>{})});var Re=s(je);Re.value=Re.__value="global";var ve=v(Re);ve.value=ve.__value="page",i(je);var Me=v(je,2);E(()=>{e(G),Qa(()=>{})});var U=s(Me);U.value=U.__value="string";var ge=v(U);ge.value=ge.__value="number";var he=v(ge);he.value=he.__value="boolean";var we=v(he);we.value=we.__value="json";var te=v(we);te.value=te.__value="object";var J=v(te);J.value=J.__value="array",i(Me),i(oe);var O=v(oe,2),y=s(O),Z=s(y);pt(Z),Pt(),i(y);var P=v(y,2);pt(P),i(O),Pt(2),i(ue);var ke=v(ue,2);Ke(ke,5,l,tt,(pe,X)=>{var ae=Qc(),Pe=s(ae),Y=s(Pe,!0);i(Pe);var Q=v(Pe,2),ee=s(Q,!0);i(Q);var Ne=v(Q,2),Ze=s(Ne);i(Ne);var xe=v(Ne,4),De=v(xe,2);i(ae),E(()=>{Ae(Y,(e(X),c(()=>e(X).scope==="global"?"G":"P"))),Ae(ee,(e(X),c(()=>e(X).name))),Ae(Ze,`(${e(X),c(()=>e(X).type)??""}${e(X),c(()=>e(X).readOnly?", ro":"")??""})`)}),B("click",xe,()=>j(e(X).id)),B("click",De,()=>_e(e(X).id)),u(pe,ae)}),i(ke),i(ne),i(se),B("click",H,()=>g(q,!1)),B("click",ce,()=>g(q,!1)),At(Ge,()=>e(k),pe=>g(k,pe)),Lr(je,()=>e(V),pe=>g(V,pe)),Lr(Me,()=>e(G),pe=>g(G,pe)),oo(Z,()=>e(R),pe=>g(R,pe)),At(P,()=>e(C),pe=>g(C,pe)),B("submit",ue,rr(de)),u(I,h)};$(fe,I=>{e(q)&&I(ie)})}i(Fe),B("click",W,()=>_("new")),B("click",p,()=>_("edit",e(T)?{id:e(T)}:void 0)),B("click",A,()=>_("copy",e(T)?{id:e(T)}:void 0)),B("click",D,()=>_("delete",e(T)?{id:e(T)}:void 0)),B("click",le,()=>g(q,!0)),u(r,Fe),Tt(),n()}var rd=f("<option> </option>"),nd=f("<option> </option>"),od=f("<option> </option>"),id=f('<select class="select svelte-8qxcs6"></select>'),ld=f('<input class="input svelte-8qxcs6" placeholder="value"/>'),sd=f('<div class="row svelte-8qxcs6"><select class="select svelte-8qxcs6"></select> <select class="select svelte-8qxcs6"></select> <select class="select svelte-8qxcs6"><option>value</option><option>variable</option></select> <!> <button class="icon-btn svelte-8qxcs6">Del</button></div>');function Gr(r,t){Ct(t,!1);const a=ir();let n=He(t,"value",8),l=He(t,"variables",24,()=>[]);function d(R,de){const L={...n()};R==="left"||R==="right"?Object.assign(L[R],de):L[R]=de,a("update",L)}Bt();var o=sd(),M=s(o);Ke(M,5,l,tt,(R,de)=>{var L=rd(),j=s(L,!0);i(L);var _e={};E(()=>{It(L,(m(n()),e(de),c(()=>n().left.type==="variable"&&n().left.name===e(de).name))),Ae(j,(e(de),c(()=>e(de).name))),_e!==(_e=(e(de),c(()=>e(de).name)))&&(L.value=(L.__value=(e(de),c(()=>e(de).name)))??"")}),u(R,L)}),i(M);var T=v(M,2);Ke(T,4,()=>["==","!=",">","<",">=","<=","includes"],tt,(R,de)=>{var L=nd(),j=s(L,!0);i(L);var _e={};E(()=>{It(L,(m(n()),c(()=>n().op===de))),Ae(j,de),_e!==(_e=de)&&(L.value=(L.__value=de)??"")}),u(R,L)}),i(T);var S=v(T,2),_=s(S);_.value=_.__value="value";var q=v(_);q.value=q.__value="variable",i(S);var k=v(S,2);{var V=R=>{var de=id();Ke(de,5,l,tt,(L,j)=>{var _e=od(),Fe=s(_e,!0);i(_e);var Be={};E(()=>{It(_e,(m(n()),e(j),c(()=>n().right.name===e(j).name))),Ae(Fe,(e(j),c(()=>e(j).name))),Be!==(Be=(e(j),c(()=>e(j).name)))&&(_e.value=(_e.__value=(e(j),c(()=>e(j).name)))??"")}),u(L,_e)}),i(de),B("change",de,L=>d("right",{type:"variable",name:L.target.value})),u(R,de)},G=R=>{var de=ld();pt(de),E(()=>jt(de,(m(n()),c(()=>n().right.value??"")))),B("input",de,L=>d("right",{type:"value",value:L.target.value})),u(R,de)};$(k,R=>{m(n()),c(()=>n().right.type==="variable")?R(V):R(G,!1)})}var C=v(k,2);i(o),E(()=>{It(_,(m(n()),c(()=>n().right.type==="value"))),It(q,(m(n()),c(()=>n().right.type==="variable")))}),B("change",M,R=>d("left",{type:"variable",name:R.target.value})),B("change",T,R=>d("op",R.target.value)),B("change",S,R=>d("right",{type:R.target.value==="variable"?"variable":"value",name:void 0,value:void 0})),B("click",C,()=>a("delete")),u(r,o),Tt()}var cd=f('<div class="row svelte-1mhl9vf" style="color:#64748b; font-size:12px;">No conditions. Add one to get started.</div>'),dd=f('<span class="chip svelte-1mhl9vf"> </span>'),ud=f('<div class="row svelte-1mhl9vf"><!> <!></div>'),vd=f('<div style="display:flex; align-items:center; justify-content: space-between; margin-bottom:6px;"><h4 style="margin:0; font-size:13px; color:#475569;">Conditions (optional)</h4> <div style="display:flex; gap:6px;"><button class="icon-btn svelte-1mhl9vf">+ Add</button> <button class="icon-btn svelte-1mhl9vf">Clear</button></div></div> <div class="wrap svelte-1mhl9vf"><!></div>',1);function sn(r,t){Ct(t,!1);let a=He(t,"value",12,null),n=He(t,"variables",24,()=>[]);const l=L=>{const j=new CustomEvent("change",{detail:L});dispatchEvent(j)};function d(){var _e;const j={kind:"leaf",left:{type:"variable",name:((_e=n()[0])==null?void 0:_e.name)??"var"},op:"==",right:{type:"value",value:""}};a()?a().kind==="group"?a(a().items=[...a().items,j],!0):a({kind:"group",logic:"AND",items:[a(),j]}):a(j),l(a())}function o(){a(null),l(a())}function M(L){if(a()){if(a().kind==="leaf")a(null);else{const j=a().items.slice();j.splice(L,1),j.length===1?a(j[0]):a(a().items=j,!0)}l(a())}}function T(L,j){if(a()){if(a().kind==="leaf")a(j);else{const _e=a().items.slice();_e[L]=j,a({...a(),items:_e})}l(a())}}Bt();var S=vd(),_=be(S),q=v(s(_),2),k=s(q),V=v(k,2);i(q),i(_);var G=v(_,2),C=s(G);{var R=L=>{var j=cd();u(L,j)},de=L=>{var j=$e(),_e=be(j);{var Fe=re=>{Gr(re,{get value(){return a()},get variables(){return n()},$$events:{update:W=>T(0,W.detail),delete:()=>o()}})},Be=re=>{var W=$e(),p=be(W);Ke(p,1,()=>(m(a()),c(()=>a().items)),tt,(A,D,le)=>{var N=ud(),fe=s(N);Gr(fe,{get value(){return e(D)},get variables(){return n()},$$events:{update:h=>T(le,h.detail),delete:()=>M(le)}});var ie=v(fe,2);{var I=h=>{var H=dd(),se=s(H,!0);i(H),E(()=>Ae(se,(m(a()),c(()=>a().logic)))),u(h,H)};$(ie,h=>{m(a()),c(()=>le<a().items.length-1)&&h(I)})}i(N),u(A,N)}),u(re,W)};$(_e,re=>{m(a()),c(()=>a().kind==="leaf")?re(Fe):re(Be,!1)},!0)}u(L,j)};$(C,L=>{a()?L(de,!1):L(R)})}i(G),B("click",k,rr(d)),B("click",V,rr(o)),u(r,S),Tt()}var pd=f('<label class="svelte-1kirzm">Message</label> <input class="input svelte-1kirzm"/>',1),fd=f("<option> </option>"),gd=f('<label class="svelte-1kirzm">Timeline</label> <select class="select svelte-1kirzm"><option>Current</option><!></select> <label class="svelte-1kirzm">Time (ms)</label> <input class="input svelte-1kirzm" type="number"/>',1),md=f("<option> </option>"),hd=f('<label class="svelte-1kirzm">Timeline</label> <select class="select svelte-1kirzm"><option>Current</option><!></select>',1),bd=f('<div class="card svelte-1kirzm"><div class="top svelte-1kirzm"><span class="drag svelte-1kirzm">≡</span> <span class="label svelte-1kirzm"><!></span> <div class="controls svelte-1kirzm"><button class="icon-btn svelte-1kirzm">◀</button> <button class="icon-btn svelte-1kirzm">▶</button> <button class="icon-btn svelte-1kirzm">Del</button></div></div> <!> <details><summary style="font-size:12px; color:#475569;">Optional condition</summary> <!></details></div>');function _d(r,t){Ct(t,!1);let a=He(t,"action",8),n=He(t,"timelines",24,()=>[]),l=He(t,"variables",24,()=>[]),d=He(t,"index",8,0);function o(W,p){const A=new CustomEvent(W,{detail:p});dispatchEvent(A)}function M(W){o("update",{index:d(),action:W})}function T(W){M({...a(),condition:W??null})}Bt();var S=bd(),_=s(S),q=v(s(_),2),k=s(q);{var V=W=>{var p=Jt("Log");u(W,p)},G=W=>{var p=$e(),A=be(p);{var D=N=>{var fe=Jt("Play Timeline");u(N,fe)},le=N=>{var fe=$e(),ie=be(fe);{var I=H=>{var se=Jt("Pause Timeline");u(H,se)},h=H=>{var se=$e(),me=be(se);{var ce=ue=>{var oe=Jt("Stop Timeline");u(ue,oe)},ne=ue=>{var oe=$e(),Ge=be(oe);{var je=Re=>{var ve=Jt("Seek Timeline");u(Re,ve)};$(Ge,Re=>{m(a()),c(()=>a().kind==="timeline.seek")&&Re(je)},!0)}u(ue,oe)};$(me,ue=>{m(a()),c(()=>a().kind==="timeline.stop")?ue(ce):ue(ne,!1)},!0)}u(H,se)};$(ie,H=>{m(a()),c(()=>a().kind==="timeline.pause")?H(I):H(h,!1)},!0)}u(N,fe)};$(A,N=>{m(a()),c(()=>a().kind==="timeline.play")?N(D):N(le,!1)},!0)}u(W,p)};$(k,W=>{m(a()),c(()=>a().kind==="log")?W(V):W(G,!1)})}i(q);var C=v(q,2),R=s(C),de=v(R,2),L=v(de,2);i(C),i(_);var j=v(_,2);{var _e=W=>{var p=$e(),A=be(p);lr(A,d,D=>{var le=$e(),N=be(le);eo(N,()=>(m(d()),c(()=>Promise.resolve(d()))),null,(fe,ie)=>{var I=pd(),h=be(I),H=v(h,2);pt(H),E(()=>{ye(h,"for",`msg-${d()}`),ye(H,"id",`msg-${d()}`),jt(H,(m(a()),c(()=>a().message)))}),B("input",H,se=>M({...a(),message:se.target.value})),u(fe,I)}),u(D,le)}),u(W,p)},Fe=W=>{var p=$e(),A=be(p);{var D=N=>{var fe=gd(),ie=be(fe),I=v(ie,2),h=s(I);h.value=h.__value="";var H=v(h);Ke(H,1,n,tt,(ce,ne)=>{var ue=fd(),oe=s(ue,!0);i(ue);var Ge={};E(()=>{It(ue,(m(a()),e(ne),c(()=>a().timelineId===e(ne).id))),Ae(oe,(e(ne),c(()=>e(ne).label??e(ne).id))),Ge!==(Ge=(e(ne),c(()=>e(ne).id)))&&(ue.value=(ue.__value=(e(ne),c(()=>e(ne).id)))??"")}),u(ce,ue)}),i(I);var se=v(I,2),me=v(se,2);pt(me),E(()=>{ye(ie,"for",`tl-${d()}`),ye(I,"id",`tl-${d()}`),It(h,(m(a()),c(()=>!a().timelineId))),ye(se,"for",`ms-${d()}`),ye(me,"id",`ms-${d()}`),jt(me,(m(a()),c(()=>a().ms)))}),B("change",I,ce=>M({...a(),timelineId:ce.target.value})),B("input",me,ce=>M({...a(),ms:+ce.target.value})),u(N,fe)},le=N=>{var fe=hd(),ie=be(fe),I=v(ie,2),h=s(I);h.value=h.__value="";var H=v(h);Ke(H,1,n,tt,(se,me)=>{var ce=md(),ne=s(ce,!0);i(ce);var ue={};E(()=>{It(ce,(m(a()),e(me),c(()=>a().timelineId===e(me).id))),Ae(ne,(e(me),c(()=>e(me).label??e(me).id))),ue!==(ue=(e(me),c(()=>e(me).id)))&&(ce.value=(ce.__value=(e(me),c(()=>e(me).id)))??"")}),u(se,ce)}),i(I),E(()=>{ye(ie,"for",`tl-${d()}`),ye(I,"id",`tl-${d()}`),It(h,(m(a()),c(()=>!("timelineId"in a())||!a().timelineId)))}),B("change",I,se=>M({...a(),timelineId:se.target.value})),u(N,fe)};$(A,N=>{m(a()),c(()=>a().kind==="timeline.seek")?N(D):N(le,!1)},!0)}u(W,p)};$(j,W=>{m(a()),c(()=>a().kind==="log")?W(_e):W(Fe,!1)})}var Be=v(j,2),re=v(s(Be),2);{let W=yt(()=>(m(a()),c(()=>a().condition??null)));sn(re,{get value(){return e(W)},get variables(){return l()},$$events:{change:p=>T(p.detail)}})}i(Be),i(S),B("click",R,()=>o("move",{index:d(),dir:-1})),B("click",de,()=>o("move",{index:d(),dir:1})),B("click",L,()=>o("delete",{index:d()})),u(r,S),Tt()}var wd=f('<div class="flow svelte-1r9o0yu"></div>');function xd(r,t){Ct(t,!1);let a=He(t,"actions",24,()=>[]),n=He(t,"timelines",24,()=>[]),l=He(t,"variables",24,()=>[]);const d=_=>dispatchEvent(new CustomEvent("change",{detail:_}));function o(_,q){const k=a().slice();k[_]=q,d(k)}function M(_){const q=a().slice();q.splice(_,1),d(q)}function T(_,q){const k=a().slice(),V=Math.max(0,Math.min(k.length-1,_+q)),[G]=k.splice(_,1);k.splice(V,0,G),d(k)}Bt();var S=wd();Ke(S,5,a,tt,(_,q,k)=>{_d(_,{get action(){return e(q)},index:k,get timelines(){return n()},get variables(){return l()},$$events:{update:V=>o(V.detail.index,V.detail.action),delete:V=>M(V.detail.index),move:V=>T(V.detail.index,V.detail.dir)}})}),i(S),u(r,S),Tt()}var yd=f("<option> </option>"),kd=f('<select id="src-event" class="select svelte-1ycld5c"></select>'),Id=f('<select id="src-event" class="select svelte-1ycld5c"><option>click</option></select>'),Cd=f('<select id="src-event" class="select svelte-1ycld5c" disabled><option selected>timeout</option></select>'),Td=f("<option> </option>"),Sd=f('<select id="src-target" class="select svelte-1ycld5c"><option>Current</option><!></select>'),Ad=f('<input id="src-target" class="input svelte-1ycld5c" placeholder="#selector"/>'),Bd=f('<input id="src-target" class="input svelte-1ycld5c" disabled value="(timer)"/>'),Md=f('<div class="col svelte-1ycld5c"><label for="cue-name" class="svelte-1ycld5c">Cue (optional)</label> <input id="cue-name" class="input svelte-1ycld5c" placeholder="cue id or name"/></div>'),Zd=f('<div class="col svelte-1ycld5c"><label for="timer-delay" class="svelte-1ycld5c">Timer (ms)</label> <input id="timer-delay" type="number" class="input svelte-1ycld5c" placeholder="e.g. 1000"/></div>'),Ld=f('<section class="float svelte-1ycld5c" aria-label="Trigger wizard"><header class="header svelte-1ycld5c"><div class="title svelte-1ycld5c"><h2 class="svelte-1ycld5c">Trigger Wizard</h2> <span style="font-size:10px; padding:2px 6px; border-radius:999px; border:1px solid #e2e8f0; color:#475569; background:#f8fafc;">Draft</span></div> <button class="close svelte-1ycld5c" aria-label="Close wizard">×</button></header> <nav class="steps svelte-1ycld5c" aria-label="Steps"><span class="step active svelte-1ycld5c">1 · Source</span> <span class="step svelte-1ycld5c">2 · Conditions</span> <span class="step svelte-1ycld5c">3 · Actions</span> <span class="step svelte-1ycld5c">4 · Review</span></nav> <section class="section svelte-1ycld5c"><h4 style="margin:0 0 8px; font-size:13px; color:#475569;">Source & Event</h4> <div class="row svelte-1ycld5c"><div class="col svelte-1ycld5c"><label for="src-kind" class="svelte-1ycld5c">Source</label> <select id="src-kind" class="select svelte-1ycld5c"><option>Timeline</option><option>Element</option><option>Timer</option></select></div> <div class="col svelte-1ycld5c"><label for="src-event" class="svelte-1ycld5c">Event</label> <!></div> <div class="col svelte-1ycld5c"><label for="src-target" class="svelte-1ycld5c">Target</label> <!></div></div> <div class="row svelte-1ycld5c" style="margin-top:8px;"><!></div></section> <section class="section svelte-1ycld5c"><!></section> <section class="section svelte-1ycld5c"><div style="display:flex; align-items:center; justify-content: space-between; margin-bottom:6px;"><h4 style="margin:0; font-size:13px; color:#475569;">Actions</h4> <div><select class="select svelte-1ycld5c"><option>+ Add action…</option><option>Log</option><option>Play Timeline</option><option>Pause Timeline</option><option>Stop Timeline</option><option>Seek Timeline</option></select></div></div> <!></section> <footer class="footer svelte-1ycld5c"><button class="btn discard svelte-1ycld5c">Discard</button> <button class="btn save svelte-1ycld5c">Save</button></footer></section>');function $d(r,t){Ct(t,!1);let a=He(t,"isOpen",8,!0),n=He(t,"trigger",28,()=>({id:"new",name:"New trigger",enabled:!0,source:{kind:"timeline",event:"cue",timelineId:void 0,cueId:""},conditions:null,actions:[{kind:"log",message:"Hello"}]})),l=He(t,"timelines",24,()=>[]),d=He(t,"variables",24,()=>[]);function o(G,C){dispatchEvent(new CustomEvent(G,{detail:C}))}function M(G,C){n({...n(),[G]:C}),o("change",n())}function T(G){M("source",G)}function S(G){M("conditions",G)}function _(G){M("actions",G)}Bt();var q=$e(),k=be(q);{var V=G=>{var C=Ld(),R=s(C),de=v(s(R),2);i(R);var L=v(R,4),j=v(s(L),2),_e=s(j),Fe=v(s(_e),2),Be=s(Fe);Be.value=Be.__value="timeline";var re=v(Be);re.value=re.__value="element";var W=v(re);W.value=W.__value="timer",i(Fe),i(_e);var p=v(_e,2),A=v(s(p),2);{var D=y=>{var Z=kd();Ke(Z,4,()=>["cue","play","pause","stop","seek"],tt,(P,ke)=>{var pe=yd(),X=s(pe,!0);i(pe);var ae={};E(()=>{It(pe,(m(n()),c(()=>n().source.event===ke))),Ae(X,ke),ae!==(ae=ke)&&(pe.value=(pe.__value=ke)??"")}),u(P,pe)}),i(Z),B("change",Z,P=>T({...n().source,event:P.target.value})),u(y,Z)},le=y=>{var Z=$e(),P=be(Z);{var ke=X=>{var ae=Id(),Pe=s(ae);Pe.value=Pe.__value="click",i(ae),E(()=>It(Pe,(m(n()),c(()=>n().source.event==="click")))),B("change",ae,Y=>T({...n().source,event:Y.target.value})),u(X,ae)},pe=X=>{var ae=Cd();u(X,ae)};$(P,X=>{m(n()),c(()=>n().source.kind==="element")?X(ke):X(pe,!1)},!0)}u(y,Z)};$(A,y=>{m(n()),c(()=>n().source.kind==="timeline")?y(D):y(le,!1)})}i(p);var N=v(p,2),fe=v(s(N),2);{var ie=y=>{var Z=Sd(),P=s(Z);P.value=P.__value="";var ke=v(P);Ke(ke,1,l,tt,(pe,X)=>{var ae=Td(),Pe=s(ae,!0);i(ae);var Y={};E(()=>{It(ae,(m(n()),e(X),c(()=>n().source.timelineId===e(X).id))),Ae(Pe,(e(X),c(()=>e(X).label??e(X).id))),Y!==(Y=(e(X),c(()=>e(X).id)))&&(ae.value=(ae.__value=(e(X),c(()=>e(X).id)))??"")}),u(pe,ae)}),i(Z),E(()=>It(P,(m(n()),c(()=>!("timelineId"in n().source)||!n().source.timelineId)))),B("change",Z,pe=>T({...n().source,timelineId:pe.target.value||void 0})),u(y,Z)},I=y=>{var Z=$e(),P=be(Z);{var ke=X=>{var ae=Ad();pt(ae),E(()=>jt(ae,(m(n()),c(()=>n().source.selector??"")))),B("input",ae,Pe=>T({...n().source,selector:Pe.target.value})),u(X,ae)},pe=X=>{var ae=Bd();u(X,ae)};$(P,X=>{m(n()),c(()=>n().source.kind==="element")?X(ke):X(pe,!1)},!0)}u(y,Z)};$(fe,y=>{m(n()),c(()=>n().source.kind==="timeline")?y(ie):y(I,!1)})}i(N),i(j);var h=v(j,2),H=s(h);{var se=y=>{var Z=Md(),P=v(s(Z),2);pt(P),i(Z),E(()=>jt(P,(m(n()),c(()=>n().source.cueId??"")))),B("input",P,ke=>T({...n().source,cueId:ke.target.value})),u(y,Z)},me=y=>{var Z=$e(),P=be(Z);{var ke=pe=>{var X=Zd(),ae=v(s(X),2);pt(ae),i(X),E(()=>jt(ae,(m(n()),c(()=>n().source.delayMs??1e3)))),B("input",ae,Pe=>T({...n().source,delayMs:+Pe.target.value})),u(pe,X)};$(P,pe=>{m(n()),c(()=>n().source.kind==="timer")&&pe(ke)},!0)}u(y,Z)};$(H,y=>{m(n()),c(()=>n().source.kind==="timeline")?y(se):y(me,!1)})}i(h),i(L);var ce=v(L,2),ne=s(ce);{let y=yt(()=>(m(n()),c(()=>n().conditions??null)));sn(ne,{get value(){return e(y)},get variables(){return d()},$$events:{change:Z=>S(Z.detail)}})}i(ce);var ue=v(ce,2),oe=s(ue),Ge=v(s(oe),2),je=s(Ge),Re=s(je);Re.value=Re.__value="";var ve=v(Re);ve.value=ve.__value="log";var Me=v(ve);Me.value=Me.__value="timeline.play";var U=v(Me);U.value=U.__value="timeline.pause";var ge=v(U);ge.value=ge.__value="timeline.stop";var he=v(ge);he.value=he.__value="timeline.seek",i(je),i(Ge),i(oe);var we=v(oe,2);xd(we,{get actions(){return m(n()),c(()=>n().actions)},get timelines(){return l()},get variables(){return d()},$$events:{change:y=>_(y.detail)}}),i(ue);var te=v(ue,2),J=s(te),O=v(J,2);i(te),i(C),E(()=>{It(Be,(m(n()),c(()=>n().source.kind==="timeline"))),It(re,(m(n()),c(()=>n().source.kind==="element"))),It(W,(m(n()),c(()=>n().source.kind==="timer")))}),B("click",de,()=>o("close")),B("change",Fe,y=>T({kind:y.target.value,event:n().source.event})),B("change",je,y=>{const Z=y.target.value;if(!Z)return;const P=[...n().actions];Z==="log"&&P.push({kind:"log",message:""}),Z==="timeline.play"&&P.push({kind:"timeline.play"}),Z==="timeline.pause"&&P.push({kind:"timeline.pause"}),Z==="timeline.stop"&&P.push({kind:"timeline.stop"}),Z==="timeline.seek"&&P.push({kind:"timeline.seek",ms:0}),_(P),y.target.value=""}),B("click",J,()=>o("discard")),B("click",O,()=>o("save",n())),u(G,C)};$(k,G=>{a()&&G(V)})}u(r,q),Tt()}var Nd=f('<div class="triggers-ui"><!> <!></div>');function Wd(r,t){Ct(t,!1);let a=He(t,"triggers",28,()=>[]),n=He(t,"timelines",24,()=>[]),l=He(t,"variables",24,()=>[]),d=Ie(!1),o=Ie(null);function M(){g(o,{id:"new",name:"New trigger",enabled:!0,source:{kind:"timeline",event:"cue",timelineId:void 0,cueId:""},conditions:null,actions:[{kind:"log",message:""}]}),g(d,!0)}function T(V){const G=V?a().find(C=>C.id===V):a()[0];if(!G)return M();g(o,structuredClone(G)),g(d,!0)}function S(V){const G=V.detail,C=a().findIndex(R=>R.id===G.id);C>=0?a(a()[C]=G,!0):a([...a(),{...G,id:`t${Date.now()}`}]),g(d,!1)}Bt();var _=Nd(),q=s(_);ad(q,{get triggers(){return a()},$$events:{new:M,edit:V=>{var G;return T((G=V.detail)==null?void 0:G.id)}}});var k=v(q,2);{let V=yt(()=>e(o)??{id:"new",name:"New trigger",enabled:!0,source:{kind:"timeline",event:"cue",timelineId:void 0,cueId:""},conditions:null,actions:[{kind:"log",message:""}]});$d(k,{get trigger(){return e(V)},get timelines(){return n()},get variables(){return l()},get isOpen(){return e(d)},set isOpen(G){g(d,G)},$$events:{save:S,discard:()=>g(d,!1),close:()=>g(d,!1)},$$legacy:!0})}i(_),u(r,_),Tt()}var qd=f('<section class="h-full min-h-0 w-full pt-3 overflow-hidden flex flex-col"><!></section>');function Hd(r){const[t,a]=Kt(),n=()=>ut(l,"$activeRightUtil",t),{activeRightUtil:l}=ma;var d=qd(),o=s(d);{var M=S=>{Uc(S,{})},T=S=>{var _=$e(),q=be(_);{var k=V=>{Wd(V,{})};$(q,V=>{n()==="actions"&&V(k)},!0)}u(S,_)};$(o,S=>{n()==="styles"?S(M):S(T,!1)})}i(d),u(r,d),a()}var Pd=f("<button></button>"),Ed=f('<div class="group svelte-1fytrvf"><div class="swatches svelte-1fytrvf"></div></div>'),Vd=f('<div class="palettes no-scroll svelte-1fytrvf"></div> <div class="custom-row svelte-1fytrvf"><input type="text" placeholder="#hex or rgb(...)" class="svelte-1fytrvf"/> <button class="apply svelte-1fytrvf">Apply</button></div>',1),Rd=f('<div class="coming svelte-1fytrvf">Gradient editor coming soon.</div>'),Dd=f('<div id="global-palette" class="fixed top-2 right-2 z-50 w-[280px] bg-slate-900 border border-slate-700 rounded-lg shadow-2xl p-2 flex flex-col gap-2"><div class="flex items-center justify-between"><div class="text-xs text-slate-300"> </div> <button class="text-slate-300 hover:text-white text-xs">Close</button></div> <div class="tabs svelte-1fytrvf"><button>Solid</button> <button>Linear</button> <button>Radial</button></div> <!></div>');function zd(r,t){Ct(t,!1);const[a,n]=Kt(),l=()=>ut(zt,"$palette",a);let d=Ie("solid");const o=[{name:"Slate",shades:["#f1f5f9","#e2e8f0","#cbd5e1","#94a3b8","#64748b","#334155"]},{name:"Blue",shades:["#eff6ff","#bfdbfe","#60a5fa","#3b82f6","#2563eb","#1e3a8a"]},{name:"Emerald",shades:["#ecfdf5","#a7f3d0","#6ee7b7","#34d399","#059669","#065f46"]},{name:"Amber",shades:["#fffbeb","#fde68a","#fbbf24","#f59e0b","#d97706","#92400e"]},{name:"Rose",shades:["#fff1f2","#fecdd3","#fb7185","#f43f5e","#e11d48","#881337"]}];function M(k){k.key==="Escape"&&zt.closePalette(!1)}function T(k){const V=k.target,G=document.getElementById("global-palette");l().open&&G&&!G.contains(V)&&zt.closePalette(!0)}ga(()=>(window.addEventListener("keydown",M,{capture:!0}),window.addEventListener("mousedown",T),()=>{window.removeEventListener("keydown",M),window.removeEventListener("mousedown",T)})),Bt();var S=$e(),_=be(S);{var q=k=>{var V=Dd(),G=s(V),C=s(G),R=s(C,!0);i(C);var de=v(C,2);i(G);var L=v(G,2),j=s(L);let _e;var Fe=v(j,2);let Be;var re=v(Fe,2);let W;i(L);var p=v(L,2);{var A=le=>{var N=Vd(),fe=be(N);Ke(fe,5,()=>o,tt,(H,se)=>{var me=Ed(),ce=s(me);Ke(ce,5,()=>e(se).shades,tt,(ne,ue)=>{var oe=Pd();let Ge;E(je=>{Ge=rt(oe,1,"sw svelte-1fytrvf",null,Ge,je),ye(oe,"aria-label",e(ue)),ht(oe,`background:${e(ue)}`),ye(oe,"title",e(ue))},[()=>({selected:e(ue)===(l().value||"")})]),B("mouseenter",oe,()=>zt.preview(e(ue))),B("click",oe,()=>zt.commit(e(ue))),u(ne,oe)}),i(ce),i(me),u(H,me)}),i(fe);var ie=v(fe,2),I=s(ie);pt(I);var h=v(I,2);i(ie),At(I,()=>l().value,H=>Hn(zt,c(l).value=H,c(l))),B("input",I,H=>zt.preview(H.target.value)),B("click",h,()=>l().value&&zt.commit(l().value)),u(le,N)},D=le=>{var N=Rd();u(le,N)};$(p,le=>{e(d)==="solid"?le(A):le(D,!1)})}i(V),E((le,N,fe)=>{Ae(R,l().label||"Color"),_e=rt(j,1,"svelte-1fytrvf",null,_e,le),Be=rt(Fe,1,"svelte-1fytrvf",null,Be,N),W=rt(re,1,"svelte-1fytrvf",null,W,fe)},[()=>({active:e(d)==="solid"}),()=>({active:e(d)==="linear"}),()=>({active:e(d)==="radial"})]),B("click",de,()=>zt.closePalette(!0)),B("click",j,()=>g(d,"solid")),B("click",Fe,()=>g(d,"linear")),B("click",re,()=>g(d,"radial")),u(k,V)};$(_,k=>{l().open&&k(q)})}u(r,S),Tt(),n()}function Fd(r,t){return`page-${r}:${t}`}function Gd(r,t){var o,M;const a=Fd(r,t);let l=Zt.getAll().find(T=>T.id===a);if(!l){const T=Xe(aa).pagesById[r],S=`${((o=T==null?void 0:T.metadata)==null?void 0:o.title)??r} · ${t}`,_=Math.max(0,((M=T==null?void 0:T.metadata)==null?void 0:M.duration)??3e3);l={id:a,name:S,duration:_,loop:!1,cuePoints:[]},Zt.add(l)}let d=mt.get(a);d||(d=mt.create(l)),La.set(a),d.on(T=>{T.type==="cue"&&Lt.append("info",`Cue: ${T.cue.label??T.cue.id} @ ${T.cue.time}ms`,{timelineId:a}),T.type==="loop"&&Lt.append("info",`Loop ${T.count}`,{timelineId:a})})}let jr=null,Or=null;function mr(){const r=Xe(Nt),t=Xe(dr);!r||!t||r===jr&&t===Or||(jr=r,Or=t,Gd(r,t))}Nt.subscribe(()=>mr());dr.subscribe(()=>mr());aa.subscribe(()=>mr());function jd(){Et.all().forEach(t=>{try{vr(t)}catch(a){console.warn("Failed to register trigger",t==null?void 0:t.id,a)}})}jd();const Od=mt.create.bind(mt);mt.create=r=>{const t=Od(r),a=r==null?void 0:r.id;return a&&Et.getForTimeline(a).forEach(l=>{try{vr(l)}catch(d){console.warn("Failed to re-register trigger",l==null?void 0:l.id,d)}}),t};var Yd=(r,t)=>t(r,"aside"),Kd=f('<aside class="min-w-48 relative max-w-64 resize-x overflow-hidden  bg-slate-200 dark:bg-slate-700"><div class="h-full overflow-auto"><!></div> <div class="absolute top-0 right-0 bottom-0 w-0.5 cursor-ew-resize bg-transparent hover:bg-slate-400 transition"></div></aside>'),Ud=(r,t)=>t(r,"terminal"),Jd=f('<div class="w-62 h-full min-h-0 flex flex-col"><!></div>'),Xd=f('<div class="h-screen bg-gray-100 select-none dark:bg-slate-950 grid grid-cols-none overflow-hidden grid-rows-[min-content_1fr] text-gray-950 dark:text-gray-200"><header class="max-h-12"><!></header> <section class="h-full min-h-0 grid grid-rows-[1fr_min-content] relative"><main class="h-full min-h-0 grid grid-rows-none grid-cols-[min-content_1fr_min-content] relative"><nav class="bg-white dark:bg-slate-800 shadow-md h-full min-h-0 grid grid-rows-none grid-cols-[min-content_min-content]"><!> <!></nav> <section class="h-full min-h-0 overflow-auto relative"><!> <!> <div id="terminal"><div class="absolute top-0 right-0 left-0 h-1 cursor-ns-resize bg-transparent hover:bg-slate-400 transition"></div> <!></div></section> <section class="h-full min-h-0 overflow-hidden bg-slate-200 dark:bg-slate-700 text-white"><!></section></main> <footer class="bg-white dark:bg-slate-800 shadow-md p-1 relative"><p class="text-sm text-gray-500 dark:text-gray-400">Footer content</p></footer></section></div>');function ou(r,t){Ct(t,!0);const[a,n]=Kt(),l=()=>ut(G,"$terminalState",a),d=()=>ut(k,"$asideWidth",a),o=()=>ut(V,"$terminalHeight",a),M=()=>ut(Nt,"$currentPageId",a),T=()=>ut(tr,"$currentLessonId",a),S=()=>ut(ar,"$currentModuleId",a),_=()=>ut(C,"$activeSideNav",a),q=()=>ut(R,"$activeRightUtil",a),{asideWidth:k,terminalHeight:V,terminalState:G,activeSideNav:C,activeRightUtil:R,setAsideWidth:de,setTerminalHeight:L,openTerminal:j,closeTerminal:_e}=ma;let Fe=Tr(null),Be=Tr(null),re=null;function W(U,ge){U.preventDefault(),re=ge,document.body.style.userSelect="none",document.addEventListener("pointermove",p),document.addEventListener("pointerup",A)}function p(U){if(re==="aside"){if(!e(Fe))return;const ge=U.clientX-e(Fe).getBoundingClientRect().left;ge>=150&&ge<=400&&de(ge)}else if(re==="terminal"){if(!e(Be))return;const ge=window.innerHeight,he=ge-U.clientY;he>=3&&he<=ge-50?(L(he),l()==="closed"&&j()):he<3&&(L(3),_e())}}function A(){re=null,document.body.style.userSelect="",document.removeEventListener("pointermove",p),document.removeEventListener("pointerup",A)}ga(()=>{e(Fe)&&(e(Fe).style.width=`${d()}px`),e(Be)&&(e(Be).style.height=`${l()==="closed"?0:o()}px`);const U=he=>{const we=document.activeElement;if(we&&(we.tagName==="INPUT"||we.tagName==="TEXTAREA"||we.isContentEditable)||!(navigator.platform.toUpperCase().includes("MAC")?he.metaKey:he.ctrlKey))return;const O=he.key.toLowerCase();if(O==="z"&&he.shiftKey||O==="y"){he.preventDefault(),Xn();return}if(O==="z"){he.preventDefault(),Qn();return}if(O==="delete"){he.preventDefault(),M()?ua(M()):T()?va(T()):S()&&pa(S());return}};window.addEventListener("keydown",U,{capture:!0});const ge=()=>{M()?xa("page"):T()?xa("lesson"):xa("module")};return Nt.subscribe(()=>ge()),tr.subscribe(()=>ge()),ar.subscribe(()=>ge()),ge(),()=>window.removeEventListener("keydown",U,{capture:!0})});var D=Xd(),le=s(D),N=s(le);xo(N,{}),i(le);var fe=v(le,2),ie=s(fe),I=s(ie),h=s(I);wl(h);var H=v(h,2);{var se=U=>{var ge=Kd();let he;var we=s(ge),te=s(we);Ws(te),i(we);var J=v(we,2);J.__pointerdown=[Yd,W],i(ge),Gt(ge,O=>g(Fe,O),()=>e(Fe)),E(O=>he=ht(ge,"",he,O),[()=>({width:`${d()}px`})]),u(U,ge)};$(H,U=>{_()&&U(se)})}i(I);var me=v(I,2),ce=s(me);Wn(ce,()=>t.children);var ne=v(ce,2);zd(ne,{});var ue=v(ne,2);let oe;var Ge=s(ue);Ge.__pointerdown=[Ud,W];var je=v(Ge,2);ml(je,{}),i(ue),Gt(ue,U=>g(Be,U),()=>e(Be)),i(me);var Re=v(me,2),ve=s(Re);{var Me=U=>{var ge=Jd(),he=s(ge);Hd(he),i(ge),u(U,ge)};$(ve,U=>{q()&&U(Me)})}i(Re),i(ie),Pt(2),i(fe),i(D),E(U=>{rt(ue,1,`absolute z-20 bottom-0 left-0 right-0 min-h-[3px] max-h-full resize-y overflow-auto bg-slate-950 border-slate-50 dark:border-slate-800 no-scroll overflow-y-auto ${l()==="closed"?"border-0":"border-t"}`),oe=ht(ue,"",oe,U)},[()=>({height:`${l()==="closed"?3:o()}px`})]),u(r,D),Tt(),n()}Ia(["pointerdown"]);export{ou as component,nu as universal};
