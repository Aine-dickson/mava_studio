(function(){"use strict";const a=self;let s=null,c="studioProjectData",o=null;const i=800;function l(){o&&clearTimeout(o),o=setTimeout(n,i)}function n(){var t;if(s)try{const e=s;(t=self.localStorage)==null||t.setItem(c,JSON.stringify(e))}catch{a.postMessage({type:"persist-request",data:s,key:c})}}a.onmessage=t=>{var r;const e=t.data;switch(e.type){case"init":{c=e.key,s=structuredClone(e.full),l();break}case"change":{if(!s)return;e.pages&&Object.assign(s.pagesById,e.pages),e.lessons&&Object.assign(s.lessonsById,e.lessons),e.modules&&Object.assign(s.modulesById,e.modules),e.course&&(s.course=e.course),l();break}case"flush":{n();break}case"load":{try{const u=(r=self.localStorage)==null?void 0:r.getItem(e.key);u&&a.postMessage({type:"loaded",raw:u})}catch{}break}}}})();
